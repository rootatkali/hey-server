{\rtf1\ansi \deff1{\fonttbl{\f1\fmodern\fprq1\fcharset0 Courier New;}}{\colortbl;\red224\green234\blue238;\red00\green00\blue00;\red191\green03\blue03;\red176\green126\blue00;\red131\green129\blue131;\red131\green129\blue131;\red255\green00\blue255;\red00\green130\blue00;\red129\green129\blue00;\red85\green85\blue85;\red00\green00\blue00;\red00\green87\blue174;\red00\green00\blue00;\red00\green87\blue174;\red00\green00\blue00;\red01\green01\blue129;}
\paperw11905\paperh16837\margl1134\margr1134\margt1134\margb1134\sectd\plain\f1\fs20
\pard \cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/chat/Chat.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{chat}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{model}}{\cf11{.}}{\cf2{User}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{apache}}{\cf11{.}}{\cf2{commons}}{\cf11{.}}{\cf2{codec}}{\cf11{.}}{\cf2{digest}}{\cf11{.}}{\cf2{DigestUtils}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{javax}}{\cf11{.}}{\cf2{persistence}}{\cf11{.}}{\cf2{Entity}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{javax}}{\cf11{.}}{\cf2{persistence}}{\cf11{.}}{\cf2{Id}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{Arrays}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf15{\b @Entity\b0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public class\b0 }} {\cf2{Chat}} {\cf11{\{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Id\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{String id}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{String user{1}}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{String user{2}}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{}}{\cf16{Chat}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{}}{\cf16{Chat}}{\cf2{}}{\cf11{(}}{\cf2{User user{1}}}{\cf11{,}} {\cf2{User user{2}}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{(}}{\cf2{user{1}}}{\cf11{.}}{\cf2{}}{\cf16{getId}}{\cf2{}}{\cf11{(),}} {\cf2{user{2}}}{\cf11{.}}{\cf2{}}{\cf16{getId}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{}}{\cf16{Chat}}{\cf2{}}{\cf11{(}}{\cf2{String user{1}}}{\cf11{,}} {\cf2{String user{2}}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    String}}{\cf11{[]}} {\cf2{ids}} {\cf11{= \{}}{\cf2{user{1}}}{\cf11{,}} {\cf2{user{2}}}{\cf11{\};}}}\par\pard
\cbpat1{{\cf2{    Arrays}}{\cf11{.}}{\cf2{}}{\cf16{sort}}{\cf2{}}{\cf11{(}}{\cf2{ids}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{user{1}}} {\cf11{=}} {\cf2{ids}}{\cf11{[}}{\cf2{}}{\cf4{{0}}}{\cf2{}}{\cf11{];}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{user{2}}} {\cf11{=}} {\cf2{ids}}{\cf11{[}}{\cf2{}}{\cf4{{1}}}{\cf2{}}{\cf11{];}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{id}} {\cf11{=}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{}}{\cf16{DigestUtils}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"SHA{3}-{2}{5}{6}"}}{\cf2{}}{\cf11{).}}{\cf2{}}{\cf16{digestAsHex}}{\cf2{}}{\cf11{(}}{\cf2{ids}}{\cf11{[}}{\cf2{}}{\cf4{{0}}}{\cf2{}}{\cf11{] +}} {\cf2{ids}}{\cf11{[}}{\cf2{}}{\cf4{{1}}}{\cf2{}}{\cf11{]);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{getId}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{id}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{getUser{1}}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{user{1}}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{getUser{2}}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{user{2}}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public boolean\b0 }} {\cf2{}}{\cf16{containsUser}}{\cf2{}}{\cf11{(}}{\cf2{String id}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{id}}{\cf11{.}}{\cf2{}}{\cf16{equals}}{\cf2{}}{\cf11{(}}{\cf2{user{1}}}{\cf11{) ||}} {\cf2{id}}{\cf11{.}}{\cf2{}}{\cf16{equals}}{\cf2{}}{\cf11{(}}{\cf2{user{2}}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/chat/ChatController.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{chat}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{model}}{\cf11{.}}{\cf2{User}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{service}}{\cf11{.}}{\cf2{AuthService}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{service}}{\cf11{.}}{\cf2{UserService}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{Error}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{beans}}{\cf11{.}}{\cf2{factory}}{\cf11{.}}{\cf2{annotation}}{\cf11{.}}{\cf2{Autowired}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{messaging}}{\cf11{.}}{\cf2{handler}}{\cf11{.}}{\cf2{annotation}}{\cf11{.}}{\cf2{MessageMapping}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{messaging}}{\cf11{.}}{\cf2{handler}}{\cf11{.}}{\cf2{annotation}}{\cf11{.}}{\cf2{Payload}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{messaging}}{\cf11{.}}{\cf2{simp}}{\cf11{.}}{\cf2{SimpMessagingTemplate}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{stereotype}}{\cf11{.}}{\cf2{Controller}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{web}}{\cf11{.}}{\cf2{bind}}{\cf11{.}}{\cf2{annotation}}{\cf11{.}}{\cf2{CookieValue}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{web}}{\cf11{.}}{\cf2{bind}}{\cf11{.}}{\cf2{annotation}}{\cf11{.}}{\cf2{GetMapping}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{web}}{\cf11{.}}{\cf2{bind}}{\cf11{.}}{\cf2{annotation}}{\cf11{.}}{\cf2{PathVariable}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{List}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf15{\b @Controller\b0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public class\b0 }} {\cf2{ChatController}} {\cf11{\{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{SimpMessagingTemplate messagingTemplate}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{MessageService messageService}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{ChatService chatService}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{UserService userService}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{AuthService authService}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Autowired\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{}}{\cf16{ChatController}}{\cf2{}}{\cf11{(}}{\cf2{SimpMessagingTemplate messagingTemplate}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{                        MessageService messageService}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{                        ChatService chatService}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{                        UserService userService}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{                        AuthService authService}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{messagingTemplate}} {\cf11{=}} {\cf2{messagingTemplate}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{messageService}} {\cf11{=}} {\cf2{messageService}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{chatService}} {\cf11{=}} {\cf2{chatService}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{userService}} {\cf11{=}} {\cf2{userService}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{authService}} {\cf11{=}} {\cf2{authService}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @MessageMapping\b0 }}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"/chat"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{processMessage}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf15{\b @Payload\b0 }} {\cf2{ChatPayload payload}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    String auth}} {\cf11{=}} {\cf2{payload}}{\cf11{.}}{\cf2{}}{\cf16{auth}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{    User u}} {\cf11{=}} {\cf2{authService}}{\cf11{.}}{\cf2{}}{\cf16{validateAccessToken}}{\cf2{}}{\cf11{(}}{\cf2{auth}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{    Message message}} {\cf11{=}} {\cf2{payload}}{\cf11{.}}{\cf2{}}{\cf16{message}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(!}}{\cf2{message}}{\cf11{.}}{\cf2{}}{\cf16{getSender}}{\cf2{}}{\cf11{().}}{\cf2{}}{\cf16{equals}}{\cf2{}}{\cf11{(}}{\cf2{u}}{\cf11{.}}{\cf2{}}{\cf16{getId}}{\cf2{}}{\cf11{()))}} {\cf2{}}{\cf13{\b throw\b0 }} {\cf2{Error}}{\cf11{.}}{\cf2{BAD_REQUEST}}{\cf11{.}}{\cf2{}}{\cf16{get}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // TODO Verify recipient is friend\i0 }}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{    Chat chat}} {\cf11{=}} {\cf2{chatService}}{\cf11{.}}{\cf2{}}{\cf16{getChat}}{\cf2{}}{\cf11{(}}{\cf2{message}}{\cf11{.}}{\cf2{}}{\cf16{getSender}}{\cf2{}}{\cf11{(),}} {\cf2{message}}{\cf11{.}}{\cf2{}}{\cf16{getRecipient}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{    message}}{\cf11{.}}{\cf2{}}{\cf16{setChat}}{\cf2{}}{\cf11{(}}{\cf2{chat}}{\cf11{.}}{\cf2{}}{\cf16{getId}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{    Message saved}} {\cf11{=}} {\cf2{messageService}}{\cf11{.}}{\cf2{}}{\cf16{saveMessage}}{\cf2{}}{\cf11{(}}{\cf2{message}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{    messagingTemplate}}{\cf11{.}}{\cf2{}}{\cf16{convertAndSendToUser}}{\cf2{}}{\cf11{(}}{\cf2{message}}{\cf11{.}}{\cf2{}}{\cf16{getRecipient}}{\cf2{}}{\cf11{(),}} {\cf2{}}{\cf3{"/queue/messages"}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{}}{\cf16{ChatNotification}}{\cf2{}}{\cf11{(}}}\par\pard
\cbpat1{{\cf2{        saved}}{\cf11{.}}{\cf2{}}{\cf16{getId}}{\cf2{}}{\cf11{(),}} {\cf2{saved}}{\cf11{.}}{\cf2{}}{\cf16{getSender}}{\cf2{}}{\cf11{(),}} {\cf2{userService}}{\cf11{.}}{\cf2{}}{\cf16{getUser}}{\cf2{}}{\cf11{(}}{\cf2{saved}}{\cf11{.}}{\cf2{}}{\cf16{getId}}{\cf2{}}{\cf11{()).}}{\cf2{}}{\cf16{getFullName}}{\cf2{}}{\cf11{()}}}\par\pard
\cbpat1{{\cf2{}}    {\cf11{));}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @GetMapping\b0 }}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"/chats/\{chatee\}"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{List}}{\cf11{<}}{\cf2{Message}}{\cf11{>}} {\cf2{}}{\cf16{findChatHistory}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf15{\b @CookieValue\b0 }}{\cf2{}}{\cf11{(}}{\cf2{name}} {\cf11{=}} {\cf2{}}{\cf3{"token"}}{\cf2{}}{\cf11{,}} {\cf2{required}} {\cf11{=}} {\cf2{}}{\cf14{false}}{\cf2{}}{\cf11{)}} {\cf2{String token}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{}}                                       {\cf15{\b @PathVariable\b0 }} {\cf2{String chatee}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    User u}} {\cf11{=}} {\cf2{authService}}{\cf11{.}}{\cf2{}}{\cf16{validateAccessToken}}{\cf2{}}{\cf11{(}}{\cf2{token}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    Chat chat}} {\cf11{=}} {\cf2{chatService}}{\cf11{.}}{\cf2{}}{\cf16{getChat}}{\cf2{}}{\cf11{(}}{\cf2{u}}{\cf11{.}}{\cf2{}}{\cf16{getId}}{\cf2{}}{\cf11{(),}} {\cf2{chatee}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(!}}{\cf2{chat}}{\cf11{.}}{\cf2{}}{\cf16{containsUser}}{\cf2{}}{\cf11{(}}{\cf2{u}}{\cf11{.}}{\cf2{}}{\cf16{getId}}{\cf2{}}{\cf11{()))}} {\cf2{}}{\cf13{\b throw\b0 }} {\cf2{Error}}{\cf11{.}}{\cf2{FORBIDDEN}}{\cf11{.}}{\cf2{}}{\cf16{get}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // Get the other participant's id\i0 }}}\par\pard
\cbpat1{{\cf2{    String sender}} {\cf11{=}} {\cf2{u}}{\cf11{.}}{\cf2{}}{\cf16{getId}}{\cf2{}}{\cf11{().}}{\cf2{}}{\cf16{equals}}{\cf2{}}{\cf11{(}}{\cf2{chat}}{\cf11{.}}{\cf2{}}{\cf16{getUser{1}}}{\cf2{}}{\cf11{())}} {\cf2{? chat}}{\cf11{.}}{\cf2{}}{\cf16{getUser{2}}}{\cf2{}}{\cf11{() :}} {\cf2{chat}}{\cf11{.}}{\cf2{}}{\cf16{getUser{1}}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // Update the status of the messages, and return the messages (two queries)\i0 }}}\par\pard
\cbpat1{{\cf2{    messageService}}{\cf11{.}}{\cf2{}}{\cf16{updateStatus}}{\cf2{}}{\cf11{(}}{\cf2{chat}}{\cf11{,}} {\cf2{sender}}{\cf11{,}} {\cf2{u}}{\cf11{.}}{\cf2{}}{\cf16{getId}}{\cf2{}}{\cf11{(),}} {\cf2{MessageStatus}}{\cf11{.}}{\cf2{DELIVERED}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{messageService}}{\cf11{.}}{\cf2{}}{\cf16{findChatHistory}}{\cf2{}}{\cf11{(}}{\cf2{chat}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @GetMapping\b0 }}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"/messages/\{id\}"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{Message}} {\cf16{findMessage}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf15{\b @CookieValue\b0 }}{\cf2{}}{\cf11{(}}{\cf2{name}} {\cf11{=}} {\cf2{}}{\cf3{"token"}}{\cf2{}}{\cf11{,}} {\cf2{required}} {\cf11{=}} {\cf2{}}{\cf14{false}}{\cf2{}}{\cf11{)}} {\cf2{String token}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{}}                             {\cf15{\b @PathVariable\b0 }} {\cf2{String id}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    User u}} {\cf11{=}} {\cf2{authService}}{\cf11{.}}{\cf2{}}{\cf16{validateAccessToken}}{\cf2{}}{\cf11{(}}{\cf2{token}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{    Message msg}} {\cf11{=}} {\cf2{messageService}}{\cf11{.}}{\cf2{}}{\cf16{findMessage}}{\cf2{}}{\cf11{(}}{\cf2{id}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{msg}}{\cf11{.}}{\cf2{}}{\cf16{getSender}}{\cf2{}}{\cf11{().}}{\cf2{}}{\cf16{equals}}{\cf2{}}{\cf11{(}}{\cf2{u}}{\cf11{.}}{\cf2{}}{\cf16{getId}}{\cf2{}}{\cf11{()) ||}} {\cf2{msg}}{\cf11{.}}{\cf2{}}{\cf16{getRecipient}}{\cf2{}}{\cf11{().}}{\cf2{}}{\cf16{equals}}{\cf2{}}{\cf11{(}}{\cf2{u}}{\cf11{.}}{\cf2{}}{\cf16{getId}}{\cf2{}}{\cf11{()))}} {\cf2{}}{\cf13{\b return\b0 }} {\cf2{msg}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b throw\b0 }} {\cf2{Error}}{\cf11{.}}{\cf2{FORBIDDEN}}{\cf11{.}}{\cf2{}}{\cf16{get}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/chat/ChatNotification.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{chat}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public\b0 }} {\cf2{record}} {\cf16{ChatNotification}}{\cf2{}}{\cf11{(}}{\cf2{String id}}{\cf11{,}} {\cf2{String senderId}}{\cf11{,}} {\cf2{String name}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/chat/ChatPayload.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{chat}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public\b0 }} {\cf2{record}} {\cf16{ChatPayload}}{\cf2{}}{\cf11{(}}{\cf2{String auth}}{\cf11{,}} {\cf2{Message message}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/chat/ChatService.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{chat}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{repo}}{\cf11{.}}{\cf2{ChatRepository}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{Error}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{apache}}{\cf11{.}}{\cf2{commons}}{\cf11{.}}{\cf2{codec}}{\cf11{.}}{\cf2{digest}}{\cf11{.}}{\cf2{DigestUtils}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{beans}}{\cf11{.}}{\cf2{factory}}{\cf11{.}}{\cf2{annotation}}{\cf11{.}}{\cf2{Autowired}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{stereotype}}{\cf11{.}}{\cf2{Service}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{Arrays}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf15{\b @Service\b0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public class\b0 }} {\cf2{ChatService}} {\cf11{\{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{ChatRepository chatRepo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{DigestUtils hash}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Autowired\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{}}{\cf16{ChatService}}{\cf2{}}{\cf11{(}}{\cf2{ChatRepository chatRepo}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{chatRepo}} {\cf11{=}} {\cf2{chatRepo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{hash}} {\cf11{=}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{}}{\cf16{DigestUtils}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"SHA{3}-{2}{5}{6}"}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{Chat}} {\cf16{registerChat}}{\cf2{}}{\cf11{(}}{\cf2{String user{1}}}{\cf11{,}} {\cf2{String user{2}}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{user{1}}}{\cf11{.}}{\cf2{}}{\cf16{equals}}{\cf2{}}{\cf11{(}}{\cf2{user{2}}}{\cf11{))}} {\cf2{}}{\cf13{\b throw\b0 }} {\cf2{Error}}{\cf11{.}}{\cf2{BAD_REQUEST}}{\cf11{.}}{\cf2{}}{\cf16{get}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{    Chat chat}} {\cf11{=}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{}}{\cf16{Chat}}{\cf2{}}{\cf11{(}}{\cf2{user{1}}}{\cf11{,}} {\cf2{user{2}}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{chatRepo}}{\cf11{.}}{\cf2{}}{\cf16{save}}{\cf2{}}{\cf11{(}}{\cf2{chat}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{Chat}} {\cf16{getChat}}{\cf2{}}{\cf11{(}}{\cf2{String user{1}}}{\cf11{,}} {\cf2{String user{2}}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{user{1}}}{\cf11{.}}{\cf2{}}{\cf16{equals}}{\cf2{}}{\cf11{(}}{\cf2{user{2}}}{\cf11{))}} {\cf2{}}{\cf13{\b throw\b0 }} {\cf2{Error}}{\cf11{.}}{\cf2{BAD_REQUEST}}{\cf11{.}}{\cf2{}}{\cf16{get}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{    String}}{\cf11{[]}} {\cf2{ids}} {\cf11{= \{}}{\cf2{user{1}}}{\cf11{,}} {\cf2{user{2}}}{\cf11{\};}}}\par\pard
\cbpat1{{\cf2{    Arrays}}{\cf11{.}}{\cf2{}}{\cf16{sort}}{\cf2{}}{\cf11{(}}{\cf2{ids}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    String expectedId}} {\cf11{=}} {\cf2{hash}}{\cf11{.}}{\cf2{}}{\cf16{digestAsHex}}{\cf2{}}{\cf11{(}}{\cf2{ids}}{\cf11{[}}{\cf2{}}{\cf4{{0}}}{\cf2{}}{\cf11{] +}} {\cf2{ids}}{\cf11{[}}{\cf2{}}{\cf4{{1}}}{\cf2{}}{\cf11{]);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{chatRepo}}}\par\pard
\cbpat1{{\cf2{}}        {\cf11{.}}{\cf2{}}{\cf16{findById}}{\cf2{}}{\cf11{(}}{\cf2{expectedId}}{\cf11{)}} {\cf2{}}{\cf5{\i // If chat exists - return it\i0 }}}\par\pard
\cbpat1{{\cf2{}}        {\cf11{.}}{\cf2{}}{\cf16{orElse}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf16{registerChat}}{\cf2{}}{\cf11{(}}{\cf2{user{1}}}{\cf11{,}} {\cf2{user{2}}}{\cf11{));}} {\cf2{}}{\cf5{\i // If not - register a new chat\i0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/chat/Message.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{chat}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{javax}}{\cf11{.}}{\cf2{persistence}}{\cf11{.}}{\cf2{Entity}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{javax}}{\cf11{.}}{\cf2{persistence}}{\cf11{.}}{\cf2{Id}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{javax}}{\cf11{.}}{\cf2{persistence}}{\cf11{.}}{\cf2{Lob}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{sql}}{\cf11{.}}{\cf2{Timestamp}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf15{\b @Entity\b0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public class\b0 }} {\cf2{Message}} {\cf13{\b implements\b0 }} {\cf2{Comparable}}{\cf11{<}}{\cf2{Message}}{\cf11{> \{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Id\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{String id}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{String chat}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{MessageType type}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{MessageStatus status}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Lob\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private byte\b0 }}{\cf2{}}{\cf11{[]}} {\cf2{body}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{String sender}}{\cf11{;}} {\cf2{}}{\cf5{\i // User?\i0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{String recipient}}{\cf11{;}} {\cf2{}}{\cf5{\i // User?\i0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{Timestamp sent}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{Timestamp delivered}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{Timestamp seen}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b protected\b0 }} {\cf2{}}{\cf16{Message}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{}}{\cf16{Message}}{\cf2{}}{\cf11{(}}{\cf2{MessageType type}}{\cf11{,}} {\cf2{String chat}}{\cf11{,}} {\cf2{String sender}}{\cf11{,}} {\cf2{String recipient}}{\cf11{,}} {\cf2{}}{\cf13{\b byte\b0 }}{\cf2{}}{\cf11{[]}} {\cf2{body}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // gen id\i0 }}}\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // set timestamp\i0 }}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{type}} {\cf11{=}} {\cf2{type}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{chat}} {\cf11{=}} {\cf2{chat}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{sender}} {\cf11{=}} {\cf2{sender}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{recipient}} {\cf11{=}} {\cf2{recipient}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{body}} {\cf11{=}} {\cf2{body}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{getId}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{id}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setId}}{\cf2{}}{\cf11{(}}{\cf2{String id}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{id}} {\cf11{=}} {\cf2{id}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{getChat}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{chat}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setChat}}{\cf2{}}{\cf11{(}}{\cf2{String chat}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{chat}} {\cf11{=}} {\cf2{chat}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{MessageType}} {\cf16{getType}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{type}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setType}}{\cf2{}}{\cf11{(}}{\cf2{MessageType type}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{type}} {\cf11{=}} {\cf2{type}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{MessageStatus}} {\cf16{getStatus}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{status}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setStatus}}{\cf2{}}{\cf11{(}}{\cf2{MessageStatus status}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{status}} {\cf11{=}} {\cf2{status}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public byte\b0 }}{\cf2{}}{\cf11{[]}} {\cf2{}}{\cf16{getBody}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{body}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setBody}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf13{\b byte\b0 }}{\cf2{}}{\cf11{[]}} {\cf2{body}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{body}} {\cf11{=}} {\cf2{body}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{getSender}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{sender}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setSender}}{\cf2{}}{\cf11{(}}{\cf2{String from}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{sender}} {\cf11{=}} {\cf2{from}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{getRecipient}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{recipient}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setRecipient}}{\cf2{}}{\cf11{(}}{\cf2{String to}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{recipient}} {\cf11{=}} {\cf2{to}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{Timestamp}} {\cf16{getSent}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{sent}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setSent}}{\cf2{}}{\cf11{(}}{\cf2{Timestamp sent}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{sent}} {\cf11{=}} {\cf2{sent}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{Timestamp}} {\cf16{getDelivered}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{delivered}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setDelivered}}{\cf2{}}{\cf11{(}}{\cf2{Timestamp delivered}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{delivered}} {\cf11{=}} {\cf2{delivered}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{Timestamp}} {\cf16{getSeen}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{seen}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setSeen}}{\cf2{}}{\cf11{(}}{\cf2{Timestamp read}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{seen}} {\cf11{=}} {\cf2{read}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Override\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public int\b0 }} {\cf2{}}{\cf16{compareTo}}{\cf2{}}{\cf11{(}}{\cf2{Message o}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{sent}}{\cf11{.}}{\cf2{}}{\cf16{compareTo}}{\cf2{}}{\cf11{(}}{\cf2{o}}{\cf11{.}}{\cf2{sent}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/chat/MessageService.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{chat}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{repo}}{\cf11{.}}{\cf2{MessageRepository}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{Error}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{beans}}{\cf11{.}}{\cf2{factory}}{\cf11{.}}{\cf2{annotation}}{\cf11{.}}{\cf2{Autowired}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{stereotype}}{\cf11{.}}{\cf2{Service}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{ArrayList}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{Collections}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{List}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf15{\b @Service\b0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public class\b0 }} {\cf2{MessageService}} {\cf11{\{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{MessageRepository messageRepo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Autowired\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{}}{\cf16{MessageService}}{\cf2{}}{\cf11{(}}{\cf2{MessageRepository messageRepo}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{messageRepo}} {\cf11{=}} {\cf2{messageRepo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{Message}} {\cf16{saveMessage}}{\cf2{}}{\cf11{(}}{\cf2{Message message}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    message}}{\cf11{.}}{\cf2{}}{\cf16{setStatus}}{\cf2{}}{\cf11{(}}{\cf2{MessageStatus}}{\cf11{.}}{\cf2{SENT}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // TODO Validity checks\i0 }}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{message}}{\cf11{.}}{\cf2{}}{\cf16{getType}}{\cf2{}}{\cf11{() ==}} {\cf2{MessageType}}{\cf11{.}}{\cf2{PUBLIC_KEY}}{\cf11{)}} {\cf2{}}{\cf13{\b return\b0 }} {\cf2{message}}{\cf11{;}} {\cf2{}}{\cf5{\i // Do not persist key messages\i0 }}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{messageRepo}}{\cf11{.}}{\cf2{}}{\cf16{save}}{\cf2{}}{\cf11{(}}{\cf2{message}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{List}}{\cf11{<}}{\cf2{Message}}{\cf11{>}} {\cf2{}}{\cf16{findChatHistory}}{\cf2{}}{\cf11{(}}{\cf2{Chat chat}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    Iterable}}{\cf11{<}}{\cf2{Message}}{\cf11{>}} {\cf2{messages}} {\cf11{=}} {\cf2{messageRepo}}{\cf11{.}}{\cf2{}}{\cf16{findAllByChat}}{\cf2{}}{\cf11{(}}{\cf2{chat}}{\cf11{.}}{\cf2{}}{\cf16{getId}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{    List}}{\cf11{<}}{\cf2{Message}}{\cf11{>}} {\cf2{list}} {\cf11{=}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{ArrayList}}{\cf11{<>();}}}\par\pard
\cbpat1{{\cf2{    messages}}{\cf11{.}}{\cf2{}}{\cf16{forEach}}{\cf2{}}{\cf11{(}}{\cf2{list}}{\cf11{::}}{\cf2{add}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    Collections}}{\cf11{.}}{\cf2{}}{\cf16{sort}}{\cf2{}}{\cf11{(}}{\cf2{list}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{list}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{updateStatus}}{\cf2{}}{\cf11{(}}{\cf2{Chat chat}}{\cf11{,}} {\cf2{String sender}}{\cf11{,}} {\cf2{String recipient}}{\cf11{,}} {\cf2{MessageStatus status}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    messageRepo}}{\cf11{.}}{\cf2{}}{\cf16{updateStatusByChatAndSenderAndRecipient}}{\cf2{}}{\cf11{(}}{\cf2{chat}}{\cf11{.}}{\cf2{}}{\cf16{getId}}{\cf2{}}{\cf11{(),}} {\cf2{sender}}{\cf11{,}} {\cf2{recipient}}{\cf11{,}} {\cf2{status}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{Message}} {\cf16{findMessage}}{\cf2{}}{\cf11{(}}{\cf2{String id}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{messageRepo}}{\cf11{.}}{\cf2{}}{\cf16{findById}}{\cf2{}}{\cf11{(}}{\cf2{id}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}        {\cf11{.}}{\cf2{}}{\cf16{map}}{\cf2{}}{\cf11{(}}{\cf2{m}} {\cf11{-> \{}}}\par\pard
\cbpat1{{\cf2{          m}}{\cf11{.}}{\cf2{}}{\cf16{setStatus}}{\cf2{}}{\cf11{(}}{\cf2{MessageStatus}}{\cf11{.}}{\cf2{DELIVERED}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}          {\cf13{\b return\b0 }} {\cf2{messageRepo}}{\cf11{.}}{\cf2{}}{\cf16{save}}{\cf2{}}{\cf11{(}}{\cf2{m}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}        {\cf11{\})}}}\par\pard
\cbpat1{{\cf2{}}        {\cf11{.}}{\cf2{}}{\cf16{orElseThrow}}{\cf2{}}{\cf11{(}}{\cf2{Error}}{\cf11{.}}{\cf2{NOT_FOUND}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/chat/MessageStatus.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{chat}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public enum\b0 }} {\cf2{MessageStatus}} {\cf11{\{}}}\par\pard
\cbpat1{{\cf2{  SENT}}{\cf11{,}} {\cf2{DELIVERED}}{\cf11{,}} {\cf2{SEEN}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/chat/MessageType.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{chat}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public enum\b0 }} {\cf2{MessageType}} {\cf11{\{}}}\par\pard
\cbpat1{{\cf2{  PUBLIC_KEY}}{\cf11{,}} {\cf2{TEXT}}{\cf11{,}} {\cf2{BLOB}}{\cf11{,}} {\cf2{RECEIPT}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/chat/WebSocketConfig.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{chat}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{com}}{\cf11{.}}{\cf2{fasterxml}}{\cf11{.}}{\cf2{jackson}}{\cf11{.}}{\cf2{databind}}{\cf11{.}}{\cf2{ObjectMapper}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{context}}{\cf11{.}}{\cf2{annotation}}{\cf11{.}}{\cf2{Configuration}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{messaging}}{\cf11{.}}{\cf2{converter}}{\cf11{.}}{\cf2{DefaultContentTypeResolver}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{messaging}}{\cf11{.}}{\cf2{converter}}{\cf11{.}}{\cf2{MappingJackson{2}MessageConverter}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{messaging}}{\cf11{.}}{\cf2{converter}}{\cf11{.}}{\cf2{MessageConverter}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{messaging}}{\cf11{.}}{\cf2{simp}}{\cf11{.}}{\cf2{config}}{\cf11{.}}{\cf2{MessageBrokerRegistry}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{MimeTypeUtils}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{web}}{\cf11{.}}{\cf2{socket}}{\cf11{.}}{\cf2{config}}{\cf11{.}}{\cf2{annotation}}{\cf11{.}}{\cf2{EnableWebSocketMessageBroker}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{web}}{\cf11{.}}{\cf2{socket}}{\cf11{.}}{\cf2{config}}{\cf11{.}}{\cf2{annotation}}{\cf11{.}}{\cf2{StompEndpointRegistry}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{web}}{\cf11{.}}{\cf2{socket}}{\cf11{.}}{\cf2{config}}{\cf11{.}}{\cf2{annotation}}{\cf11{.}}{\cf2{WebSocketMessageBrokerConfigurer}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{List}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf15{\b @Configuration\b0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf15{\b @EnableWebSocketMessageBroker\b0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public class\b0 }} {\cf2{WebSocketConfig}} {\cf13{\b implements\b0 }} {\cf2{WebSocketMessageBrokerConfigurer}} {\cf11{\{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Override\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{configureMessageBroker}}{\cf2{}}{\cf11{(}}{\cf2{MessageBrokerRegistry config}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    config}}{\cf11{.}}{\cf2{}}{\cf16{enableSimpleBroker}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"/user"}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    config}}{\cf11{.}}{\cf2{}}{\cf16{setApplicationDestinationPrefixes}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"/app"}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    config}}{\cf11{.}}{\cf2{}}{\cf16{setUserDestinationPrefix}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"/user"}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Override\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{registerStompEndpoints}}{\cf2{}}{\cf11{(}}{\cf2{StompEndpointRegistry registry}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    registry}}}\par\pard
\cbpat1{{\cf2{}}        {\cf11{.}}{\cf2{}}{\cf16{addEndpoint}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"/ws"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}        {\cf11{.}}{\cf2{}}{\cf16{setAllowedOrigins}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"*"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}        {\cf11{.}}{\cf2{}}{\cf16{withSockJS}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Override\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public boolean\b0 }} {\cf2{}}{\cf16{configureMessageConverters}}{\cf2{}}{\cf11{(}}{\cf2{List}}{\cf11{<}}{\cf2{MessageConverter}}{\cf11{>}} {\cf2{messageConverters}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    DefaultContentTypeResolver resolver}} {\cf11{=}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{}}{\cf16{DefaultContentTypeResolver}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{    resolver}}{\cf11{.}}{\cf2{}}{\cf16{setDefaultMimeType}}{\cf2{}}{\cf11{(}}{\cf2{MimeTypeUtils}}{\cf11{.}}{\cf2{APPLICATION_JSON}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{    MappingJackson{2}MessageConverter converter}} {\cf11{=}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{}}{\cf16{MappingJackson{2}MessageConverter}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{    converter}}{\cf11{.}}{\cf2{}}{\cf16{setObjectMapper}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf13{\b new\b0 }} {\cf2{}}{\cf16{ObjectMapper}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{    converter}}{\cf11{.}}{\cf2{}}{\cf16{setContentTypeResolver}}{\cf2{}}{\cf11{(}}{\cf2{resolver}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    messageConverters}}{\cf11{.}}{\cf2{}}{\cf16{add}}{\cf2{}}{\cf11{(}}{\cf2{converter}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{}}{\cf14{false}}{\cf2{}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/db/IntArrStringConverter.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{db}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{javax}}{\cf11{.}}{\cf2{persistence}}{\cf11{.}}{\cf2{AttributeConverter}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{javax}}{\cf11{.}}{\cf2{persistence}}{\cf11{.}}{\cf2{Converter}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{Arrays}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf15{\b @Converter\b0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public class\b0 }} {\cf2{IntArrStringConverter}} {\cf13{\b implements\b0 }} {\cf2{AttributeConverter}}{\cf11{<}}{\cf2{}}{\cf13{\b int\b0 }}{\cf2{}}{\cf11{[],}} {\cf2{String}}{\cf11{> \{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Override\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{convertToDatabaseColumn}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf13{\b int\b0 }}{\cf2{}}{\cf11{[]}} {\cf2{attribute}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{Arrays}}{\cf11{.}}{\cf2{}}{\cf16{toString}}{\cf2{}}{\cf11{(}}{\cf2{attribute}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Override\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public int\b0 }}{\cf2{}}{\cf11{[]}} {\cf2{}}{\cf16{convertToEntityAttribute}}{\cf2{}}{\cf11{(}}{\cf2{String dbData}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{dbData}} {\cf11{==}} {\cf2{}}{\cf14{null}} {\cf2{}}{\cf11{||}} {\cf2{dbData}}{\cf11{.}}{\cf2{}}{\cf16{equals}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"null"}}{\cf2{}}{\cf11{) ||}} {\cf2{dbData}}{\cf11{.}}{\cf2{}}{\cf16{isBlank}}{\cf2{}}{\cf11{())}} {\cf2{}}{\cf13{\b return\b0 }} {\cf2{}}{\cf14{null}}{\cf2{}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{dbData}}{\cf11{.}}{\cf2{}}{\cf16{charAt}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf4{{0}}}{\cf2{}}{\cf11{) !=}} {\cf2{}}{\cf3{'['}}{\cf2{}} {\cf11{||}} {\cf2{dbData}}{\cf11{.}}{\cf2{}}{\cf16{charAt}}{\cf2{}}{\cf11{(}}{\cf2{dbData}}{\cf11{.}}{\cf2{}}{\cf16{length}}{\cf2{}}{\cf11{() -}} {\cf2{}}{\cf4{{1}}}{\cf2{}}{\cf11{) !=}} {\cf2{}}{\cf3{']'}}{\cf2{}}{\cf11{)}} {\cf2{}}{\cf13{\b throw new\b0 }} {\cf2{}}{\cf16{IllegalArgumentException}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{    dbData}} {\cf11{=}} {\cf2{dbData}}{\cf11{.}}{\cf2{}}{\cf16{substring}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf4{{1}}}{\cf2{}}{\cf11{,}} {\cf2{dbData}}{\cf11{.}}{\cf2{}}{\cf16{length}}{\cf2{}}{\cf11{() -}} {\cf2{}}{\cf4{{1}}}{\cf2{}}{\cf11{);}} {\cf2{}}{\cf5{\i // remove whitespaces\i0 }}}\par\pard
\cbpat1{{\cf2{    String}}{\cf11{[]}} {\cf2{nums}} {\cf11{=}} {\cf2{dbData}}{\cf11{.}}{\cf2{}}{\cf16{split}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{","}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b int\b0 }}{\cf2{}}{\cf11{[]}} {\cf2{arr}} {\cf11{=}} {\cf2{}}{\cf13{\b new int\b0 }}{\cf2{}}{\cf11{[}}{\cf2{nums}}{\cf11{.}}{\cf2{length}}{\cf11{];}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b for\b0 }} {\cf2{}}{\cf11{(}}{\cf2{}}{\cf13{\b int\b0 }} {\cf2{i}} {\cf11{=}} {\cf2{}}{\cf4{{0}}}{\cf2{}}{\cf11{;}} {\cf2{i}} {\cf11{<}} {\cf2{nums}}{\cf11{.}}{\cf2{length}}{\cf11{;}} {\cf2{i}}{\cf11{++) \{}}}\par\pard
\cbpat1{{\cf2{      String n}} {\cf11{=}} {\cf2{nums}}{\cf11{[}}{\cf2{i}}{\cf11{].}}{\cf2{}}{\cf16{trim}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{      arr}}{\cf11{[}}{\cf2{i}}{\cf11{] =}} {\cf2{Integer}}{\cf11{.}}{\cf2{}}{\cf16{parseInt}}{\cf2{}}{\cf11{(}}{\cf2{n}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{arr}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/db/ObjectLobConverter.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{db}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{com}}{\cf11{.}}{\cf2{google}}{\cf11{.}}{\cf2{gson}}{\cf11{.}}{\cf2{Gson}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{javax}}{\cf11{.}}{\cf2{persistence}}{\cf11{.}}{\cf2{Converter}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{javax}}{\cf11{.}}{\cf2{persistence}}{\cf11{.}}{\cf2{AttributeConverter}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{nio}}{\cf11{.}}{\cf2{charset}}{\cf11{.}}{\cf2{StandardCharsets}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{Arrays}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf15{\b @Converter\b0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public class\b0 }} {\cf2{ObjectLobConverter}} {\cf13{\b implements\b0 }} {\cf2{AttributeConverter}}{\cf11{<}}{\cf2{Object}}{\cf11{,}} {\cf2{}}{\cf13{\b byte\b0 }}{\cf2{}}{\cf11{[]> \{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{Gson gson}} {\cf11{=}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{}}{\cf16{Gson}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf5{\i // Generate the byte array for the object\i0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private byte\b0 }}{\cf2{}}{\cf11{[]}} {\cf2{}}{\cf16{genBytes}}{\cf2{}}{\cf11{(}}{\cf2{Object object}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{object}} {\cf13{\b instanceof byte\b0 }}{\cf2{}}{\cf11{[]}} {\cf2{b}}{\cf11{)}} {\cf2{}}{\cf13{\b return\b0 }} {\cf2{b}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{object}} {\cf13{\b instanceof\b0 }} {\cf2{String s}}{\cf11{)}} {\cf2{}}{\cf13{\b return\b0 }} {\cf2{s}}{\cf11{.}}{\cf2{}}{\cf16{getBytes}}{\cf2{}}{\cf11{(}}{\cf2{StandardCharsets}}{\cf11{.}}{\cf2{UTF_{8}}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{gson}}{\cf11{.}}{\cf2{}}{\cf16{toJson}}{\cf2{}}{\cf11{(}}{\cf2{object}}{\cf11{).}}{\cf2{}}{\cf16{getBytes}}{\cf2{}}{\cf11{(}}{\cf2{StandardCharsets}}{\cf11{.}}{\cf2{UTF_{8}}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Override\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public byte\b0 }}{\cf2{}}{\cf11{[]}} {\cf2{}}{\cf16{convertToDatabaseColumn}}{\cf2{}}{\cf11{(}}{\cf2{Object object}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // Generates a byte array representing the object, and pads it with a code representing the original type\i0 }}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b byte\b0 }}{\cf2{}}{\cf11{[]}} {\cf2{arr}} {\cf11{=}} {\cf2{}}{\cf16{genBytes}}{\cf2{}}{\cf11{(}}{\cf2{object}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b byte\b0 }} {\cf2{code}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{object}} {\cf13{\b instanceof byte\b0 }}{\cf2{}}{\cf11{[])}} {\cf2{code}} {\cf11{=}} {\cf2{}}{\cf4{{0}x{0}{0}}}{\cf2{}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b else if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{object}} {\cf13{\b instanceof\b0 }} {\cf2{String}}{\cf11{)}} {\cf2{code}} {\cf11{=}} {\cf2{}}{\cf4{{0}x{0}{1}}}{\cf2{}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b else\b0 }} {\cf2{code}} {\cf11{= (}}{\cf2{}}{\cf13{\b byte\b0 }}{\cf2{}}{\cf11{)}} {\cf2{}}{\cf4{{0}xFF}}{\cf2{}}{\cf11{;}} {\cf2{}}{\cf5{\i // general object\i0 }}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b byte\b0 }}{\cf2{}}{\cf11{[]}} {\cf2{ret}} {\cf11{=}} {\cf2{}}{\cf13{\b new byte\b0 }}{\cf2{}}{\cf11{[}}{\cf2{arr}}{\cf11{.}}{\cf2{length}} {\cf11{+}} {\cf2{}}{\cf4{{1}}}{\cf2{}}{\cf11{];}}}\par\pard
\cbpat1{{\cf2{    ret}}{\cf11{[}}{\cf2{}}{\cf4{{0}}}{\cf2{}}{\cf11{] =}} {\cf2{code}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{    System}}{\cf11{.}}{\cf2{}}{\cf16{arraycopy}}{\cf2{}}{\cf11{(}}{\cf2{arr}}{\cf11{,}} {\cf2{}}{\cf4{{0}}}{\cf2{}}{\cf11{,}} {\cf2{ret}}{\cf11{,}} {\cf2{}}{\cf4{{1}}}{\cf2{}}{\cf11{,}} {\cf2{arr}}{\cf11{.}}{\cf2{length}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{ret}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Override\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{Object}} {\cf16{convertToEntityAttribute}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf13{\b byte\b0 }}{\cf2{}}{\cf11{[]}} {\cf2{arr}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b byte\b0 }} {\cf2{code}} {\cf11{=}} {\cf2{arr}}{\cf11{[}}{\cf2{}}{\cf4{{0}}}{\cf2{}}{\cf11{];}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b byte\b0 }}{\cf2{}}{\cf11{[]}} {\cf2{raw}} {\cf11{=}} {\cf2{Arrays}}{\cf11{.}}{\cf2{}}{\cf16{copyOfRange}}{\cf2{}}{\cf11{(}}{\cf2{arr}}{\cf11{,}} {\cf2{}}{\cf4{{1}}}{\cf2{}}{\cf11{,}} {\cf2{arr}}{\cf11{.}}{\cf2{length}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return switch\b0 }} {\cf2{}}{\cf11{(}}{\cf2{code}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}      {\cf13{\b case\b0 }} {\cf2{}}{\cf4{{0}x{0}{0}}} {\cf2{}}{\cf11{->}} {\cf2{raw}}{\cf11{;}} {\cf2{}}{\cf5{\i // byte[]\i0 }}}\par\pard
\cbpat1{{\cf2{}}      {\cf13{\b case\b0 }} {\cf2{}}{\cf4{{0}x{0}{1}}} {\cf2{}}{\cf11{->}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{}}{\cf16{String}}{\cf2{}}{\cf11{(}}{\cf2{raw}}{\cf11{,}} {\cf2{StandardCharsets}}{\cf11{.}}{\cf2{UTF_{8}}}{\cf11{);}} {\cf2{}}{\cf5{\i // String\i0 }}}\par\pard
\cbpat1{{\cf2{}}      {\cf13{\b default\b0 }} {\cf2{}}{\cf11{->}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{}}{\cf16{String}}{\cf2{}}{\cf11{(}}{\cf2{raw}}{\cf11{,}} {\cf2{StandardCharsets}}{\cf11{.}}{\cf2{UTF_{8}}}{\cf11{);}} {\cf2{}}{\cf5{\i // Json - Resulting method should handle decoding\i0 }}}\par\pard
\cbpat1{{\cf2{}}    {\cf11{\};}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/db/StringArrStringConverter.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{db}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{com}}{\cf11{.}}{\cf2{google}}{\cf11{.}}{\cf2{gson}}{\cf11{.}}{\cf2{Gson}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{javax}}{\cf11{.}}{\cf2{persistence}}{\cf11{.}}{\cf2{AttributeConverter}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{javax}}{\cf11{.}}{\cf2{persistence}}{\cf11{.}}{\cf2{Converter}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf15{\b @Converter\b0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public class\b0 }} {\cf2{StringArrStringConverter}} {\cf13{\b implements\b0 }} {\cf2{AttributeConverter}}{\cf11{<}}{\cf2{String}}{\cf11{[],}} {\cf2{String}}{\cf11{> \{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{Gson gson}} {\cf11{=}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{}}{\cf16{Gson}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Override\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{convertToDatabaseColumn}}{\cf2{}}{\cf11{(}}{\cf2{String}}{\cf11{[]}} {\cf2{attribute}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{gson}}{\cf11{.}}{\cf2{}}{\cf16{toJson}}{\cf2{}}{\cf11{(}}{\cf2{attribute}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Override\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}}{\cf11{[]}} {\cf2{}}{\cf16{convertToEntityAttribute}}{\cf2{}}{\cf11{(}}{\cf2{String dbData}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{gson}}{\cf11{.}}{\cf2{}}{\cf16{fromJson}}{\cf2{}}{\cf11{(}}{\cf2{dbData}}{\cf11{,}} {\cf2{String}}{\cf11{[].}}{\cf2{}}{\cf13{\b class\b0 }}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/external/DataConverter.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{external}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{com}}{\cf11{.}}{\cf2{google}}{\cf11{.}}{\cf2{common}}{\cf11{.}}{\cf2{collect}}{\cf11{.}}{\cf2{BiMap}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{com}}{\cf11{.}}{\cf2{google}}{\cf11{.}}{\cf2{common}}{\cf11{.}}{\cf2{collect}}{\cf11{.}}{\cf2{HashBiMap}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{stereotype}}{\cf11{.}}{\cf2{Component}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf15{\b @Component\b0 }} {\cf2{}}{\cf5{\i // for autowiring support\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public class\b0 }} {\cf2{DataConverter}} {\cf11{\{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{BiMap}}{\cf11{<}}{\cf2{String}}{\cf11{,}} {\cf2{Integer}}{\cf11{>}} {\cf2{grade}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{BiMap}}{\cf11{<}}{\cf2{Integer}}{\cf11{,}} {\cf2{String}}{\cf11{>}} {\cf2{edarg}}{\cf11{;}} {\cf2{}}{\cf5{\i // inverse of grade\i0 }}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{BiMap}}{\cf11{<}}{\cf2{String}}{\cf11{,}} {\cf2{String}}{\cf11{>}} {\cf2{gender}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{BiMap}}{\cf11{<}}{\cf2{String}}{\cf11{,}} {\cf2{String}}{\cf11{>}} {\cf2{redneg}}{\cf11{;}} {\cf2{}}{\cf5{\i // inverse of gender\i0 }}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{}}{\cf16{DataConverter}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{grade}} {\cf11{=}} {\cf2{HashBiMap}}{\cf11{.}}{\cf2{}}{\cf16{create}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{edarg}} {\cf11{=}} {\cf2{grade}}{\cf11{.}}{\cf2{}}{\cf16{inverse}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{    grade}}{\cf11{.}}{\cf2{}}{\cf16{put}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"\'d6"}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf4{{7}}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    grade}}{\cf11{.}}{\cf2{}}{\cf16{put}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{""}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf4{{8}}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    grade}}{\cf11{.}}{\cf2{}}{\cf16{put}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{""}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf4{{9}}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    grade}}{\cf11{.}}{\cf2{}}{\cf16{put}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"\'d9"}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf4{{1}{0}}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    grade}}{\cf11{.}}{\cf2{}}{\cf16{put}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"\'d9"}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf4{{1}{1}}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    grade}}{\cf11{.}}{\cf2{}}{\cf16{put}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"\'d9"}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf4{{1}{2}}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    grade}}{\cf11{.}}{\cf2{}}{\cf16{put}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"\'d9\'d2"}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf4{{1}{3}}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    grade}}{\cf11{.}}{\cf2{}}{\cf16{put}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"\'d9\'d3"}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf4{{1}{4}}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{gender}} {\cf11{=}} {\cf2{HashBiMap}}{\cf11{.}}{\cf2{}}{\cf16{create}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{redneg}} {\cf11{=}} {\cf2{gender}}{\cf11{.}}{\cf2{}}{\cf16{inverse}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{    gender}}{\cf11{.}}{\cf2{}}{\cf16{put}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"\'d6"}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf3{"M"}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    gender}}{\cf11{.}}{\cf2{}}{\cf16{put}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"\'e0"}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf3{"F"}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public int\b0 }} {\cf2{}}{\cf16{grade}}{\cf2{}}{\cf11{(}}{\cf2{String grade}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{grade}}{\cf11{.}}{\cf2{}}{\cf16{get}}{\cf2{}}{\cf11{(}}{\cf2{grade}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{grade}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf13{\b int\b0 }} {\cf2{grade}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{edarg}}{\cf11{.}}{\cf2{}}{\cf16{get}}{\cf2{}}{\cf11{(}}{\cf2{grade}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{genderEn}}{\cf2{}}{\cf11{(}}{\cf2{String genderHe}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{gender}}{\cf11{.}}{\cf2{}}{\cf16{get}}{\cf2{}}{\cf11{(}}{\cf2{genderHe}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{genderHe}}{\cf2{}}{\cf11{(}}{\cf2{String genderEn}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{redneg}}{\cf11{.}}{\cf2{}}{\cf16{get}}{\cf2{}}{\cf11{(}}{\cf2{genderEn}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/external/ExternalDetails.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{external}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public\b0 }} {\cf2{record}} {\cf16{ExternalDetails}}{\cf2{}}{\cf11{(}}{\cf2{String uuid}}{\cf11{,}} {\cf2{String id}}{\cf11{,}} {\cf2{}}{\cf13{\b int\b0 }} {\cf2{grade}}{\cf11{,}} {\cf2{String gender}}{\cf11{,}} {\cf2{String name}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/external/MashovService.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{external}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{com}}{\cf11{.}}{\cf2{google}}{\cf11{.}}{\cf2{gson}}{\cf11{.}}{\cf2{Gson}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{com}}{\cf11{.}}{\cf2{google}}{\cf11{.}}{\cf2{gson}}{\cf11{.}}{\cf2{reflect}}{\cf11{.}}{\cf2{TypeToken}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{com}}{\cf11{.}}{\cf2{jayway}}{\cf11{.}}{\cf2{jsonpath}}{\cf11{.}}{\cf2{JsonPath}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{com}}{\cf11{.}}{\cf2{jayway}}{\cf11{.}}{\cf2{jsonpath}}{\cf11{.}}{\cf2{ReadContext}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{lombok}}{\cf11{.}}{\cf2{extern}}{\cf11{.}}{\cf2{slf{4}j}}{\cf11{.}}{\cf2{Slf{4}j}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{model}}{\cf11{.}}{\cf2{School}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{repo}}{\cf11{.}}{\cf2{SchoolRepository}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{beans}}{\cf11{.}}{\cf2{factory}}{\cf11{.}}{\cf2{annotation}}{\cf11{.}}{\cf2{Autowired}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{boot}}{\cf11{.}}{\cf2{web}}{\cf11{.}}{\cf2{client}}{\cf11{.}}{\cf2{RestTemplateBuilder}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{http}}{\cf11{.*;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{stereotype}}{\cf11{.}}{\cf2{Service}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{web}}{\cf11{.}}{\cf2{client}}{\cf11{.}}{\cf2{RestTemplate}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{web}}{\cf11{.}}{\cf2{server}}{\cf11{.}}{\cf2{ResponseStatusException}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{ArrayList}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{HashMap}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{List}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{Map}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf15{\b @Service\b0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf15{\b @Slf{4}j\b0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public class\b0 }} {\cf2{MashovService}} {\cf11{\{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{RestTemplate restTemplate}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{Gson gson}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{DataConverter dataConverter}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{SchoolRepository schoolRepo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private static final\b0 }} {\cf2{String MASHOV_URL}} {\cf11{=}} {\cf2{}}{\cf3{"https://web.mashov.info/api"}}{\cf2{}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private static final\b0 }} {\cf2{String USER_AGENT}} {\cf11{=}} {\cf2{}}{\cf3{"Mozilla/{5}.{0} (Windows NT {1}{0}.{0}; Win{6}{4}; x{6}{4}) AppleWebKit/{5}{3}{7}.{3}{6} (KHTML, like Gecko) Chrome/{9}{9}.{0}.{4}{8}{4}{4}.{5}{1} Safari/{5}{3}{7}.{3}{6}"}}{\cf2{}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Autowired\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{}}{\cf16{MashovService}}{\cf2{}}{\cf11{(}}{\cf2{RestTemplateBuilder builder}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{                       DataConverter dataConverter}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{                       SchoolRepository schoolRepo}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{dataConverter}} {\cf11{=}} {\cf2{dataConverter}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{restTemplate}} {\cf11{=}} {\cf2{builder}}{\cf11{.}}{\cf2{}}{\cf16{build}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{schoolRepo}} {\cf11{=}} {\cf2{schoolRepo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{gson}} {\cf11{=}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{}}{\cf16{Gson}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{    schoolRepo}}{\cf11{.}}{\cf2{}}{\cf16{saveAll}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf16{fetchSchools}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{Map}}{\cf11{<}}{\cf2{String}}{\cf11{,}} {\cf2{Object}}{\cf11{>}} {\cf2{}}{\cf16{loginMap}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf13{\b int\b0 }} {\cf2{semel}}{\cf11{,}} {\cf2{}}{\cf13{\b int\b0 }} {\cf2{year}}{\cf11{,}} {\cf2{String username}}{\cf11{,}} {\cf2{String password}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    Map}}{\cf11{<}}{\cf2{String}}{\cf11{,}} {\cf2{Object}}{\cf11{>}} {\cf2{map}} {\cf11{=}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{HashMap}}{\cf11{<>();}}}\par\pard
\cbpat1{{\cf2{    map}}{\cf11{.}}{\cf2{}}{\cf16{put}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"apiVersion"}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf3{"{3}.{2}{0}{2}{1}{0}{4}{2}{5}"}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    map}}{\cf11{.}}{\cf2{}}{\cf16{put}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"apiBuild"}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf4{{3}.{2}{0}{2}{1}{0}{4}{2}{5}}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    map}}{\cf11{.}}{\cf2{}}{\cf16{put}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"appBuild"}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf4{{3}.{2}{0}{2}{1}{0}{4}{2}{5}}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    map}}{\cf11{.}}{\cf2{}}{\cf16{put}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"appName"}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf3{"info.mashov.students"}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    map}}{\cf11{.}}{\cf2{}}{\cf16{put}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"appVersion"}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf4{{3}.{2}{0}{2}{1}{0}{4}{2}{5}}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    map}}{\cf11{.}}{\cf2{}}{\cf16{put}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"deviceManufacturer"}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf3{"win"}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    map}}{\cf11{.}}{\cf2{}}{\cf16{put}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"deviceModel"}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf3{"desktop"}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    map}}{\cf11{.}}{\cf2{}}{\cf16{put}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"devicePlatform"}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf3{"chrome"}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    map}}{\cf11{.}}{\cf2{}}{\cf16{put}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"deviceUuid"}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf3{"chrome"}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    map}}{\cf11{.}}{\cf2{}}{\cf16{put}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"deviceVersion"}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf3{"{9}{9}.{0}.{4}{8}{4}{4}.{5}{1}"}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    map}}{\cf11{.}}{\cf2{}}{\cf16{put}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"IsBiometric"}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf14{false}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    map}}{\cf11{.}}{\cf2{}}{\cf16{put}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"username"}}{\cf2{}}{\cf11{,}} {\cf2{username}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    map}}{\cf11{.}}{\cf2{}}{\cf16{put}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"password"}}{\cf2{}}{\cf11{,}} {\cf2{password}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    map}}{\cf11{.}}{\cf2{}}{\cf16{put}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"semel"}}{\cf2{}}{\cf11{,}} {\cf2{semel}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    map}}{\cf11{.}}{\cf2{}}{\cf16{put}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"year"}}{\cf2{}}{\cf11{,}} {\cf2{year}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{map}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{List}}{\cf11{<}}{\cf2{School}}{\cf11{>}} {\cf2{}}{\cf16{fetchSchools}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{    HttpHeaders headers}} {\cf11{=}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{}}{\cf16{HttpHeaders}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{    headers}}{\cf11{.}}{\cf2{}}{\cf16{setAccept}}{\cf2{}}{\cf11{(}}{\cf2{List}}{\cf11{.}}{\cf2{}}{\cf16{of}}{\cf2{}}{\cf11{(}}{\cf2{MediaType}}{\cf11{.}}{\cf2{APPLICATION_JSON}}{\cf11{));}}}\par\pard
\cbpat1{{\cf2{    headers}}{\cf11{.}}{\cf2{}}{\cf16{set}}{\cf2{}}{\cf11{(}}{\cf2{HttpHeaders}}{\cf11{.}}{\cf2{USER_AGENT}}{\cf11{,}} {\cf2{USER_AGENT}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{    HttpEntity}}{\cf11{<}}{\cf2{Void}}{\cf11{>}} {\cf2{entity}} {\cf11{=}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{HttpEntity}}{\cf11{<>(}}{\cf2{headers}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{    ResponseEntity}}{\cf11{<}}{\cf2{String}}{\cf11{>}} {\cf2{response}} {\cf11{=}} {\cf2{restTemplate}}{\cf11{.}}{\cf2{}}{\cf16{exchange}}{\cf2{}}{\cf11{(}}{\cf2{MASHOV_URL}} {\cf11{+}} {\cf2{}}{\cf3{"/schools"}}{\cf2{}}{\cf11{,}} {\cf2{HttpMethod}}{\cf11{.}}{\cf2{GET}}{\cf11{,}} {\cf2{entity}}{\cf11{,}} {\cf2{String}}{\cf11{.}}{\cf2{}}{\cf13{\b class\b0 }}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{    TypeToken}}{\cf11{<}}{\cf2{List}}{\cf11{<}}{\cf2{Map}}{\cf11{<}}{\cf2{String}}{\cf11{,}} {\cf2{Object}}{\cf11{>>>}} {\cf2{typeToken}} {\cf11{=}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{TypeToken}}{\cf11{<>() \{\};}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{    List}}{\cf11{<}}{\cf2{Map}}{\cf11{<}}{\cf2{String}}{\cf11{,}} {\cf2{Object}}{\cf11{>>}} {\cf2{map}} {\cf11{=}} {\cf2{gson}}{\cf11{.}}{\cf2{}}{\cf16{fromJson}}{\cf2{}}{\cf11{(}}{\cf2{response}}{\cf11{.}}{\cf2{}}{\cf16{getBody}}{\cf2{}}{\cf11{(),}} {\cf2{typeToken}}{\cf11{.}}{\cf2{}}{\cf16{getType}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{    List}}{\cf11{<}}{\cf2{School}}{\cf11{>}} {\cf2{ret}} {\cf11{=}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{ArrayList}}{\cf11{<>();}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{map}} {\cf11{!=}} {\cf2{}}{\cf14{null}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{      map}}{\cf11{.}}{\cf2{}}{\cf16{forEach}}{\cf2{}}{\cf11{(}}{\cf2{m}} {\cf11{->}} {\cf2{ret}}{\cf11{.}}{\cf2{}}{\cf16{add}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf13{\b new\b0 }} {\cf2{}}{\cf16{School}}{\cf2{}}{\cf11{(((}}{\cf2{Double}}{\cf11{)}} {\cf2{m}}{\cf11{.}}{\cf2{}}{\cf16{get}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"semel"}}{\cf2{}}{\cf11{)).}}{\cf2{}}{\cf16{intValue}}{\cf2{}}{\cf11{(), (}}{\cf2{String}}{\cf11{)}} {\cf2{m}}{\cf11{.}}{\cf2{}}{\cf16{get}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"name"}}{\cf2{}}{\cf11{),}} {\cf2{}}{\cf14{null}}{\cf2{}}{\cf11{)));}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{ret}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf6{\i /**\i0 }}}\par\pard
\cbpat1{{\cf6{\i    * Connects to Mashov and returns\i0 }}}\par\pard
\cbpat1{{\cf6{\i    *\i0 }}}\par\pard
\cbpat1{{\cf6{\i    * @param semel    The school ID\i0 }}}\par\pard
\cbpat1{{\cf6{\i    * @param year     The login year\i0 }}}\par\pard
\cbpat1{{\cf6{\i    * @param username The user's login username\i0 }}}\par\pard
\cbpat1{{\cf6{\i    * @param password The user's password\i0 }}}\par\pard
\cbpat1{{\cf6{\i    * @return An \{@link ExternalDetails\} with details about the user\i0 }}}\par\pard
\cbpat1{{\cf6{\i    */\i0 }}{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{ExternalDetails}} {\cf16{fetchDetails}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf13{\b int\b0 }} {\cf2{semel}}{\cf11{,}} {\cf2{}}{\cf13{\b int\b0 }} {\cf2{year}}{\cf11{,}} {\cf2{String username}}{\cf11{,}} {\cf2{String password}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    var map}} {\cf11{=}} {\cf2{}}{\cf16{loginMap}}{\cf2{}}{\cf11{(}}{\cf2{semel}}{\cf11{,}} {\cf2{year}}{\cf11{,}} {\cf2{username}}{\cf11{,}} {\cf2{password}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{    HttpHeaders headers}} {\cf11{=}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{}}{\cf16{HttpHeaders}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{    headers}}{\cf11{.}}{\cf2{}}{\cf16{setContentType}}{\cf2{}}{\cf11{(}}{\cf2{MediaType}}{\cf11{.}}{\cf2{APPLICATION_JSON}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    headers}}{\cf11{.}}{\cf2{}}{\cf16{setAccept}}{\cf2{}}{\cf11{(}}{\cf2{List}}{\cf11{.}}{\cf2{}}{\cf16{of}}{\cf2{}}{\cf11{(}}{\cf2{MediaType}}{\cf11{.}}{\cf2{APPLICATION_JSON}}{\cf11{));}}}\par\pard
\cbpat1{{\cf2{    headers}}{\cf11{.}}{\cf2{}}{\cf16{set}}{\cf2{}}{\cf11{(}}{\cf2{HttpHeaders}}{\cf11{.}}{\cf2{USER_AGENT}}{\cf11{,}} {\cf2{USER_AGENT}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{    HttpEntity}}{\cf11{<}}{\cf2{Map}}{\cf11{<}}{\cf2{String}}{\cf11{,}} {\cf2{Object}}{\cf11{>>}} {\cf2{entity}} {\cf11{=}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{HttpEntity}}{\cf11{<>(}}{\cf2{map}}{\cf11{,}} {\cf2{headers}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{    ResponseEntity}}{\cf11{<}}{\cf2{String}}{\cf11{>}} {\cf2{res}} {\cf11{=}} {\cf2{restTemplate}}{\cf11{.}}{\cf2{}}{\cf16{postForEntity}}{\cf2{}}{\cf11{(}}{\cf2{MASHOV_URL}} {\cf11{+}} {\cf2{}}{\cf3{"/login"}}{\cf2{}}{\cf11{,}} {\cf2{entity}}{\cf11{,}} {\cf2{String}}{\cf11{.}}{\cf2{}}{\cf13{\b class\b0 }}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{res}}{\cf11{.}}{\cf2{}}{\cf16{getStatusCode}}{\cf2{}}{\cf11{() !=}} {\cf2{HttpStatus}}{\cf11{.}}{\cf2{OK}}{\cf11{)}} {\cf2{}}{\cf13{\b throw new\b0 }} {\cf2{}}{\cf16{ResponseStatusException}}{\cf2{}}{\cf11{(}}{\cf2{res}}{\cf11{.}}{\cf2{}}{\cf16{getStatusCode}}{\cf2{}}{\cf11{(),}} {\cf2{res}}{\cf11{.}}{\cf2{}}{\cf16{getBody}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{    ReadContext ctx}} {\cf11{=}} {\cf2{JsonPath}}{\cf11{.}}{\cf2{}}{\cf16{parse}}{\cf2{}}{\cf11{(}}{\cf2{res}}{\cf11{.}}{\cf2{}}{\cf16{getBody}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{    String displayName}} {\cf11{=}} {\cf2{ctx}}{\cf11{.}}{\cf2{}}{\cf16{read}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"$.credential.displayName"}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return new\b0 }} {\cf2{}}{\cf16{ExternalDetails}}{\cf2{}}{\cf11{(}}}\par\pard
\cbpat1{{\cf2{        ctx}}{\cf11{.}}{\cf2{}}{\cf16{read}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"$.credential.userId"}}{\cf2{}}{\cf11{),}}}\par\pard
\cbpat1{{\cf2{        ctx}}{\cf11{.}}{\cf2{}}{\cf16{read}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"$.credential.idNumber"}}{\cf2{}}{\cf11{,}} {\cf2{String}}{\cf11{.}}{\cf2{}}{\cf13{\b class\b0 }}{\cf2{}}{\cf11{),}}}\par\pard
\cbpat1{{\cf2{        dataConverter}}{\cf11{.}}{\cf2{}}{\cf16{grade}}{\cf2{}}{\cf11{(}}{\cf2{ctx}}{\cf11{.}}{\cf2{}}{\cf16{read}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"$.accessToken.children[{0}].classCode"}}{\cf2{}}{\cf11{)),}}}\par\pard
\cbpat1{{\cf2{        dataConverter}}{\cf11{.}}{\cf2{}}{\cf16{genderEn}}{\cf2{}}{\cf11{(}}{\cf2{ctx}}{\cf11{.}}{\cf2{}}{\cf16{read}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"$.accessToken.gender"}}{\cf2{}}{\cf11{)),}}}\par\pard
\cbpat1{{\cf2{        displayName}}{\cf11{.}}{\cf2{}}{\cf16{substring}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf4{{0}}}{\cf2{}}{\cf11{,}} {\cf2{displayName}}{\cf11{.}}{\cf2{}}{\cf16{lastIndexOf}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{' '}}{\cf2{}}{\cf11{))}}}\par\pard
\cbpat1{{\cf2{}}    {\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/external/VerificationService.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{external}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{model}}{\cf11{.}}{\cf2{School}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{model}}{\cf11{.}}{\cf2{User}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{model}}{\cf11{.}}{\cf2{Verification}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{repo}}{\cf11{.}}{\cf2{SchoolRepository}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{repo}}{\cf11{.}}{\cf2{UserRepository}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{repo}}{\cf11{.}}{\cf2{VerificationRepository}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{Error}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{beans}}{\cf11{.}}{\cf2{factory}}{\cf11{.}}{\cf2{annotation}}{\cf11{.}}{\cf2{Autowired}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{stereotype}}{\cf11{.}}{\cf2{Service}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{sql}}{\cf11{.}}{\cf2{Timestamp}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{time}}{\cf11{.}}{\cf2{Instant}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{ArrayList}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{List}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf15{\b @Service\b0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public class\b0 }} {\cf2{VerificationService}} {\cf11{\{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{VerificationRepository verificationRepo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{UserRepository userRepo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{SchoolRepository schoolRepo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{MashovService mashovService}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Autowired\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{}}{\cf16{VerificationService}}{\cf2{}}{\cf11{(}}{\cf2{VerificationRepository verificationRepo}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{                             UserRepository userRepo}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{                             SchoolRepository schoolRepo}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{                             MashovService mashovService}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{verificationRepo}} {\cf11{=}} {\cf2{verificationRepo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{userRepo}} {\cf11{=}} {\cf2{userRepo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{schoolRepo}} {\cf11{=}} {\cf2{schoolRepo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{mashovService}} {\cf11{=}} {\cf2{mashovService}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public boolean\b0 }} {\cf2{}}{\cf16{isVerified}}{\cf2{}}{\cf11{(}}{\cf2{User user}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // TODO set up a more robust algorithm\i0 }}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{verificationRepo}}{\cf11{.}}{\cf2{}}{\cf16{existsByUser}}{\cf2{}}{\cf11{(}}{\cf2{user}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{User}} {\cf16{verifyMashov}}{\cf2{}}{\cf11{(}}{\cf2{User user}}{\cf11{,}} {\cf2{}}{\cf13{\b int\b0 }} {\cf2{semel}}{\cf11{,}} {\cf2{}}{\cf13{\b int\b0 }} {\cf2{year}}{\cf11{,}} {\cf2{String username}}{\cf11{,}} {\cf2{String password}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    var details}} {\cf11{=}} {\cf2{mashovService}}{\cf11{.}}{\cf2{}}{\cf16{fetchDetails}}{\cf2{}}{\cf11{(}}{\cf2{semel}}{\cf11{,}} {\cf2{year}}{\cf11{,}} {\cf2{username}}{\cf11{,}} {\cf2{password}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{    Verification gender}} {\cf11{=}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{}}{\cf16{Verification}}{\cf2{}}{\cf11{(}}}\par\pard
\cbpat1{{\cf2{        Verification}}{\cf11{.}}{\cf2{Type}}{\cf11{.}}{\cf2{MASHOV}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{}}        {\cf3{"gender"}}{\cf2{}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{        details}}{\cf11{.}}{\cf2{}}{\cf16{gender}}{\cf2{}}{\cf11{(),}}}\par\pard
\cbpat1{{\cf2{        Timestamp}}{\cf11{.}}{\cf2{}}{\cf16{from}}{\cf2{}}{\cf11{(}}{\cf2{Instant}}{\cf11{.}}{\cf2{}}{\cf16{now}}{\cf2{}}{\cf11{()),}}}\par\pard
\cbpat1{{\cf2{        user}}}\par\pard
\cbpat1{{\cf2{}}    {\cf11{);}}}\par\pard
\cbpat1{{\cf2{    user}}{\cf11{.}}{\cf2{}}{\cf16{setGender}}{\cf2{}}{\cf11{(}}{\cf2{details}}{\cf11{.}}{\cf2{}}{\cf16{gender}}{\cf2{}}{\cf11{().}}{\cf2{}}{\cf16{charAt}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf4{{0}}}{\cf2{}}{\cf11{));}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{    Verification grade}} {\cf11{=}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{}}{\cf16{Verification}}{\cf2{}}{\cf11{(}}}\par\pard
\cbpat1{{\cf2{        Verification}}{\cf11{.}}{\cf2{Type}}{\cf11{.}}{\cf2{MASHOV}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{}}        {\cf3{"grade"}}{\cf2{}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{        String}}{\cf11{.}}{\cf2{}}{\cf16{valueOf}}{\cf2{}}{\cf11{(}}{\cf2{details}}{\cf11{.}}{\cf2{}}{\cf16{grade}}{\cf2{}}{\cf11{()),}}}\par\pard
\cbpat1{{\cf2{        Timestamp}}{\cf11{.}}{\cf2{}}{\cf16{from}}{\cf2{}}{\cf11{(}}{\cf2{Instant}}{\cf11{.}}{\cf2{}}{\cf16{now}}{\cf2{}}{\cf11{()),}}}\par\pard
\cbpat1{{\cf2{        user}}}\par\pard
\cbpat1{{\cf2{}}    {\cf11{);}}}\par\pard
\cbpat1{{\cf2{    user}}{\cf11{.}}{\cf2{}}{\cf16{setGrade}}{\cf2{}}{\cf11{(}}{\cf2{details}}{\cf11{.}}{\cf2{}}{\cf16{grade}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // TODO more verifications?\i0 }}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{    School s}} {\cf11{=}} {\cf2{schoolRepo}}{\cf11{.}}{\cf2{}}{\cf16{findById}}{\cf2{}}{\cf11{(}}{\cf2{semel}}{\cf11{).}}{\cf2{}}{\cf16{orElseThrow}}{\cf2{}}{\cf11{(}}{\cf2{Error}}{\cf11{.}}{\cf2{SERVER_ERROR}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    user}}{\cf11{.}}{\cf2{}}{\cf16{setSchool}}{\cf2{}}{\cf11{(}}{\cf2{s}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{    verificationRepo}}{\cf11{.}}{\cf2{}}{\cf16{saveAll}}{\cf2{}}{\cf11{(}}{\cf2{List}}{\cf11{.}}{\cf2{}}{\cf16{of}}{\cf2{}}{\cf11{(}}{\cf2{gender}}{\cf11{,}} {\cf2{grade}}{\cf11{));}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{userRepo}}{\cf11{.}}{\cf2{}}{\cf16{save}}{\cf2{}}{\cf11{(}}{\cf2{user}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/HeyApplication.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{boot}}{\cf11{.}}{\cf2{SpringApplication}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{boot}}{\cf11{.}}{\cf2{autoconfigure}}{\cf11{.}}{\cf2{SpringBootApplication}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf15{\b @SpringBootApplication\b0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public class\b0 }} {\cf2{HeyApplication}} {\cf11{\{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public static final boolean\b0 }} {\cf2{DEBUG}} {\cf11{=}} {\cf2{}}{\cf14{true}}{\cf2{}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public static void\b0 }} {\cf2{}}{\cf16{main}}{\cf2{}}{\cf11{(}}{\cf2{String}}{\cf11{[]}} {\cf2{args}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    SpringApplication}}{\cf11{.}}{\cf2{}}{\cf16{run}}{\cf2{}}{\cf11{(}}{\cf2{HeyApplication}}{\cf11{.}}{\cf2{}}{\cf13{\b class\b0 }}{\cf2{}}{\cf11{,}} {\cf2{args}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/model/Auth.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{model}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{com}}{\cf11{.}}{\cf2{fasterxml}}{\cf11{.}}{\cf2{jackson}}{\cf11{.}}{\cf2{annotation}}{\cf11{.}}{\cf2{JsonIgnore}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{javax}}{\cf11{.}}{\cf2{persistence}}{\cf11{.*;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{sql}}{\cf11{.}}{\cf2{Timestamp}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf15{\b @Entity\b0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public class\b0 }} {\cf2{Auth}} {\cf11{\{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Id\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{String id}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{String salt}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf6{\i /** sha{2}{5}{6} hash of password - verification at service level */\i0 }}{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{String password}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{Timestamp passwordExpires}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @OneToOne\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @MapsId\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @JoinColumn\b0 }}{\cf2{}}{\cf11{(}}{\cf2{name}} {\cf11{=}} {\cf2{}}{\cf3{"id"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @JsonIgnore\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{User user}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{}}{\cf16{Auth}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{getId}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{id}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setId}}{\cf2{}}{\cf11{(}}{\cf2{String id}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{id}} {\cf11{=}} {\cf2{id}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{getSalt}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{salt}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setSalt}}{\cf2{}}{\cf11{(}}{\cf2{String salt}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{salt}} {\cf11{=}} {\cf2{salt}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{getPassword}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{password}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setPassword}}{\cf2{}}{\cf11{(}}{\cf2{String hash}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{password}} {\cf11{=}} {\cf2{hash}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{Timestamp}} {\cf16{getPasswordExpires}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{passwordExpires}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setPasswordExpires}}{\cf2{}}{\cf11{(}}{\cf2{Timestamp passwordExpires}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{passwordExpires}} {\cf11{=}} {\cf2{passwordExpires}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{User}} {\cf16{getUser}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{user}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setUser}}{\cf2{}}{\cf11{(}}{\cf2{User user}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{user}} {\cf11{=}} {\cf2{user}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/model/Friendship.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{model}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{hibernate}}{\cf11{.}}{\cf2{annotations}}{\cf11{.}}{\cf2{GenericGenerator}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{javax}}{\cf11{.}}{\cf2{persistence}}{\cf11{.*;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf15{\b @Entity\b0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public class\b0 }} {\cf2{Friendship}} {\cf11{\{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Id\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @GeneratedValue\b0 }}{\cf2{}}{\cf11{(}}{\cf2{generator}} {\cf11{=}} {\cf2{}}{\cf3{"uuid"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @GenericGenerator\b0 }}{\cf2{}}{\cf11{(}}{\cf2{name}} {\cf11{=}} {\cf2{}}{\cf3{"uuid"}}{\cf2{}}{\cf11{,}} {\cf2{strategy}} {\cf11{=}} {\cf2{}}{\cf3{"org.hibernate.id.UUIDGenerator"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{String id}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @ManyToOne\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @JoinColumn\b0 }}{\cf2{}}{\cf11{(}}{\cf2{name}} {\cf11{=}} {\cf2{}}{\cf3{"invitor"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{User invitor}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @ManyToOne\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @JoinColumn\b0 }}{\cf2{}}{\cf11{(}}{\cf2{name}} {\cf11{=}} {\cf2{}}{\cf3{"invitee"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{User invitee}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{Status status}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{}}{\cf16{Friendship}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{getId}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{id}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{User}} {\cf16{getInvitor}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{invitor}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setInvitor}}{\cf2{}}{\cf11{(}}{\cf2{User invitor}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{invitor}} {\cf11{=}} {\cf2{invitor}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{User}} {\cf16{getInvitee}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{invitee}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setInvitee}}{\cf2{}}{\cf11{(}}{\cf2{User invitee}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{invitee}} {\cf11{=}} {\cf2{invitee}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{Status}} {\cf16{getStatus}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{status}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setStatus}}{\cf2{}}{\cf11{(}}{\cf2{Status status}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{status}} {\cf11{=}} {\cf2{status}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public enum\b0 }} {\cf2{Status}} {\cf11{\{}}}\par\pard
\cbpat1{{\cf2{    PENDING}}{\cf11{,}} {\cf2{FRIEND}}{\cf11{,}} {\cf2{REJECTED}}{\cf11{,}} {\cf2{STRANGER}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/model/FriendView.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{model}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{List}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf6{\i /**\i0 }}}\par\pard
\cbpat1{{\cf6{\i  * The client view for a friend.\i0 }}}\par\pard
\cbpat1{{\cf6{\i  *\i0 }}}\par\pard
\cbpat1{{\cf6{\i  * @param id The user ID\i0 }}}\par\pard
\cbpat1{{\cf6{\i  * @param username The username (display username)\i0 }}}\par\pard
\cbpat1{{\cf6{\i  * @param firstName The user's first name\i0 }}}\par\pard
\cbpat1{{\cf6{\i  * @param lastName The user's last name\i0 }}}\par\pard
\cbpat1{{\cf6{\i  * @param status Whether the requesting user and this user are friends. Can be null\i0 }}}\par\pard
\cbpat1{{\cf6{\i  * @param initiated Whether the requesting client initiated the request. False if status is null\i0 }}}\par\pard
\cbpat1{{\cf6{\i  * @param bio The user's bio\i0 }}}\par\pard
\cbpat1{{\cf6{\i  * @param school The user's school\i0 }}}\par\pard
\cbpat1{{\cf6{\i  * @param interests A list of this user's interests\i0 }}}\par\pard
\cbpat1{{\cf6{\i  * @param hometown The user's hometown. Can be null\i0 }}}\par\pard
\cbpat1{{\cf6{\i  * @param distance The distance, in km, between this user and the requesting client\i0 }}}\par\pard
\cbpat1{{\cf6{\i  * @param grade The user's grade. Must be between {7} and {1}{2}, inclusive\i0 }}}\par\pard
\cbpat1{{\cf6{\i  * @param gender The user's gender. Must be either M, F, O or X\i0 }}}\par\pard
\cbpat1{{\cf6{\i  * @param matchScore The match score between this user and the requesting client. A value between {0} and {1}, inclusive\i0 }}}\par\pard
\cbpat1{{\cf6{\i  * @see me.rootatkali.hey.service.FriendService#match(User, User)\i0 }}}\par\pard
\cbpat1{{\cf6{\i  * @see me.rootatkali.hey.service.FriendService\i0 }}}\par\pard
\cbpat1{{\cf6{\i  */\i0 }}{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public\b0 }} {\cf2{record}} {\cf16{FriendView}}{\cf2{}}{\cf11{(}}{\cf2{String id}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{                         String username}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{                         String firstName}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{                         String lastName}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{                         Friendship}}{\cf11{.}}{\cf2{Status status}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{}}                         {\cf13{\b boolean\b0 }} {\cf2{initiated}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{                         String bio}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{                         School school}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{                         List}}{\cf11{<}}{\cf2{Interest}}{\cf11{>}} {\cf2{interests}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{                         String hometown}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{}}                         {\cf13{\b double\b0 }} {\cf2{distance}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{                         Integer grade}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{                         Character gender}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{}}                         {\cf13{\b double\b0 }} {\cf2{matchScore}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/model/Interest.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{model}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{com}}{\cf11{.}}{\cf2{fasterxml}}{\cf11{.}}{\cf2{jackson}}{\cf11{.}}{\cf2{annotation}}{\cf11{.}}{\cf2{JsonIgnore}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{com}}{\cf11{.}}{\cf2{google}}{\cf11{.}}{\cf2{common}}{\cf11{.}}{\cf2{collect}}{\cf11{.}}{\cf2{ComparisonChain}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{hibernate}}{\cf11{.}}{\cf2{annotations}}{\cf11{.}}{\cf2{GenericGenerator}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{javax}}{\cf11{.}}{\cf2{persistence}}{\cf11{.*;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{List}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{Objects}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf15{\b @Entity\b0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public class\b0 }} {\cf2{Interest}} {\cf13{\b implements\b0 }} {\cf2{Comparable}}{\cf11{<}}{\cf2{Interest}}{\cf11{> \{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Id\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @GeneratedValue\b0 }}{\cf2{}}{\cf11{(}}{\cf2{generator}} {\cf11{=}} {\cf2{}}{\cf3{"uuid"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @GenericGenerator\b0 }}{\cf2{}}{\cf11{(}}{\cf2{name}} {\cf11{=}} {\cf2{}}{\cf3{"uuid"}}{\cf2{}}{\cf11{,}} {\cf2{strategy}} {\cf11{=}} {\cf2{}}{\cf3{"org.hibernate.id.UUIDGenerator"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{String id}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{String name}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @ManyToMany\b0 }}{\cf2{}}{\cf11{(}}{\cf2{mappedBy}} {\cf11{=}} {\cf2{}}{\cf3{"interests"}}{\cf2{}}{\cf11{,}} {\cf2{cascade}} {\cf11{=}} {\cf2{CascadeType}}{\cf11{.}}{\cf2{ALL}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @JsonIgnore\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{List}}{\cf11{<}}{\cf2{User}}{\cf11{>}} {\cf2{users}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{}}{\cf16{Interest}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{getId}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{id}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setId}}{\cf2{}}{\cf11{(}}{\cf2{String id}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{id}} {\cf11{=}} {\cf2{id}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{getName}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{name}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setName}}{\cf2{}}{\cf11{(}}{\cf2{String name}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{name}} {\cf11{=}} {\cf2{name}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{List}}{\cf11{<}}{\cf2{User}}{\cf11{>}} {\cf2{}}{\cf16{getUsers}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{List}}{\cf11{.}}{\cf2{}}{\cf16{copyOf}}{\cf2{}}{\cf11{(}}{\cf2{users}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Override\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public boolean\b0 }} {\cf2{}}{\cf16{equals}}{\cf2{}}{\cf11{(}}{\cf2{Object o}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{}}{\cf13{\b this\b0 }} {\cf2{}}{\cf11{==}} {\cf2{o}}{\cf11{)}} {\cf2{}}{\cf13{\b return\b0 }} {\cf2{}}{\cf14{true}}{\cf2{}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{o}} {\cf11{==}} {\cf2{}}{\cf14{null}} {\cf2{}}{\cf11{||}} {\cf2{}}{\cf16{getClass}}{\cf2{}}{\cf11{() !=}} {\cf2{o}}{\cf11{.}}{\cf2{}}{\cf16{getClass}}{\cf2{}}{\cf11{())}} {\cf2{}}{\cf13{\b return\b0 }} {\cf2{}}{\cf14{false}}{\cf2{}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{    Interest interest}} {\cf11{= (}}{\cf2{Interest}}{\cf11{)}} {\cf2{o}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{Objects}}{\cf11{.}}{\cf2{}}{\cf16{equals}}{\cf2{}}{\cf11{(}}{\cf2{id}}{\cf11{,}} {\cf2{interest}}{\cf11{.}}{\cf2{id}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Override\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public int\b0 }} {\cf2{}}{\cf16{hashCode}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{Objects}}{\cf11{.}}{\cf2{}}{\cf16{hash}}{\cf2{}}{\cf11{(}}{\cf2{id}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Override\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public int\b0 }} {\cf2{}}{\cf16{compareTo}}{\cf2{}}{\cf11{(}}{\cf2{Interest o}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{ComparisonChain}}{\cf11{.}}{\cf2{}}{\cf16{start}}{\cf2{}}{\cf11{().}}{\cf2{}}{\cf16{compare}}{\cf2{}}{\cf11{(}}{\cf2{name}}{\cf11{,}} {\cf2{o}}{\cf11{.}}{\cf2{name}}{\cf11{).}}{\cf2{}}{\cf16{result}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/model/LatLon.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{model}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public\b0 }} {\cf2{record}} {\cf16{LatLon}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf13{\b double\b0 }} {\cf2{lat}}{\cf11{,}} {\cf2{}}{\cf13{\b double\b0 }} {\cf2{lon}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/model/Location.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{model}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{com}}{\cf11{.}}{\cf2{fasterxml}}{\cf11{.}}{\cf2{jackson}}{\cf11{.}}{\cf2{annotation}}{\cf11{.}}{\cf2{JsonIgnore}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{javax}}{\cf11{.}}{\cf2{persistence}}{\cf11{.*;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{Objects}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf15{\b @Entity\b0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public final class\b0 }} {\cf2{Location}} {\cf11{\{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Id\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{String id}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private double\b0 }} {\cf2{lat}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private double\b0 }} {\cf2{lon}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @OneToOne\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @MapsId\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @JoinColumn\b0 }}{\cf2{}}{\cf11{(}}{\cf2{name}} {\cf11{=}} {\cf2{}}{\cf3{"id"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @JsonIgnore\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{User user}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @SuppressWarnings\b0 }}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"ProtectedMemberInFinalClass"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b protected\b0 }} {\cf2{}}{\cf16{Location}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{}}{\cf16{Location}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf13{\b double\b0 }} {\cf2{lat}}{\cf11{,}} {\cf2{}}{\cf13{\b double\b0 }} {\cf2{lon}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{lat}} {\cf11{=}} {\cf2{lat}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{lon}} {\cf11{=}} {\cf2{lon}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public double\b0 }} {\cf2{}}{\cf16{lat}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{lat}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public double\b0 }} {\cf2{}}{\cf16{lon}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{lon}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{User}} {\cf16{getUser}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{user}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setUser}}{\cf2{}}{\cf11{(}}{\cf2{User user}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{user}} {\cf11{=}} {\cf2{user}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Override\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public boolean\b0 }} {\cf2{}}{\cf16{equals}}{\cf2{}}{\cf11{(}}{\cf2{Object obj}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{obj}} {\cf11{==}} {\cf2{}}{\cf13{\b this\b0 }}{\cf2{}}{\cf11{)}} {\cf2{}}{\cf13{\b return\b0 }} {\cf2{}}{\cf14{true}}{\cf2{}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{obj}} {\cf11{==}} {\cf2{}}{\cf14{null}} {\cf2{}}{\cf11{||}} {\cf2{obj}}{\cf11{.}}{\cf2{}}{\cf16{getClass}}{\cf2{}}{\cf11{() !=}} {\cf2{}}{\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{}}{\cf16{getClass}}{\cf2{}}{\cf11{())}} {\cf2{}}{\cf13{\b return\b0 }} {\cf2{}}{\cf14{false}}{\cf2{}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{    var that}} {\cf11{= (}}{\cf2{Location}}{\cf11{)}} {\cf2{obj}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{Double}}{\cf11{.}}{\cf2{}}{\cf16{doubleToLongBits}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{lat}}{\cf11{) ==}} {\cf2{Double}}{\cf11{.}}{\cf2{}}{\cf16{doubleToLongBits}}{\cf2{}}{\cf11{(}}{\cf2{that}}{\cf11{.}}{\cf2{lat}}{\cf11{) &&}}}\par\pard
\cbpat1{{\cf2{        Double}}{\cf11{.}}{\cf2{}}{\cf16{doubleToLongBits}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{lon}}{\cf11{) ==}} {\cf2{Double}}{\cf11{.}}{\cf2{}}{\cf16{doubleToLongBits}}{\cf2{}}{\cf11{(}}{\cf2{that}}{\cf11{.}}{\cf2{lon}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Override\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public int\b0 }} {\cf2{}}{\cf16{hashCode}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{Objects}}{\cf11{.}}{\cf2{}}{\cf16{hash}}{\cf2{}}{\cf11{(}}{\cf2{lat}}{\cf11{,}} {\cf2{lon}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Override\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{toString}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{}}{\cf3{"Location["}}{\cf2{}} {\cf11{+}}}\par\pard
\cbpat1{{\cf2{}}        {\cf3{"lat="}}{\cf2{}} {\cf11{+}} {\cf2{lat}} {\cf11{+}} {\cf2{}}{\cf3{", "}}{\cf2{}} {\cf11{+}}}\par\pard
\cbpat1{{\cf2{}}        {\cf3{"lon="}}{\cf2{}} {\cf11{+}} {\cf2{lon}} {\cf11{+}} {\cf2{}}{\cf3{']'}}{\cf2{}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/model/Login.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{model}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public\b0 }} {\cf2{record}} {\cf16{Login}}{\cf2{}}{\cf11{(}}{\cf2{String username}}{\cf11{,}} {\cf2{String password}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/model/MashovLogin.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{model}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public\b0 }} {\cf2{record}} {\cf16{MashovLogin}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf13{\b int\b0 }} {\cf2{semel}}{\cf11{,}} {\cf2{}}{\cf13{\b int\b0 }} {\cf2{year}}{\cf11{,}} {\cf2{String username}}{\cf11{,}} {\cf2{String password}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/model/package-info.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf6{\i /**\i0 }}}\par\pard
\cbpat1{{\cf6{\i  * This package contains POJO/Entity models for all data types. SQL tables and relationships are generated using the\i0 }}}\par\pard
\cbpat1{{\cf6{\i  * information in this package.\i0 }}}\par\pard
\cbpat1{{\cf6{\i  */\i0 }}{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{model}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // TODO add classes for authentication [Auth, Verification, VerificationQueue], blob [Blob, BlobPermission]\i0 }}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/model/Permission.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{model}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{javax}}{\cf11{.}}{\cf2{persistence}}{\cf11{.}}{\cf2{Entity}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{javax}}{\cf11{.}}{\cf2{persistence}}{\cf11{.}}{\cf2{GeneratedValue}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{javax}}{\cf11{.}}{\cf2{persistence}}{\cf11{.}}{\cf2{Id}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf15{\b @Entity\b0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public class\b0 }} {\cf2{Permission}} {\cf11{\{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Id\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @GeneratedValue\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private long\b0 }} {\cf2{id}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{String name}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{}}{\cf16{Permission}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public long\b0 }} {\cf2{}}{\cf16{getId}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{id}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{getName}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{name}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setName}}{\cf2{}}{\cf11{(}}{\cf2{String name}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{name}} {\cf11{=}} {\cf2{name}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/model/School.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{model}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{com}}{\cf11{.}}{\cf2{fasterxml}}{\cf11{.}}{\cf2{jackson}}{\cf11{.}}{\cf2{annotation}}{\cf11{.}}{\cf2{JsonIgnore}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{com}}{\cf11{.}}{\cf2{google}}{\cf11{.}}{\cf2{common}}{\cf11{.}}{\cf2{base}}{\cf11{.}}{\cf2{MoreObjects}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{com}}{\cf11{.}}{\cf2{google}}{\cf11{.}}{\cf2{common}}{\cf11{.}}{\cf2{collect}}{\cf11{.}}{\cf2{ComparisonChain}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{javax}}{\cf11{.}}{\cf2{persistence}}{\cf11{.}}{\cf2{CascadeType}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{javax}}{\cf11{.}}{\cf2{persistence}}{\cf11{.}}{\cf2{Entity}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{javax}}{\cf11{.}}{\cf2{persistence}}{\cf11{.}}{\cf2{Id}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{javax}}{\cf11{.}}{\cf2{persistence}}{\cf11{.}}{\cf2{OneToMany}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{List}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{Objects}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf15{\b @Entity\b0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public class\b0 }} {\cf2{School}} {\cf13{\b implements\b0 }} {\cf2{Comparable}}{\cf11{<}}{\cf2{School}}{\cf11{> \{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Id\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private int\b0 }} {\cf2{id}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{String name}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{String town}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @OneToMany\b0 }}{\cf2{}}{\cf11{(}}{\cf2{mappedBy}} {\cf11{=}} {\cf2{}}{\cf3{"school"}}{\cf2{}}{\cf11{,}} {\cf2{cascade}} {\cf11{=}} {\cf2{CascadeType}}{\cf11{.}}{\cf2{ALL}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @JsonIgnore\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{List}}{\cf11{<}}{\cf2{User}}{\cf11{>}} {\cf2{users}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf5{\i // protected {0}ac for jpa\i0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b protected\b0 }} {\cf2{}}{\cf16{School}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{}}{\cf16{School}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf13{\b int\b0 }} {\cf2{id}}{\cf11{,}} {\cf2{String name}}{\cf11{,}} {\cf2{String town}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{id}} {\cf11{=}} {\cf2{id}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{name}} {\cf11{=}} {\cf2{name}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{town}} {\cf11{=}} {\cf2{town}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public int\b0 }} {\cf2{}}{\cf16{getId}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{id}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{getName}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{name}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{getTown}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{town}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{List}}{\cf11{<}}{\cf2{User}}{\cf11{>}} {\cf2{}}{\cf16{getUsers}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{List}}{\cf11{.}}{\cf2{}}{\cf16{copyOf}}{\cf2{}}{\cf11{(}}{\cf2{users}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Override\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{toString}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{MoreObjects}}{\cf11{.}}{\cf2{}}{\cf16{toStringHelper}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf13{\b this\b0 }}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}        {\cf11{.}}{\cf2{}}{\cf16{add}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"id"}}{\cf2{}}{\cf11{,}} {\cf2{id}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}        {\cf11{.}}{\cf2{}}{\cf16{add}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"name"}}{\cf2{}}{\cf11{,}} {\cf2{name}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}        {\cf11{.}}{\cf2{}}{\cf16{add}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"town"}}{\cf2{}}{\cf11{,}} {\cf2{town}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}        {\cf11{.}}{\cf2{}}{\cf16{toString}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Override\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public int\b0 }} {\cf2{}}{\cf16{compareTo}}{\cf2{}}{\cf11{(}}{\cf2{School o}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{ComparisonChain}}{\cf11{.}}{\cf2{}}{\cf16{start}}{\cf2{}}{\cf11{().}}{\cf2{}}{\cf16{compare}}{\cf2{}}{\cf11{(}}{\cf2{id}}{\cf11{,}} {\cf2{o}}{\cf11{.}}{\cf2{id}}{\cf11{).}}{\cf2{}}{\cf16{result}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Override\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public boolean\b0 }} {\cf2{}}{\cf16{equals}}{\cf2{}}{\cf11{(}}{\cf2{Object o}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{}}{\cf13{\b this\b0 }} {\cf2{}}{\cf11{==}} {\cf2{o}}{\cf11{)}} {\cf2{}}{\cf13{\b return\b0 }} {\cf2{}}{\cf14{true}}{\cf2{}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{o}} {\cf11{==}} {\cf2{}}{\cf14{null}} {\cf2{}}{\cf11{||}} {\cf2{}}{\cf16{getClass}}{\cf2{}}{\cf11{() !=}} {\cf2{o}}{\cf11{.}}{\cf2{}}{\cf16{getClass}}{\cf2{}}{\cf11{())}} {\cf2{}}{\cf13{\b return\b0 }} {\cf2{}}{\cf14{false}}{\cf2{}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{    School school}} {\cf11{= (}}{\cf2{School}}{\cf11{)}} {\cf2{o}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{id}} {\cf11{==}} {\cf2{school}}{\cf11{.}}{\cf2{id}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Override\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public int\b0 }} {\cf2{}}{\cf16{hashCode}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{id}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/model/Token.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{model}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{com}}{\cf11{.}}{\cf2{fasterxml}}{\cf11{.}}{\cf2{jackson}}{\cf11{.}}{\cf2{annotation}}{\cf11{.}}{\cf2{JsonIgnore}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{hibernate}}{\cf11{.}}{\cf2{annotations}}{\cf11{.}}{\cf2{GenericGenerator}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{javax}}{\cf11{.}}{\cf2{persistence}}{\cf11{.*;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{sql}}{\cf11{.}}{\cf2{Timestamp}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf15{\b @Entity\b0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public class\b0 }} {\cf2{Token}} {\cf11{\{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Id\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @GeneratedValue\b0 }}{\cf2{}}{\cf11{(}}{\cf2{generator}} {\cf11{=}} {\cf2{}}{\cf3{"uuid"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @GenericGenerator\b0 }}{\cf2{}}{\cf11{(}}{\cf2{name}} {\cf11{=}} {\cf2{}}{\cf3{"uuid"}}{\cf2{}}{\cf11{,}} {\cf2{strategy}} {\cf11{=}} {\cf2{}}{\cf3{"org.hibernate.id.UUIDGenerator"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{String id}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{Timestamp expires}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @ManyToOne\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @JoinColumn\b0 }}{\cf2{}}{\cf11{(}}{\cf2{name}} {\cf11{=}} {\cf2{}}{\cf3{"user"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @JsonIgnore\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{User user}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{}}{\cf16{Token}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{getId}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{id}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{Timestamp}} {\cf16{getExpires}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{expires}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setExpires}}{\cf2{}}{\cf11{(}}{\cf2{Timestamp expires}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{expires}} {\cf11{=}} {\cf2{expires}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{User}} {\cf16{getUser}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{user}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setUser}}{\cf2{}}{\cf11{(}}{\cf2{User user}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{user}} {\cf11{=}} {\cf2{user}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/model/User.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{model}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{com}}{\cf11{.}}{\cf2{fasterxml}}{\cf11{.}}{\cf2{jackson}}{\cf11{.}}{\cf2{annotation}}{\cf11{.}}{\cf2{JsonIgnore}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{UnimplementedException}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{hibernate}}{\cf11{.}}{\cf2{annotations}}{\cf11{.}}{\cf2{GenericGenerator}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{javax}}{\cf11{.}}{\cf2{persistence}}{\cf11{.*;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{sql}}{\cf11{.}}{\cf2{Date}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{List}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{Objects}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf15{\b @Entity\b0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public final class\b0 }} {\cf2{User}} {\cf11{\{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Id\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @GeneratedValue\b0 }}{\cf2{}}{\cf11{(}}{\cf2{generator}} {\cf11{=}} {\cf2{}}{\cf3{"uuid"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @GenericGenerator\b0 }}{\cf2{}}{\cf11{(}}{\cf2{name}} {\cf11{=}} {\cf2{}}{\cf3{"uuid"}}{\cf2{}}{\cf11{,}} {\cf2{strategy}} {\cf11{=}} {\cf2{}}{\cf3{"org.hibernate.id.UUIDGenerator"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{String id}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{String username}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{String firstName}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{String lastName}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{String phoneNum}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{String email}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{String hometown}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{Date birthdate}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{Integer grade}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{Character gender}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Lob\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{String bio}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @ManyToOne\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @JoinColumn\b0 }}{\cf2{}}{\cf11{(}}{\cf2{name}} {\cf11{=}} {\cf2{}}{\cf3{"school"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @JsonIgnore\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{School school}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @OneToOne\b0 }}{\cf2{}}{\cf11{(}}{\cf2{mappedBy}} {\cf11{=}} {\cf2{}}{\cf3{"user"}}{\cf2{}}{\cf11{,}} {\cf2{cascade}} {\cf11{=}} {\cf2{CascadeType}}{\cf11{.}}{\cf2{ALL}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @PrimaryKeyJoinColumn\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @JsonIgnore\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{UserPreferences prefs}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @OneToOne\b0 }}{\cf2{}}{\cf11{(}}{\cf2{mappedBy}} {\cf11{=}} {\cf2{}}{\cf3{"user"}}{\cf2{}}{\cf11{,}} {\cf2{cascade}} {\cf11{=}} {\cf2{CascadeType}}{\cf11{.}}{\cf2{ALL}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @PrimaryKeyJoinColumn\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @JsonIgnore\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{Location location}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @OneToOne\b0 }}{\cf2{}}{\cf11{(}}{\cf2{mappedBy}} {\cf11{=}} {\cf2{}}{\cf3{"user"}}{\cf2{}}{\cf11{,}} {\cf2{cascade}} {\cf11{=}} {\cf2{CascadeType}}{\cf11{.}}{\cf2{ALL}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @PrimaryKeyJoinColumn\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @JsonIgnore\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{Auth auth}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @OneToMany\b0 }}{\cf2{}}{\cf11{(}}{\cf2{mappedBy}} {\cf11{=}} {\cf2{}}{\cf3{"user"}}{\cf2{}}{\cf11{,}}{\cf2{cascade}} {\cf11{=}} {\cf2{CascadeType}}{\cf11{.}}{\cf2{ALL}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @JsonIgnore\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{List}}{\cf11{<}}{\cf2{Token}}{\cf11{>}} {\cf2{tokens}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @OneToMany\b0 }}{\cf2{}}{\cf11{(}}{\cf2{mappedBy}} {\cf11{=}} {\cf2{}}{\cf3{"user"}}{\cf2{}}{\cf11{,}} {\cf2{cascade}} {\cf11{=}} {\cf2{CascadeType}}{\cf11{.}}{\cf2{ALL}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @JsonIgnore\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{List}}{\cf11{<}}{\cf2{Verification}}{\cf11{>}} {\cf2{verifications}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @ManyToMany\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @JoinTable\b0 }}{\cf2{}}{\cf11{(}}}\par\pard
\cbpat1{{\cf2{      name}} {\cf11{=}} {\cf2{}}{\cf3{"user_interest"}}{\cf2{}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{      joinColumns}} {\cf11{=}} {\cf2{}}{\cf15{\b @JoinColumn\b0 }}{\cf2{}}{\cf11{(}}{\cf2{name}} {\cf11{=}} {\cf2{}}{\cf3{"user"}}{\cf2{}}{\cf11{),}}}\par\pard
\cbpat1{{\cf2{      inverseJoinColumns}} {\cf11{=}} {\cf2{}}{\cf15{\b @JoinColumn\b0 }}{\cf2{}}{\cf11{(}}{\cf2{name}} {\cf11{=}} {\cf2{}}{\cf3{"interest"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @JsonIgnore\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{List}}{\cf11{<}}{\cf2{Interest}}{\cf11{>}} {\cf2{interests}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{}}{\cf16{User}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{getId}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{id}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setId}}{\cf2{}}{\cf11{(}}{\cf2{String id}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{id}} {\cf11{=}} {\cf2{id}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{getUsername}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{username}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setUsername}}{\cf2{}}{\cf11{(}}{\cf2{String username}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{username}} {\cf11{=}} {\cf2{username}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{getFirstName}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{firstName}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setFirstName}}{\cf2{}}{\cf11{(}}{\cf2{String firstName}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{firstName}} {\cf11{=}} {\cf2{firstName}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{getLastName}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{lastName}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setLastName}}{\cf2{}}{\cf11{(}}{\cf2{String lastName}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{lastName}} {\cf11{=}} {\cf2{lastName}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{getFullName}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{String}}{\cf11{.}}{\cf2{}}{\cf16{format}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"%s %s"}}{\cf2{}}{\cf11{,}} {\cf2{firstName}}{\cf11{,}} {\cf2{lastName}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{getPhoneNum}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{phoneNum}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setPhoneNum}}{\cf2{}}{\cf11{(}}{\cf2{String phoneNum}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{phoneNum}} {\cf11{=}} {\cf2{phoneNum}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{getEmail}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{email}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setEmail}}{\cf2{}}{\cf11{(}}{\cf2{String email}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{email}} {\cf11{=}} {\cf2{email}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{getHometown}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{hometown}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setHometown}}{\cf2{}}{\cf11{(}}{\cf2{String hometown}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{hometown}} {\cf11{=}} {\cf2{hometown}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{Date}} {\cf16{getBirthdate}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{birthdate}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setBirthdate}}{\cf2{}}{\cf11{(}}{\cf2{Date birthdate}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{birthdate}} {\cf11{=}} {\cf2{birthdate}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{Integer}} {\cf16{getGrade}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{grade}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setGrade}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf13{\b int\b0 }} {\cf2{grade}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{grade}} {\cf11{=}} {\cf2{grade}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{Character}} {\cf16{getGender}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{gender}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setGender}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf13{\b char\b0 }} {\cf2{gender}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{gender}} {\cf11{=}} {\cf2{gender}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{getBio}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{bio}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setBio}}{\cf2{}}{\cf11{(}}{\cf2{String bio}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{bio}} {\cf11{=}} {\cf2{bio}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{School}} {\cf16{getSchool}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{school}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setSchool}}{\cf2{}}{\cf11{(}}{\cf2{School school}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{school}} {\cf11{=}} {\cf2{school}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{UserPreferences}} {\cf16{getPrefs}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{prefs}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setPrefs}}{\cf2{}}{\cf11{(}}{\cf2{UserPreferences prefs}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{prefs}} {\cf11{=}} {\cf2{prefs}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{List}}{\cf11{<}}{\cf2{Interest}}{\cf11{>}} {\cf2{}}{\cf16{getInterests}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{List}}{\cf11{.}}{\cf2{}}{\cf16{copyOf}}{\cf2{}}{\cf11{(}}{\cf2{interests}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setInterests}}{\cf2{}}{\cf11{(}}{\cf2{List}}{\cf11{<}}{\cf2{Interest}}{\cf11{>}} {\cf2{interests}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{interests}} {\cf11{=}} {\cf2{interests}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{Auth}} {\cf16{getAuth}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{auth}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{List}}{\cf11{<}}{\cf2{Token}}{\cf11{>}} {\cf2{}}{\cf16{getTokens}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{tokens}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{List}}{\cf11{<}}{\cf2{Verification}}{\cf11{>}} {\cf2{}}{\cf16{getVerifications}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{verifications}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{Location}} {\cf16{getLocation}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{location}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Override\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public boolean\b0 }} {\cf2{}}{\cf16{equals}}{\cf2{}}{\cf11{(}}{\cf2{Object o}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{}}{\cf13{\b this\b0 }} {\cf2{}}{\cf11{==}} {\cf2{o}}{\cf11{)}} {\cf2{}}{\cf13{\b return\b0 }} {\cf2{}}{\cf14{true}}{\cf2{}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{o}} {\cf11{==}} {\cf2{}}{\cf14{null}} {\cf2{}}{\cf11{||}} {\cf2{}}{\cf16{getClass}}{\cf2{}}{\cf11{() !=}} {\cf2{o}}{\cf11{.}}{\cf2{}}{\cf16{getClass}}{\cf2{}}{\cf11{())}} {\cf2{}}{\cf13{\b return\b0 }} {\cf2{}}{\cf14{false}}{\cf2{}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{    User user}} {\cf11{= (}}{\cf2{User}}{\cf11{)}} {\cf2{o}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{Objects}}{\cf11{.}}{\cf2{}}{\cf16{equals}}{\cf2{}}{\cf11{(}}{\cf2{id}}{\cf11{,}} {\cf2{user}}{\cf11{.}}{\cf2{id}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Override\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public int\b0 }} {\cf2{}}{\cf16{hashCode}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{Objects}}{\cf11{.}}{\cf2{}}{\cf16{hash}}{\cf2{}}{\cf11{(}}{\cf2{id}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/model/UserPreferences.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{model}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{com}}{\cf11{.}}{\cf2{fasterxml}}{\cf11{.}}{\cf2{jackson}}{\cf11{.}}{\cf2{annotation}}{\cf11{.}}{\cf2{JsonIgnore}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{db}}{\cf11{.}}{\cf2{IntArrStringConverter}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{db}}{\cf11{.}}{\cf2{StringArrStringConverter}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{javax}}{\cf11{.}}{\cf2{persistence}}{\cf11{.*;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf15{\b @Entity\b0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public class\b0 }} {\cf2{UserPreferences}} {\cf11{\{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Id\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{String id}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private boolean\b0 }} {\cf2{displayProfilePicture}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private boolean\b0 }} {\cf2{displayHometown}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{String interestedGenders}}{\cf11{;}} {\cf2{}}{\cf5{\i // get genders by using String#toCharArray\i0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Convert\b0 }}{\cf2{}}{\cf11{(}}{\cf2{converter}} {\cf11{=}} {\cf2{IntArrStringConverter}}{\cf11{.}}{\cf2{}}{\cf13{\b class\b0 }}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private int\b0 }}{\cf2{}}{\cf11{[]}} {\cf2{interestedGrades}}{\cf11{;}} {\cf2{}}{\cf5{\i // int[]\i0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Convert\b0 }}{\cf2{}}{\cf11{(}}{\cf2{converter}} {\cf11{=}} {\cf2{StringArrStringConverter}}{\cf11{.}}{\cf2{}}{\cf13{\b class\b0 }}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{String}}{\cf11{[]}} {\cf2{interestedTowns}}{\cf11{;}} {\cf2{}}{\cf5{\i // String[]\i0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Convert\b0 }}{\cf2{}}{\cf11{(}}{\cf2{converter}} {\cf11{=}} {\cf2{IntArrStringConverter}}{\cf11{.}}{\cf2{}}{\cf13{\b class\b0 }}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private int\b0 }}{\cf2{}}{\cf11{[]}} {\cf2{interestedSchools}}{\cf11{;}} {\cf2{}}{\cf5{\i // int[] fk school\i0 }}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @OneToOne\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @MapsId\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @JoinColumn\b0 }}{\cf2{}}{\cf11{(}}{\cf2{name}} {\cf11{=}} {\cf2{}}{\cf3{"id"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @JsonIgnore\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{User user}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{}}{\cf16{UserPreferences}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{getId}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{id}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setId}}{\cf2{}}{\cf11{(}}{\cf2{String id}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{id}} {\cf11{=}} {\cf2{id}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public boolean\b0 }} {\cf2{}}{\cf16{isDisplayProfilePicture}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{displayProfilePicture}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setDisplayProfilePicture}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf13{\b boolean\b0 }} {\cf2{displayProfilePicture}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{displayProfilePicture}} {\cf11{=}} {\cf2{displayProfilePicture}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public boolean\b0 }} {\cf2{}}{\cf16{isDisplayHometown}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{displayHometown}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setDisplayHometown}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf13{\b boolean\b0 }} {\cf2{displayHometown}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{displayHometown}} {\cf11{=}} {\cf2{displayHometown}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public char\b0 }}{\cf2{}}{\cf11{[]}} {\cf2{}}{\cf16{getInterestedGenders}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{interestedGenders}}{\cf11{.}}{\cf2{}}{\cf16{toCharArray}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setInterestedGenders}}{\cf2{}}{\cf11{(}}{\cf2{String interestedGenders}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{interestedGenders}} {\cf11{=}} {\cf2{interestedGenders}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public int\b0 }}{\cf2{}}{\cf11{[]}} {\cf2{}}{\cf16{getInterestedGrades}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{interestedGrades}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setInterestedGrades}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf13{\b int\b0 }}{\cf2{}}{\cf11{[]}} {\cf2{interestedGrades}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{interestedGrades}} {\cf11{=}} {\cf2{interestedGrades}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}}{\cf11{[]}} {\cf2{}}{\cf16{getInterestedTowns}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{interestedTowns}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setInterestedTowns}}{\cf2{}}{\cf11{(}}{\cf2{String}}{\cf11{[]}} {\cf2{interestedTowns}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{interestedTowns}} {\cf11{=}} {\cf2{interestedTowns}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public int\b0 }}{\cf2{}}{\cf11{[]}} {\cf2{}}{\cf16{getInterestedSchools}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{interestedSchools}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setInterestedSchools}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf13{\b int\b0 }}{\cf2{}}{\cf11{[]}} {\cf2{interestedSchools}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{interestedSchools}} {\cf11{=}} {\cf2{interestedSchools}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{User}} {\cf16{getUser}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{user}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setUser}}{\cf2{}}{\cf11{(}}{\cf2{User user}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{user}} {\cf11{=}} {\cf2{user}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/model/UserRegistration.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{model}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{sql}}{\cf11{.}}{\cf2{Date}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public class\b0 }} {\cf2{UserRegistration}} {\cf11{\{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{String username}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{String password}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{String email}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{String firstName}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{String lastName}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{String phoneNum}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{Date birthdate}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{getUsername}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{username}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setUsername}}{\cf2{}}{\cf11{(}}{\cf2{String username}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{username}} {\cf11{=}} {\cf2{username}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{getPassword}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{password}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setPassword}}{\cf2{}}{\cf11{(}}{\cf2{String password}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{password}} {\cf11{=}} {\cf2{password}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{getEmail}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{email}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setEmail}}{\cf2{}}{\cf11{(}}{\cf2{String email}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{email}} {\cf11{=}} {\cf2{email}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{getFirstName}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{firstName}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setFirstName}}{\cf2{}}{\cf11{(}}{\cf2{String firstName}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{firstName}} {\cf11{=}} {\cf2{firstName}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{getLastName}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{lastName}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setLastName}}{\cf2{}}{\cf11{(}}{\cf2{String lastName}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{lastName}} {\cf11{=}} {\cf2{lastName}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{getPhoneNum}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{phoneNum}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setPhoneNum}}{\cf2{}}{\cf11{(}}{\cf2{String phoneNum}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{phoneNum}} {\cf11{=}} {\cf2{phoneNum}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{Date}} {\cf16{getBirthdate}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{birthdate}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setBirthdate}}{\cf2{}}{\cf11{(}}{\cf2{Date birthdate}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{birthdate}} {\cf11{=}} {\cf2{birthdate}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/model/Verification.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{model}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{com}}{\cf11{.}}{\cf2{fasterxml}}{\cf11{.}}{\cf2{jackson}}{\cf11{.}}{\cf2{annotation}}{\cf11{.}}{\cf2{JsonIgnore}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{hibernate}}{\cf11{.}}{\cf2{annotations}}{\cf11{.}}{\cf2{GenericGenerator}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{javax}}{\cf11{.}}{\cf2{persistence}}{\cf11{.*;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{sql}}{\cf11{.}}{\cf2{Timestamp}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{UUID}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf15{\b @Entity\b0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public class\b0 }} {\cf2{Verification}} {\cf11{\{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Id\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @GeneratedValue\b0 }}{\cf2{}}{\cf11{(}}{\cf2{generator}} {\cf11{=}} {\cf2{}}{\cf3{"uuid"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @GenericGenerator\b0 }}{\cf2{}}{\cf11{(}}{\cf2{name}} {\cf11{=}} {\cf2{}}{\cf3{"uuid"}}{\cf2{}}{\cf11{,}} {\cf2{strategy}} {\cf11{=}} {\cf2{}}{\cf3{"org.hibernate.id.UUIDGenerator"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{String id}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{Type type}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{String field}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Lob\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{String data}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{Timestamp timestamp}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @ManyToOne\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @JoinColumn\b0 }}{\cf2{}}{\cf11{(}}{\cf2{name}} {\cf11{=}} {\cf2{}}{\cf3{"user"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @JsonIgnore\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{User user}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{}}{\cf16{Verification}}{\cf2{}}{\cf11{(}}{\cf2{Type type}}{\cf11{,}} {\cf2{String field}}{\cf11{,}} {\cf2{String data}}{\cf11{,}} {\cf2{Timestamp timestamp}}{\cf11{,}} {\cf2{User user}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{type}} {\cf11{=}} {\cf2{type}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{field}} {\cf11{=}} {\cf2{field}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{data}} {\cf11{=}} {\cf2{data}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{timestamp}} {\cf11{=}} {\cf2{timestamp}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{user}} {\cf11{=}} {\cf2{user}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf16{Verification}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{getId}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{id}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setId}}{\cf2{}}{\cf11{(}}{\cf2{String id}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{id}} {\cf11{=}} {\cf2{id}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{Type}} {\cf16{getType}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{type}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setType}}{\cf2{}}{\cf11{(}}{\cf2{Type type}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{type}} {\cf11{=}} {\cf2{type}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{getField}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{field}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setField}}{\cf2{}}{\cf11{(}}{\cf2{String field}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{field}} {\cf11{=}} {\cf2{field}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{String}} {\cf16{getData}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{data}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setData}}{\cf2{}}{\cf11{(}}{\cf2{String data}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{data}} {\cf11{=}} {\cf2{data}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{Timestamp}} {\cf16{getTimestamp}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{timestamp}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setTimestamp}}{\cf2{}}{\cf11{(}}{\cf2{Timestamp timestamp}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{timestamp}} {\cf11{=}} {\cf2{timestamp}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{User}} {\cf16{getUser}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{user}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{setUser}}{\cf2{}}{\cf11{(}}{\cf2{User user}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{user}} {\cf11{=}} {\cf2{user}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public enum\b0 }} {\cf2{Type}} {\cf11{\{}}}\par\pard
\cbpat1{{\cf2{    MANUAL}}{\cf11{,}} {\cf2{MASHOV}}{\cf11{,}} {\cf2{EMAIL}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/repo/AuthRepository.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{repo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{model}}{\cf11{.}}{\cf2{Auth}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{data}}{\cf11{.}}{\cf2{repository}}{\cf11{.}}{\cf2{CrudRepository}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public interface\b0 }} {\cf2{AuthRepository}} {\cf13{\b extends\b0 }} {\cf2{CrudRepository}}{\cf11{<}}{\cf2{Auth}}{\cf11{,}} {\cf2{String}}{\cf11{> \{}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/repo/ChatRepository.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{repo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{chat}}{\cf11{.}}{\cf2{Chat}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{data}}{\cf11{.}}{\cf2{repository}}{\cf11{.}}{\cf2{CrudRepository}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public interface\b0 }} {\cf2{ChatRepository}} {\cf13{\b extends\b0 }} {\cf2{CrudRepository}}{\cf11{<}}{\cf2{Chat}}{\cf11{,}} {\cf2{String}}{\cf11{> \{}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/repo/FriendshipRepository.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{repo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{model}}{\cf11{.}}{\cf2{Friendship}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{model}}{\cf11{.}}{\cf2{User}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{data}}{\cf11{.}}{\cf2{jpa}}{\cf11{.}}{\cf2{repository}}{\cf11{.}}{\cf2{Query}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{data}}{\cf11{.}}{\cf2{repository}}{\cf11{.}}{\cf2{CrudRepository}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{Optional}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public interface\b0 }} {\cf2{FriendshipRepository}} {\cf13{\b extends\b0 }} {\cf2{CrudRepository}}{\cf11{<}}{\cf2{Friendship}}{\cf11{,}} {\cf2{String}}{\cf11{> \{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Query\b0 }}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"select f from Friendship f where f.invitor = ?{1} or f.invitee = ?{1}"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{  Iterable}}{\cf11{<}}{\cf2{Friendship}}{\cf11{>}} {\cf2{}}{\cf16{getFriendshipByUser}}{\cf2{}}{\cf11{(}}{\cf2{User u}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Query\b0 }}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"select f from Friendship f where (f.invitor = ?{1} or f.invitee = ?{1}) and f.status = ?{2}"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{  Iterable}}{\cf11{<}}{\cf2{Friendship}}{\cf11{>}} {\cf2{}}{\cf16{getFriendshipByUserAndStatus}}{\cf2{}}{\cf11{(}}{\cf2{User u}}{\cf11{,}} {\cf2{Friendship}}{\cf11{.}}{\cf2{Status status}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Query\b0 }}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"select f from Friendship f where f.invitor = ?{1}"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{  Iterable}}{\cf11{<}}{\cf2{Friendship}}{\cf11{>}} {\cf2{}}{\cf16{getFriendRequestsByInvitor}}{\cf2{}}{\cf11{(}}{\cf2{User u}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Query\b0 }}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"select f from Friendship f where f.invitee = ?{1} and f.status = ?{2}"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{  Iterable}}{\cf11{<}}{\cf2{Friendship}}{\cf11{>}} {\cf2{}}{\cf16{getPendingRequestsByUserAndStatus}}{\cf2{}}{\cf11{(}}{\cf2{User u}}{\cf11{,}} {\cf2{Friendship}}{\cf11{.}}{\cf2{Status status}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Query\b0 }}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"select f from Friendship f where (f.invitor = ?{1} and f.invitee = ?{2}) or (f.invitor = ?{2} and f.invitee = ?{1})"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{  Optional}}{\cf11{<}}{\cf2{Friendship}}{\cf11{>}} {\cf2{}}{\cf16{findByTwoUsers}}{\cf2{}}{\cf11{(}}{\cf2{User a}}{\cf11{,}} {\cf2{User b}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/repo/InterestRepository.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{repo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{model}}{\cf11{.}}{\cf2{Interest}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{data}}{\cf11{.}}{\cf2{repository}}{\cf11{.}}{\cf2{CrudRepository}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public interface\b0 }} {\cf2{InterestRepository}} {\cf13{\b extends\b0 }} {\cf2{CrudRepository}}{\cf11{<}}{\cf2{Interest}}{\cf11{,}} {\cf2{String}}{\cf11{> \{}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/repo/LocationRepository.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{repo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{model}}{\cf11{.}}{\cf2{Location}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{data}}{\cf11{.}}{\cf2{repository}}{\cf11{.}}{\cf2{CrudRepository}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public interface\b0 }} {\cf2{LocationRepository}} {\cf13{\b extends\b0 }} {\cf2{CrudRepository}}{\cf11{<}}{\cf2{Location}}{\cf11{,}} {\cf2{String}}{\cf11{> \{}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/repo/MessageRepository.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{repo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{chat}}{\cf11{.}}{\cf2{Message}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{chat}}{\cf11{.}}{\cf2{MessageStatus}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{data}}{\cf11{.}}{\cf2{jpa}}{\cf11{.}}{\cf2{repository}}{\cf11{.}}{\cf2{Modifying}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{data}}{\cf11{.}}{\cf2{jpa}}{\cf11{.}}{\cf2{repository}}{\cf11{.}}{\cf2{Query}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{data}}{\cf11{.}}{\cf2{repository}}{\cf11{.}}{\cf2{CrudRepository}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public interface\b0 }} {\cf2{MessageRepository}} {\cf13{\b extends\b0 }} {\cf2{CrudRepository}}{\cf11{<}}{\cf2{Message}}{\cf11{,}} {\cf2{String}}{\cf11{> \{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Query\b0 }}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"select m from Message m where m.chat = ?{1}"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{  Iterable}}{\cf11{<}}{\cf2{Message}}{\cf11{>}} {\cf2{}}{\cf16{findAllByChat}}{\cf2{}}{\cf11{(}}{\cf2{String chat}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Modifying\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Query\b0 }}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"update Message m set m.status = ?{4} where m.chat = ?{1} and m.sender = ?{2} and m.recipient = ?{3}"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b int\b0 }} {\cf2{}}{\cf16{updateStatusByChatAndSenderAndRecipient}}{\cf2{}}{\cf11{(}}{\cf2{String chat}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{                                                            String sender}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{                                                            String recipient}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{                                                            MessageStatus status}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/repo/SchoolRepository.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{repo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{model}}{\cf11{.}}{\cf2{School}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{data}}{\cf11{.}}{\cf2{repository}}{\cf11{.}}{\cf2{CrudRepository}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public interface\b0 }} {\cf2{SchoolRepository}} {\cf13{\b extends\b0 }} {\cf2{CrudRepository}}{\cf11{<}}{\cf2{School}}{\cf11{,}} {\cf2{Integer}}{\cf11{> \{}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/repo/TokenRepository.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{repo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{model}}{\cf11{.}}{\cf2{Token}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{model}}{\cf11{.}}{\cf2{User}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{data}}{\cf11{.}}{\cf2{jpa}}{\cf11{.}}{\cf2{repository}}{\cf11{.}}{\cf2{Query}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{data}}{\cf11{.}}{\cf2{repository}}{\cf11{.}}{\cf2{CrudRepository}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public interface\b0 }} {\cf2{TokenRepository}} {\cf13{\b extends\b0 }} {\cf2{CrudRepository}}{\cf11{<}}{\cf2{Token}}{\cf11{,}} {\cf2{String}}{\cf11{> \{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Query\b0 }}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"select t from Token t where t.user = ?{1}"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{  Iterable}}{\cf11{<}}{\cf2{Token}}{\cf11{>}} {\cf2{}}{\cf16{findAllByUser}}{\cf2{}}{\cf11{(}}{\cf2{User u}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/repo/UserPreferencesRepository.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{repo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{model}}{\cf11{.}}{\cf2{UserPreferences}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{data}}{\cf11{.}}{\cf2{repository}}{\cf11{.}}{\cf2{CrudRepository}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public interface\b0 }} {\cf2{UserPreferencesRepository}} {\cf13{\b extends\b0 }} {\cf2{CrudRepository}}{\cf11{<}}{\cf2{UserPreferences}}{\cf11{,}} {\cf2{String}}{\cf11{> \{}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/repo/UserRepository.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{repo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{model}}{\cf11{.}}{\cf2{User}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{data}}{\cf11{.}}{\cf2{jpa}}{\cf11{.}}{\cf2{repository}}{\cf11{.}}{\cf2{Query}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{data}}{\cf11{.}}{\cf2{repository}}{\cf11{.}}{\cf2{CrudRepository}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{Optional}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public interface\b0 }} {\cf2{UserRepository}} {\cf13{\b extends\b0 }} {\cf2{CrudRepository}}{\cf11{<}}{\cf2{User}}{\cf11{,}} {\cf2{String}}{\cf11{> \{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Query\b0 }}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"select (count(u) > {0}) from User u where u.username = ?{1}"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b boolean\b0 }} {\cf2{}}{\cf16{existsByUsername}}{\cf2{}}{\cf11{(}}{\cf2{String username}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Query\b0 }}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"select u from User u where u.username = ?{1}"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{  Optional}}{\cf11{<}}{\cf2{User}}{\cf11{>}} {\cf2{}}{\cf16{findByUsername}}{\cf2{}}{\cf11{(}}{\cf2{String username}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/repo/VerificationRepository.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{repo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{model}}{\cf11{.}}{\cf2{User}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{model}}{\cf11{.}}{\cf2{Verification}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{data}}{\cf11{.}}{\cf2{jpa}}{\cf11{.}}{\cf2{repository}}{\cf11{.}}{\cf2{Query}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{data}}{\cf11{.}}{\cf2{repository}}{\cf11{.}}{\cf2{CrudRepository}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public interface\b0 }} {\cf2{VerificationRepository}} {\cf13{\b extends\b0 }} {\cf2{CrudRepository}}{\cf11{<}}{\cf2{Verification}}{\cf11{,}} {\cf2{String}}{\cf11{> \{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Query\b0 }}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"select (count(v) > {0}) from Verification v where v.user = ?{1}"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b boolean\b0 }} {\cf2{}}{\cf16{existsByUser}}{\cf2{}}{\cf11{(}}{\cf2{User u}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/rest/GeneralApiController.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{rest}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{lombok}}{\cf11{.}}{\cf2{extern}}{\cf11{.}}{\cf2{slf{4}j}}{\cf11{.}}{\cf2{Slf{4}j}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{HeyApplication}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{external}}{\cf11{.}}{\cf2{VerificationService}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{model}}{\cf11{.*;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{service}}{\cf11{.}}{\cf2{AuthService}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{service}}{\cf11{.}}{\cf2{FriendService}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{service}}{\cf11{.}}{\cf2{SchoolService}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{service}}{\cf11{.}}{\cf2{UserService}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{beans}}{\cf11{.}}{\cf2{factory}}{\cf11{.}}{\cf2{annotation}}{\cf11{.}}{\cf2{Autowired}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{http}}{\cf11{.}}{\cf2{HttpStatus}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{http}}{\cf11{.}}{\cf2{ResponseEntity}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{web}}{\cf11{.}}{\cf2{bind}}{\cf11{.}}{\cf2{annotation}}{\cf11{.*;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{web}}{\cf11{.}}{\cf2{server}}{\cf11{.}}{\cf2{ResponseStatusException}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{javax}}{\cf11{.}}{\cf2{servlet}}{\cf11{.}}{\cf2{http}}{\cf11{.}}{\cf2{Cookie}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{javax}}{\cf11{.}}{\cf2{servlet}}{\cf11{.}}{\cf2{http}}{\cf11{.}}{\cf2{HttpServletResponse}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{time}}{\cf11{.}}{\cf2{LocalDateTime}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{time}}{\cf11{.}}{\cf2{temporal}}{\cf11{.}}{\cf2{ChronoUnit}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{List}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{Optional}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf15{\b @RestController\b0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf15{\b @RequestMapping\b0 }}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"/api"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}{\cf15{\b @Slf{4}j\b0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public class\b0 }} {\cf2{GeneralApiController}} {\cf11{\{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{AuthService authService}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{SchoolService schoolService}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{UserService userService}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{VerificationService verificationService}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{FriendService friendService}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Autowired\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{}}{\cf16{GeneralApiController}}{\cf2{}}{\cf11{(}}{\cf2{UserService userService}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{                              AuthService authService}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{                              SchoolService schoolService}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{                              VerificationService verificationService}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{                              FriendService friendService}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{userService}} {\cf11{=}} {\cf2{userService}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{authService}} {\cf11{=}} {\cf2{authService}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{schoolService}} {\cf11{=}} {\cf2{schoolService}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{verificationService}} {\cf11{=}} {\cf2{verificationService}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{friendService}} {\cf11{=}} {\cf2{friendService}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{User}} {\cf16{tokenAndUser}}{\cf2{}}{\cf11{(}}{\cf2{HttpServletResponse res}}{\cf11{,}} {\cf2{Token t}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    Cookie tokenCookie}} {\cf11{=}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{}}{\cf16{Cookie}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"token"}}{\cf2{}}{\cf11{,}} {\cf2{t}}{\cf11{.}}{\cf2{}}{\cf16{getId}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{    tokenCookie}}{\cf11{.}}{\cf2{}}{\cf16{setHttpOnly}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf14{true}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(!}}{\cf2{HeyApplication}}{\cf11{.}}{\cf2{DEBUG}}{\cf11{)}} {\cf2{tokenCookie}}{\cf11{.}}{\cf2{}}{\cf16{setSecure}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf14{true}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    tokenCookie}}{\cf11{.}}{\cf2{}}{\cf16{setMaxAge}}{\cf2{}}{\cf11{((}}{\cf2{}}{\cf13{\b int\b0 }}{\cf2{}}{\cf11{)}} {\cf2{LocalDateTime}}{\cf11{.}}{\cf2{}}{\cf16{now}}{\cf2{}}{\cf11{().}}{\cf2{}}{\cf16{until}}{\cf2{}}{\cf11{(}}{\cf2{t}}{\cf11{.}}{\cf2{}}{\cf16{getExpires}}{\cf2{}}{\cf11{().}}{\cf2{}}{\cf16{toLocalDateTime}}{\cf2{}}{\cf11{(),}} {\cf2{ChronoUnit}}{\cf11{.}}{\cf2{SECONDS}}{\cf11{));}}}\par\pard
\cbpat1{{\cf2{    res}}{\cf11{.}}{\cf2{}}{\cf16{addCookie}}{\cf2{}}{\cf11{(}}{\cf2{tokenCookie}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{t}}{\cf11{.}}{\cf2{}}{\cf16{getUser}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @GetMapping\b0 }}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"/users"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{Iterable}}{\cf11{<}}{\cf2{User}}{\cf11{>}} {\cf2{}}{\cf16{getUsers}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b throw new\b0 }} {\cf2{}}{\cf16{ResponseStatusException}}{\cf2{}}{\cf11{(}}{\cf2{HttpStatus}}{\cf11{.}}{\cf2{FORBIDDEN}}{\cf11{);}} {\cf2{}}{\cf5{\i // todo permissions\i0 }}}\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // return userService.getUsers();\i0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @GetMapping\b0 }}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"/users/\{id\}"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{User}} {\cf16{getUser}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf15{\b @PathVariable\b0 }} {\cf2{String id}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b throw new\b0 }} {\cf2{}}{\cf16{ResponseStatusException}}{\cf2{}}{\cf11{(}}{\cf2{HttpStatus}}{\cf11{.}}{\cf2{FORBIDDEN}}{\cf11{);}} {\cf2{}}{\cf5{\i // todo permissions\i0 }}}\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // return userService.getUser(id);\i0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @PostMapping\b0 }}{\cf2{}}{\cf11{(}}{\cf2{path}} {\cf11{=}} {\cf2{}}{\cf3{"/users"}}{\cf2{}}{\cf11{,}} {\cf2{consumes}} {\cf11{=}} {\cf2{}}{\cf3{"application/json"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{User}} {\cf16{registerUser}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf15{\b @RequestBody\b0 }} {\cf2{UserRegistration registration}}{\cf11{,}} {\cf2{HttpServletResponse res}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    Token t}} {\cf11{=}} {\cf2{authService}}{\cf11{.}}{\cf2{}}{\cf16{registerUser}}{\cf2{}}{\cf11{(}}{\cf2{registration}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // set cookie\i0 }}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{}}{\cf16{tokenAndUser}}{\cf2{}}{\cf11{(}}{\cf2{res}}{\cf11{,}} {\cf2{t}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @PostMapping\b0 }}{\cf2{}}{\cf11{(}}{\cf2{path}} {\cf11{=}} {\cf2{}}{\cf3{"/login"}}{\cf2{}}{\cf11{,}} {\cf2{consumes}} {\cf11{=}} {\cf2{}}{\cf3{"application/json"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{User}} {\cf16{login}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf15{\b @RequestBody\b0 }} {\cf2{Login login}}{\cf11{,}} {\cf2{HttpServletResponse res}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    Token t}} {\cf11{=}} {\cf2{authService}}{\cf11{.}}{\cf2{}}{\cf16{login}}{\cf2{}}{\cf11{(}}{\cf2{login}}{\cf11{.}}{\cf2{}}{\cf16{username}}{\cf2{}}{\cf11{(),}} {\cf2{login}}{\cf11{.}}{\cf2{}}{\cf16{password}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // set cookie\i0 }}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{}}{\cf16{tokenAndUser}}{\cf2{}}{\cf11{(}}{\cf2{res}}{\cf11{,}} {\cf2{t}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @GetMapping\b0 }}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"/me"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{User}} {\cf16{getMe}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf15{\b @CookieValue\b0 }}{\cf2{}}{\cf11{(}}{\cf2{name}} {\cf11{=}} {\cf2{}}{\cf3{"token"}}{\cf2{}}{\cf11{,}} {\cf2{required}} {\cf11{=}} {\cf2{}}{\cf14{false}}{\cf2{}}{\cf11{)}} {\cf2{String token}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{authService}}{\cf11{.}}{\cf2{}}{\cf16{validateAccessToken}}{\cf2{}}{\cf11{(}}{\cf2{token}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @PatchMapping\b0 }}{\cf2{}}{\cf11{(}}{\cf2{path}} {\cf11{=}} {\cf2{}}{\cf3{"/me"}}{\cf2{}}{\cf11{,}} {\cf2{consumes}} {\cf11{=}} {\cf2{}}{\cf3{"application/json"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{User}} {\cf16{editMe}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf15{\b @CookieValue\b0 }}{\cf2{}}{\cf11{(}}{\cf2{name}} {\cf11{=}} {\cf2{}}{\cf3{"token"}}{\cf2{}}{\cf11{,}} {\cf2{required}} {\cf11{=}} {\cf2{}}{\cf14{false}}{\cf2{}}{\cf11{)}} {\cf2{String token}}{\cf11{,}} {\cf2{}}{\cf15{\b @RequestBody\b0 }} {\cf2{User edit}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    User u}} {\cf11{=}} {\cf2{}}{\cf16{getMe}}{\cf2{}}{\cf11{(}}{\cf2{token}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{userService}}{\cf11{.}}{\cf2{}}{\cf16{editUser}}{\cf2{}}{\cf11{(}}{\cf2{u}}{\cf11{,}} {\cf2{edit}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @GetMapping\b0 }}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"/me/location"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{Location}} {\cf16{getLocation}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf15{\b @CookieValue\b0 }}{\cf2{}}{\cf11{(}}{\cf2{name}} {\cf11{=}} {\cf2{}}{\cf3{"token"}}{\cf2{}}{\cf11{,}} {\cf2{required}} {\cf11{=}} {\cf2{}}{\cf14{false}}{\cf2{}}{\cf11{)}} {\cf2{String token}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    User u}} {\cf11{=}} {\cf2{}}{\cf16{getMe}}{\cf2{}}{\cf11{(}}{\cf2{token}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{userService}}{\cf11{.}}{\cf2{}}{\cf16{getLocation}}{\cf2{}}{\cf11{(}}{\cf2{u}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @PostMapping\b0 }}{\cf2{}}{\cf11{(}}{\cf2{path}} {\cf11{=}} {\cf2{}}{\cf3{"/me/location"}}{\cf2{}}{\cf11{,}} {\cf2{consumes}} {\cf11{=}} {\cf2{}}{\cf3{"application/json"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{LatLon}} {\cf16{setLocation}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf15{\b @CookieValue\b0 }}{\cf2{}}{\cf11{(}}{\cf2{name}} {\cf11{=}} {\cf2{}}{\cf3{"token"}}{\cf2{}}{\cf11{,}} {\cf2{required}} {\cf11{=}} {\cf2{}}{\cf14{false}}{\cf2{}}{\cf11{)}} {\cf2{String token}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{}}                              {\cf15{\b @RequestBody\b0 }} {\cf2{LatLon location}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    User u}} {\cf11{=}} {\cf2{}}{\cf16{getMe}}{\cf2{}}{\cf11{(}}{\cf2{token}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{userService}}{\cf11{.}}{\cf2{}}{\cf16{setLocation}}{\cf2{}}{\cf11{(}}{\cf2{u}}{\cf11{,}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{}}{\cf16{Location}}{\cf2{}}{\cf11{(}}{\cf2{location}}{\cf11{.}}{\cf2{}}{\cf16{lat}}{\cf2{}}{\cf11{(),}} {\cf2{location}}{\cf11{.}}{\cf2{}}{\cf16{lon}}{\cf2{}}{\cf11{()));}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @GetMapping\b0 }}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"/schools"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{Iterable}}{\cf11{<}}{\cf2{School}}{\cf11{>}} {\cf2{}}{\cf16{getSchools}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf15{\b @CookieValue\b0 }}{\cf2{}}{\cf11{(}}{\cf2{name}} {\cf11{=}} {\cf2{}}{\cf3{"token"}}{\cf2{}}{\cf11{,}} {\cf2{required}} {\cf11{=}} {\cf2{}}{\cf14{false}}{\cf2{}}{\cf11{)}} {\cf2{String token}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    authService}}{\cf11{.}}{\cf2{}}{\cf16{validateAccessToken}}{\cf2{}}{\cf11{(}}{\cf2{token}}{\cf11{);}} {\cf2{}}{\cf5{\i // not dependent on user - no need for getMe\i0 }}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{schoolService}}{\cf11{.}}{\cf2{}}{\cf16{getSchools}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @GetMapping\b0 }}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"/verify"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public boolean\b0 }} {\cf2{}}{\cf16{isVerified}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf15{\b @CookieValue\b0 }}{\cf2{}}{\cf11{(}}{\cf2{name}} {\cf11{=}} {\cf2{}}{\cf3{"token"}}{\cf2{}}{\cf11{,}} {\cf2{required}} {\cf11{=}} {\cf2{}}{\cf14{false}}{\cf2{}}{\cf11{)}} {\cf2{String token}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    User u}} {\cf11{=}} {\cf2{}}{\cf16{getMe}}{\cf2{}}{\cf11{(}}{\cf2{token}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{verificationService}}{\cf11{.}}{\cf2{}}{\cf16{isVerified}}{\cf2{}}{\cf11{(}}{\cf2{u}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @PostMapping\b0 }}{\cf2{}}{\cf11{(}}{\cf2{path}} {\cf11{=}} {\cf2{}}{\cf3{"/verify/mashov"}}{\cf2{}}{\cf11{,}} {\cf2{consumes}} {\cf11{=}} {\cf2{}}{\cf3{"application/json"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{User}} {\cf16{verifyMashov}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf15{\b @CookieValue\b0 }}{\cf2{}}{\cf11{(}}{\cf2{name}} {\cf11{=}} {\cf2{}}{\cf3{"token"}}{\cf2{}}{\cf11{,}} {\cf2{required}} {\cf11{=}} {\cf2{}}{\cf14{false}}{\cf2{}}{\cf11{)}} {\cf2{String token}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{}}                           {\cf15{\b @RequestBody\b0 }} {\cf2{MashovLogin login}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    User u}} {\cf11{=}} {\cf2{}}{\cf16{getMe}}{\cf2{}}{\cf11{(}}{\cf2{token}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{verificationService}}{\cf11{.}}{\cf2{}}{\cf16{verifyMashov}}{\cf2{}}{\cf11{(}}}\par\pard
\cbpat1{{\cf2{        u}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{        login}}{\cf11{.}}{\cf2{}}{\cf16{semel}}{\cf2{}}{\cf11{(),}}}\par\pard
\cbpat1{{\cf2{        login}}{\cf11{.}}{\cf2{}}{\cf16{year}}{\cf2{}}{\cf11{(),}}}\par\pard
\cbpat1{{\cf2{        login}}{\cf11{.}}{\cf2{}}{\cf16{username}}{\cf2{}}{\cf11{(),}}}\par\pard
\cbpat1{{\cf2{        login}}{\cf11{.}}{\cf2{}}{\cf16{password}}{\cf2{}}{\cf11{()}}}\par\pard
\cbpat1{{\cf2{}}    {\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Deprecated\b0 }}{\cf2{}}{\cf11{(}}{\cf2{forRemoval}} {\cf11{=}} {\cf2{}}{\cf14{true}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @PostMapping\b0 }}{\cf2{}}{\cf11{(}}{\cf2{path}} {\cf11{=}} {\cf2{}}{\cf3{"/verify/debug/school"}}{\cf2{}}{\cf11{,}} {\cf2{consumes}} {\cf11{=}} {\cf2{}}{\cf3{"application/json"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{User}} {\cf16{manuallySetSchool}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf15{\b @CookieValue\b0 }}{\cf2{}}{\cf11{(}}{\cf2{name}} {\cf11{=}} {\cf2{}}{\cf3{"token"}}{\cf2{}}{\cf11{,}} {\cf2{required}} {\cf11{=}} {\cf2{}}{\cf14{false}}{\cf2{}}{\cf11{)}} {\cf2{String token}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{}}                                {\cf15{\b @RequestBody\b0 }} {\cf2{School school}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    User u}} {\cf11{=}} {\cf2{}}{\cf16{getMe}}{\cf2{}}{\cf11{(}}{\cf2{token}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{userService}}{\cf11{.}}{\cf2{}}{\cf16{setSchool}}{\cf2{}}{\cf11{(}}{\cf2{u}}{\cf11{,}} {\cf2{school}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @PostMapping\b0 }}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"/users/\{user\}/changePassword"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{User}} {\cf16{resetPassword}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf15{\b @PathVariable\b0 }} {\cf2{String user}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{}}                            {\cf15{\b @RequestBody\b0 }} {\cf2{String oldPassword}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{}}                            {\cf15{\b @RequestBody\b0 }} {\cf2{String newPassword}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{                            HttpServletResponse res}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    Token t}} {\cf11{=}} {\cf2{authService}}{\cf11{.}}{\cf2{}}{\cf16{resetPassword}}{\cf2{}}{\cf11{(}}{\cf2{user}}{\cf11{,}} {\cf2{oldPassword}}{\cf11{,}} {\cf2{newPassword}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // set cookie\i0 }}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{}}{\cf16{tokenAndUser}}{\cf2{}}{\cf11{(}}{\cf2{res}}{\cf11{,}} {\cf2{t}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @GetMapping\b0 }}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"/interests"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{List}}{\cf11{<}}{\cf2{Interest}}{\cf11{>}} {\cf2{}}{\cf16{getInterests}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf15{\b @CookieValue\b0 }}{\cf2{}}{\cf11{(}}{\cf2{name}} {\cf11{=}} {\cf2{}}{\cf3{"token"}}{\cf2{}}{\cf11{,}} {\cf2{required}} {\cf11{=}} {\cf2{}}{\cf14{false}}{\cf2{}}{\cf11{)}} {\cf2{String token}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    authService}}{\cf11{.}}{\cf2{}}{\cf16{validateAccessToken}}{\cf2{}}{\cf11{(}}{\cf2{token}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{friendService}}{\cf11{.}}{\cf2{}}{\cf16{getAllInterests}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @PostMapping\b0 }}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"/interests"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{Interest}} {\cf16{addInterest}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf15{\b @CookieValue\b0 }}{\cf2{}}{\cf11{(}}{\cf2{name}} {\cf11{=}} {\cf2{}}{\cf3{"token"}}{\cf2{}}{\cf11{,}} {\cf2{required}} {\cf11{=}} {\cf2{}}{\cf14{false}}{\cf2{}}{\cf11{)}} {\cf2{String token}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{}}                              {\cf15{\b @RequestBody\b0 }} {\cf2{String name}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    authService}}{\cf11{.}}{\cf2{}}{\cf16{validateAccessToken}}{\cf2{}}{\cf11{(}}{\cf2{token}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{friendService}}{\cf11{.}}{\cf2{}}{\cf16{addInterest}}{\cf2{}}{\cf11{(}}{\cf2{name}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @GetMapping\b0 }}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"/me/interests"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{List}}{\cf11{<}}{\cf2{Interest}}{\cf11{>}} {\cf2{}}{\cf16{getMyInterests}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf15{\b @CookieValue\b0 }}{\cf2{}}{\cf11{(}}{\cf2{name}} {\cf11{=}} {\cf2{}}{\cf3{"token"}}{\cf2{}}{\cf11{,}} {\cf2{required}} {\cf11{=}} {\cf2{}}{\cf14{false}}{\cf2{}}{\cf11{)}} {\cf2{String token}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    User u}} {\cf11{=}} {\cf2{}}{\cf16{getMe}}{\cf2{}}{\cf11{(}}{\cf2{token}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{Optional}}{\cf11{.}}{\cf2{}}{\cf16{ofNullable}}{\cf2{}}{\cf11{(}}{\cf2{u}}{\cf11{.}}{\cf2{}}{\cf16{getInterests}}{\cf2{}}{\cf11{()).}}{\cf2{}}{\cf16{orElse}}{\cf2{}}{\cf11{(}}{\cf2{List}}{\cf11{.}}{\cf2{}}{\cf16{of}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @PutMapping\b0 }}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"/me/interests"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{List}}{\cf11{<}}{\cf2{Interest}}{\cf11{>}} {\cf2{}}{\cf16{setMyInterests}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf15{\b @CookieValue\b0 }}{\cf2{}}{\cf11{(}}{\cf2{name}} {\cf11{=}} {\cf2{}}{\cf3{"token"}}{\cf2{}}{\cf11{,}} {\cf2{required}} {\cf11{=}} {\cf2{}}{\cf14{false}}{\cf2{}}{\cf11{)}} {\cf2{String token}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{}}                                       {\cf15{\b @RequestBody\b0 }} {\cf2{List}}{\cf11{<}}{\cf2{Interest}}{\cf11{>}} {\cf2{interests}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    User u}} {\cf11{=}} {\cf2{}}{\cf16{getMe}}{\cf2{}}{\cf11{(}}{\cf2{token}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{friendService}}{\cf11{.}}{\cf2{}}{\cf16{setUserInterests}}{\cf2{}}{\cf11{(}}{\cf2{u}}{\cf11{,}} {\cf2{interests}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @GetMapping\b0 }}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"/match"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{List}}{\cf11{<}}{\cf2{FriendView}}{\cf11{>}} {\cf2{}}{\cf16{getMatches}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf15{\b @CookieValue\b0 }}{\cf2{}}{\cf11{(}}{\cf2{name}} {\cf11{=}} {\cf2{}}{\cf3{"token"}}{\cf2{}}{\cf11{,}} {\cf2{required}} {\cf11{=}} {\cf2{}}{\cf14{false}}{\cf2{}}{\cf11{)}} {\cf2{String token}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    User u}} {\cf11{=}} {\cf2{}}{\cf16{getMe}}{\cf2{}}{\cf11{(}}{\cf2{token}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{friendService}}{\cf11{.}}{\cf2{}}{\cf16{matchAllUsers}}{\cf2{}}{\cf11{(}}{\cf2{u}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @PostMapping\b0 }}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"/logout"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{ResponseEntity}}{\cf11{<}}{\cf2{Void}}{\cf11{>}} {\cf2{}}{\cf16{logout}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf15{\b @CookieValue\b0 }}{\cf2{}}{\cf11{(}}{\cf2{name}} {\cf11{=}} {\cf2{}}{\cf3{"token"}}{\cf2{}}{\cf11{,}} {\cf2{required}} {\cf11{=}} {\cf2{}}{\cf14{false}}{\cf2{}}{\cf11{)}} {\cf2{String token}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{                                     HttpServletResponse res}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    authService}}{\cf11{.}}{\cf2{}}{\cf16{validateAccessToken}}{\cf2{}}{\cf11{(}}{\cf2{token}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    authService}}{\cf11{.}}{\cf2{}}{\cf16{logout}}{\cf2{}}{\cf11{(}}{\cf2{token}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // Delete token cookie\i0 }}}\par\pard
\cbpat1{{\cf2{    Cookie t}} {\cf11{=}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{}}{\cf16{Cookie}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"token"}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf3{""}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    t}}{\cf11{.}}{\cf2{}}{\cf16{setMaxAge}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf4{{0}}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    res}}{\cf11{.}}{\cf2{}}{\cf16{addCookie}}{\cf2{}}{\cf11{(}}{\cf2{t}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{ResponseEntity}}{\cf11{.}}{\cf2{}}{\cf16{ok}}{\cf2{}}{\cf11{().}}{\cf2{}}{\cf16{build}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/service/AuthService.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{service}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{model}}{\cf11{.*;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{repo}}{\cf11{.}}{\cf2{AuthRepository}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{repo}}{\cf11{.}}{\cf2{TokenRepository}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{repo}}{\cf11{.}}{\cf2{UserPreferencesRepository}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{repo}}{\cf11{.}}{\cf2{UserRepository}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{Error}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{apache}}{\cf11{.}}{\cf2{commons}}{\cf11{.}}{\cf2{codec}}{\cf11{.}}{\cf2{digest}}{\cf11{.}}{\cf2{DigestUtils}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{beans}}{\cf11{.}}{\cf2{factory}}{\cf11{.}}{\cf2{annotation}}{\cf11{.}}{\cf2{Autowired}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{http}}{\cf11{.}}{\cf2{HttpStatus}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{stereotype}}{\cf11{.}}{\cf2{Service}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{web}}{\cf11{.}}{\cf2{server}}{\cf11{.}}{\cf2{ResponseStatusException}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{security}}{\cf11{.}}{\cf2{SecureRandom}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{sql}}{\cf11{.}}{\cf2{Timestamp}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{time}}{\cf11{.}}{\cf2{LocalDateTime}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf15{\b @Service\b0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public class\b0 }} {\cf2{AuthService}} {\cf11{\{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{AuthRepository authRepo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{UserRepository userRepo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{UserPreferencesRepository prefsRepo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{TokenRepository tokenRepo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{Validator validator}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{SecureRandom random}}{\cf11{;}} {\cf2{}}{\cf5{\i // for salt generation purposes\i0 }}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private static final\b0 }} {\cf2{String SALT_CHARS}} {\cf11{=}} {\cf2{}}{\cf3{"{0}{1}{2}{3}{4}{5}{8}{9}"}}{\cf2{}} {\cf11{+}}}\par\pard
\cbpat1{{\cf2{}}      {\cf3{"abcdefghijklmnopqrstuvwxyz"}}{\cf2{}} {\cf11{+}}}\par\pard
\cbpat1{{\cf2{}}      {\cf3{"ABCDEFGHIJKLMNOPQRSTUVWXYZ"}}{\cf2{}} {\cf11{+}}}\par\pard
\cbpat1{{\cf2{}}      {\cf3{".!@#$%^&*()_+-=~`[]\{\}}}{\cf7{\\\\}}{\cf3{|/?<>'}}{\cf7{\\"}}{\cf3{;:"}}{\cf2{}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private static final int\b0 }} {\cf2{SCL}} {\cf11{=}} {\cf2{SALT_CHARS}}{\cf11{.}}{\cf2{}}{\cf16{length}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Autowired\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{}}{\cf16{AuthService}}{\cf2{}}{\cf11{(}}{\cf2{AuthRepository authRepo}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{                     UserRepository userRepo}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{                     UserPreferencesRepository prefsRepo}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{                     TokenRepository tokenRepo}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{                     Validator validator}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{authRepo}} {\cf11{=}} {\cf2{authRepo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{userRepo}} {\cf11{=}} {\cf2{userRepo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{prefsRepo}} {\cf11{=}} {\cf2{prefsRepo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{tokenRepo}} {\cf11{=}} {\cf2{tokenRepo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{validator}} {\cf11{=}} {\cf2{validator}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{random}} {\cf11{=}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{}}{\cf16{SecureRandom}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private void\b0 }} {\cf2{}}{\cf16{validateRegistration}}{\cf2{}}{\cf11{(}}{\cf2{UserRegistration reg}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    validator}}{\cf11{.}}{\cf2{}}{\cf16{validateUsername}}{\cf2{}}{\cf11{(}}{\cf2{reg}}{\cf11{.}}{\cf2{}}{\cf16{getUsername}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{    validator}}{\cf11{.}}{\cf2{}}{\cf16{validateName}}{\cf2{}}{\cf11{(}}{\cf2{reg}}{\cf11{.}}{\cf2{}}{\cf16{getFirstName}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{    validator}}{\cf11{.}}{\cf2{}}{\cf16{validateName}}{\cf2{}}{\cf11{(}}{\cf2{reg}}{\cf11{.}}{\cf2{}}{\cf16{getLastName}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{    validator}}{\cf11{.}}{\cf2{}}{\cf16{validateEmail}}{\cf2{}}{\cf11{(}}{\cf2{reg}}{\cf11{.}}{\cf2{}}{\cf16{getEmail}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{    validator}}{\cf11{.}}{\cf2{}}{\cf16{validatePhoneNumber}}{\cf2{}}{\cf11{(}}{\cf2{reg}}{\cf11{.}}{\cf2{}}{\cf16{getPhoneNum}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{String}} {\cf16{generateSalt}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{    StringBuilder sb}} {\cf11{=}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{}}{\cf16{StringBuilder}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b for\b0 }} {\cf2{}}{\cf11{(}}{\cf2{}}{\cf13{\b int\b0 }} {\cf2{i}} {\cf11{=}} {\cf2{}}{\cf4{{0}}}{\cf2{}}{\cf11{;}} {\cf2{i}} {\cf11{<}} {\cf2{}}{\cf4{{3}{2}}}{\cf2{}}{\cf11{;}} {\cf2{i}}{\cf11{++) \{}}}\par\pard
\cbpat1{{\cf2{      sb}}{\cf11{.}}{\cf2{}}{\cf16{append}}{\cf2{}}{\cf11{(}}{\cf2{SALT_CHARS}}{\cf11{.}}{\cf2{}}{\cf16{charAt}}{\cf2{}}{\cf11{(}}{\cf2{random}}{\cf11{.}}{\cf2{}}{\cf16{nextInt}}{\cf2{}}{\cf11{(}}{\cf2{SCL}}{\cf11{)));}}}\par\pard
\cbpat1{{\cf2{}}    {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{sb}}{\cf11{.}}{\cf2{}}{\cf16{toString}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{String}} {\cf16{hashPassword}}{\cf2{}}{\cf11{(}}{\cf2{String password}}{\cf11{,}} {\cf2{String salt}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    String raw}} {\cf11{=}} {\cf2{password}} {\cf11{+}} {\cf2{salt}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return new\b0 }} {\cf2{}}{\cf16{DigestUtils}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"SHA{3}-{2}{5}{6}"}}{\cf2{}}{\cf11{).}}{\cf2{}}{\cf16{digestAsHex}}{\cf2{}}{\cf11{(}}{\cf2{raw}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf5{\i // generate token with an expiry date of {2}{0}{9}{9}-{1}{2}-{3}{1}T{2}{3}:{5}{9}:{5}{9}\i0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{Token}} {\cf16{generateToken}}{\cf2{}}{\cf11{(}}{\cf2{User u}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    Token t}} {\cf11{=}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{}}{\cf16{Token}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{    t}}{\cf11{.}}{\cf2{}}{\cf16{setUser}}{\cf2{}}{\cf11{(}}{\cf2{u}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    t}}{\cf11{.}}{\cf2{}}{\cf16{setExpires}}{\cf2{}}{\cf11{(}}{\cf2{Timestamp}}{\cf11{.}}{\cf2{}}{\cf16{valueOf}}{\cf2{}}{\cf11{(}}{\cf2{LocalDateTime}}{\cf11{.}}{\cf2{}}{\cf16{of}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf4{{2}{0}{9}{9}}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf4{{1}{2}}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf4{{3}{1}}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf4{{2}{3}}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf4{{5}{9}}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf4{{5}{9}}}{\cf2{}}{\cf11{)));}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{tokenRepo}}{\cf11{.}}{\cf2{}}{\cf16{save}}{\cf2{}}{\cf11{(}}{\cf2{t}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{Token}} {\cf16{registerUser}}{\cf2{}}{\cf11{(}}{\cf2{UserRegistration reg}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // validate registration fields\i0 }}}\par\pard
\cbpat1{{\cf2{}}    {\cf16{validateRegistration}}{\cf2{}}{\cf11{(}}{\cf2{reg}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // create user with data fields and store in db\i0 }}}\par\pard
\cbpat1{{\cf2{    User u}} {\cf11{=}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{}}{\cf16{User}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{    u}}{\cf11{.}}{\cf2{}}{\cf16{setUsername}}{\cf2{}}{\cf11{(}}{\cf2{reg}}{\cf11{.}}{\cf2{}}{\cf16{getUsername}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{    u}}{\cf11{.}}{\cf2{}}{\cf16{setBirthdate}}{\cf2{}}{\cf11{(}}{\cf2{reg}}{\cf11{.}}{\cf2{}}{\cf16{getBirthdate}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{    u}}{\cf11{.}}{\cf2{}}{\cf16{setFirstName}}{\cf2{}}{\cf11{(}}{\cf2{reg}}{\cf11{.}}{\cf2{}}{\cf16{getFirstName}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{    u}}{\cf11{.}}{\cf2{}}{\cf16{setLastName}}{\cf2{}}{\cf11{(}}{\cf2{reg}}{\cf11{.}}{\cf2{}}{\cf16{getLastName}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{    u}}{\cf11{.}}{\cf2{}}{\cf16{setEmail}}{\cf2{}}{\cf11{(}}{\cf2{reg}}{\cf11{.}}{\cf2{}}{\cf16{getEmail}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{    u}}{\cf11{.}}{\cf2{}}{\cf16{setPhoneNum}}{\cf2{}}{\cf11{(}}{\cf2{reg}}{\cf11{.}}{\cf2{}}{\cf16{getPhoneNum}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // TODO validation\i0 }}}\par\pard
\cbpat1{{\cf2{    u}}{\cf11{.}}{\cf2{}}{\cf16{setGender}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{'X'}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    u}}{\cf11{.}}{\cf2{}}{\cf16{setGrade}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf4{{0}}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{    u}} {\cf11{=}} {\cf2{userRepo}}{\cf11{.}}{\cf2{}}{\cf16{save}}{\cf2{}}{\cf11{(}}{\cf2{u}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // create auth entry\i0 }}}\par\pard
\cbpat1{{\cf2{    Auth a}} {\cf11{=}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{}}{\cf16{Auth}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{    a}}{\cf11{.}}{\cf2{}}{\cf16{setUser}}{\cf2{}}{\cf11{(}}{\cf2{u}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{    String salt}} {\cf11{=}} {\cf2{}}{\cf16{generateSalt}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{    a}}{\cf11{.}}{\cf2{}}{\cf16{setSalt}}{\cf2{}}{\cf11{(}}{\cf2{salt}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    a}}{\cf11{.}}{\cf2{}}{\cf16{setPassword}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf16{hashPassword}}{\cf2{}}{\cf11{(}}{\cf2{reg}}{\cf11{.}}{\cf2{}}{\cf16{getPassword}}{\cf2{}}{\cf11{(),}} {\cf2{salt}}{\cf11{));}}}\par\pard
\cbpat1{{\cf2{    a}}{\cf11{.}}{\cf2{}}{\cf16{setPasswordExpires}}{\cf2{}}{\cf11{(}}{\cf2{Timestamp}}{\cf11{.}}{\cf2{}}{\cf16{valueOf}}{\cf2{}}{\cf11{(}}{\cf2{LocalDateTime}}{\cf11{.}}{\cf2{}}{\cf16{now}}{\cf2{}}{\cf11{().}}{\cf2{}}{\cf16{plusDays}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf4{{9}{0}}}{\cf2{}}{\cf11{)));}}}\par\pard
\cbpat1{{\cf2{    a}} {\cf11{=}} {\cf2{authRepo}}{\cf11{.}}{\cf2{}}{\cf16{save}}{\cf2{}}{\cf11{(}}{\cf2{a}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{    UserPreferences up}} {\cf11{=}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{}}{\cf16{UserPreferences}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{    up}}{\cf11{.}}{\cf2{}}{\cf16{setUser}}{\cf2{}}{\cf11{(}}{\cf2{u}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    up}} {\cf11{=}} {\cf2{prefsRepo}}{\cf11{.}}{\cf2{}}{\cf16{save}}{\cf2{}}{\cf11{(}}{\cf2{up}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // create token\i0 }}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{}}{\cf16{generateToken}}{\cf2{}}{\cf11{(}}{\cf2{u}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{Token}} {\cf16{login}}{\cf2{}}{\cf11{(}}{\cf2{String username}}{\cf11{,}} {\cf2{String password}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    User u}} {\cf11{=}} {\cf2{userRepo}}{\cf11{.}}{\cf2{}}{\cf16{findByUsername}}{\cf2{}}{\cf11{(}}{\cf2{username}}{\cf11{).}}{\cf2{}}{\cf16{orElseThrow}}{\cf2{}}{\cf11{(}}{\cf2{Error}}{\cf11{.}}{\cf2{INVALID_LOGIN}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    Auth a}} {\cf11{=}} {\cf2{u}}{\cf11{.}}{\cf2{}}{\cf16{getAuth}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // verify password\i0 }}}\par\pard
\cbpat1{{\cf2{    String hash}} {\cf11{=}} {\cf2{}}{\cf16{hashPassword}}{\cf2{}}{\cf11{(}}{\cf2{password}}{\cf11{,}} {\cf2{a}}{\cf11{.}}{\cf2{}}{\cf16{getSalt}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(!}}{\cf2{a}}{\cf11{.}}{\cf2{}}{\cf16{getPassword}}{\cf2{}}{\cf11{().}}{\cf2{}}{\cf16{equals}}{\cf2{}}{\cf11{(}}{\cf2{hash}}{\cf11{))}} {\cf2{}}{\cf13{\b throw\b0 }} {\cf2{Error}}{\cf11{.}}{\cf2{INVALID_LOGIN}}{\cf11{.}}{\cf2{}}{\cf16{get}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{a}}{\cf11{.}}{\cf2{}}{\cf16{getPasswordExpires}}{\cf2{}}{\cf11{().}}{\cf2{}}{\cf16{toLocalDateTime}}{\cf2{}}{\cf11{().}}{\cf2{}}{\cf16{isBefore}}{\cf2{}}{\cf11{(}}{\cf2{LocalDateTime}}{\cf11{.}}{\cf2{}}{\cf16{now}}{\cf2{}}{\cf11{()))}}}\par\pard
\cbpat1{{\cf2{}}      {\cf13{\b throw new\b0 }} {\cf2{}}{\cf16{ResponseStatusException}}{\cf2{}}{\cf11{(}}{\cf2{HttpStatus}}{\cf11{.}}{\cf2{UNAUTHORIZED}}{\cf11{,}} {\cf2{}}{\cf3{"Reset your password."}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // create token\i0 }}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{}}{\cf16{generateToken}}{\cf2{}}{\cf11{(}}{\cf2{u}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{User}} {\cf16{validateAccessToken}}{\cf2{}}{\cf11{(}}{\cf2{String token}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{token}} {\cf11{==}} {\cf2{}}{\cf14{null}}{\cf2{}}{\cf11{)}} {\cf2{}}{\cf13{\b throw\b0 }} {\cf2{Error}}{\cf11{.}}{\cf2{UNAUTHORIZED}}{\cf11{.}}{\cf2{}}{\cf16{get}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{    Token t}} {\cf11{=}} {\cf2{tokenRepo}}{\cf11{.}}{\cf2{}}{\cf16{findById}}{\cf2{}}{\cf11{(}}{\cf2{token}}{\cf11{).}}{\cf2{}}{\cf16{orElseThrow}}{\cf2{}}{\cf11{(}}{\cf2{Error}}{\cf11{.}}{\cf2{UNAUTHORIZED}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{t}}{\cf11{.}}{\cf2{}}{\cf16{getExpires}}{\cf2{}}{\cf11{().}}{\cf2{}}{\cf16{toLocalDateTime}}{\cf2{}}{\cf11{().}}{\cf2{}}{\cf16{isBefore}}{\cf2{}}{\cf11{(}}{\cf2{LocalDateTime}}{\cf11{.}}{\cf2{}}{\cf16{now}}{\cf2{}}{\cf11{()))}}}\par\pard
\cbpat1{{\cf2{}}      {\cf13{\b throw new\b0 }} {\cf2{}}{\cf16{ResponseStatusException}}{\cf2{}}{\cf11{(}}{\cf2{HttpStatus}}{\cf11{.}}{\cf2{UNAUTHORIZED}}{\cf11{,}} {\cf2{}}{\cf3{"Your token expired, please log in again."}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{t}}{\cf11{.}}{\cf2{}}{\cf16{getUser}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{Token}} {\cf16{resetPassword}}{\cf2{}}{\cf11{(}}{\cf2{String username}}{\cf11{,}} {\cf2{String oldPass}}{\cf11{,}} {\cf2{String newPass}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    User u}} {\cf11{=}} {\cf2{userRepo}}{\cf11{.}}{\cf2{}}{\cf16{findByUsername}}{\cf2{}}{\cf11{(}}{\cf2{username}}{\cf11{).}}{\cf2{}}{\cf16{orElseThrow}}{\cf2{}}{\cf11{(}}{\cf2{Error}}{\cf11{.}}{\cf2{UNAUTHORIZED}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    Auth a}} {\cf11{=}} {\cf2{u}}{\cf11{.}}{\cf2{}}{\cf16{getAuth}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{    String hash}} {\cf11{=}} {\cf2{}}{\cf16{hashPassword}}{\cf2{}}{\cf11{(}}{\cf2{oldPass}}{\cf11{,}} {\cf2{a}}{\cf11{.}}{\cf2{}}{\cf16{getSalt}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(!}}{\cf2{a}}{\cf11{.}}{\cf2{}}{\cf16{getPassword}}{\cf2{}}{\cf11{().}}{\cf2{}}{\cf16{equals}}{\cf2{}}{\cf11{(}}{\cf2{hash}}{\cf11{))}} {\cf2{}}{\cf13{\b throw\b0 }} {\cf2{Error}}{\cf11{.}}{\cf2{BAD_REQUEST}}{\cf11{.}}{\cf2{}}{\cf16{get}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{    validator}}{\cf11{.}}{\cf2{}}{\cf16{validatePassword}}{\cf2{}}{\cf11{(}}{\cf2{newPass}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{    String salt}} {\cf11{=}} {\cf2{}}{\cf16{generateSalt}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{    a}}{\cf11{.}}{\cf2{}}{\cf16{setSalt}}{\cf2{}}{\cf11{(}}{\cf2{salt}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    a}}{\cf11{.}}{\cf2{}}{\cf16{setPassword}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf16{hashPassword}}{\cf2{}}{\cf11{(}}{\cf2{newPass}}{\cf11{,}} {\cf2{salt}}{\cf11{));}}}\par\pard
\cbpat1{{\cf2{    a}}{\cf11{.}}{\cf2{}}{\cf16{setPasswordExpires}}{\cf2{}}{\cf11{(}}{\cf2{Timestamp}}{\cf11{.}}{\cf2{}}{\cf16{valueOf}}{\cf2{}}{\cf11{(}}{\cf2{LocalDateTime}}{\cf11{.}}{\cf2{}}{\cf16{now}}{\cf2{}}{\cf11{().}}{\cf2{}}{\cf16{plusDays}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf4{{9}{0}}}{\cf2{}}{\cf11{)));}}}\par\pard
\cbpat1{{\cf2{    a}} {\cf11{=}} {\cf2{authRepo}}{\cf11{.}}{\cf2{}}{\cf16{save}}{\cf2{}}{\cf11{(}}{\cf2{a}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // erase all old tokens\i0 }}}\par\pard
\cbpat1{{\cf2{    tokenRepo}}{\cf11{.}}{\cf2{}}{\cf16{deleteAll}}{\cf2{}}{\cf11{(}}{\cf2{tokenRepo}}{\cf11{.}}{\cf2{}}{\cf16{findAllByUser}}{\cf2{}}{\cf11{(}}{\cf2{u}}{\cf11{));}} {\cf2{}}{\cf5{\i // assumes at least one token in db, else wouldn't reach here\i0 }}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // create new token\i0 }}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{}}{\cf16{generateToken}}{\cf2{}}{\cf11{(}}{\cf2{u}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{logout}}{\cf2{}}{\cf11{(}}{\cf2{String token}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    tokenRepo}}{\cf11{.}}{\cf2{}}{\cf16{deleteById}}{\cf2{}}{\cf11{(}}{\cf2{token}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/service/FriendService.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{service}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{com}}{\cf11{.}}{\cf2{google}}{\cf11{.}}{\cf2{common}}{\cf11{.}}{\cf2{collect}}{\cf11{.}}{\cf2{Lists}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{com}}{\cf11{.}}{\cf2{google}}{\cf11{.}}{\cf2{common}}{\cf11{.}}{\cf2{primitives}}{\cf11{.}}{\cf2{Doubles}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{model}}{\cf11{.*;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{repo}}{\cf11{.}}{\cf2{FriendshipRepository}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{repo}}{\cf11{.}}{\cf2{InterestRepository}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{repo}}{\cf11{.}}{\cf2{UserPreferencesRepository}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{repo}}{\cf11{.}}{\cf2{UserRepository}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{beans}}{\cf11{.}}{\cf2{factory}}{\cf11{.}}{\cf2{annotation}}{\cf11{.}}{\cf2{Autowired}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{stereotype}}{\cf11{.}}{\cf2{Service}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{util}}{\cf11{.*;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf6{\i /**\i0 }}}\par\pard
\cbpat1{{\cf6{\i  * A service handling functionality related to friends and user interests.\i0 }}}\par\pard
\cbpat1{{\cf6{\i  */\i0 }}{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf15{\b @Service\b0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public class\b0 }} {\cf2{FriendService}} {\cf11{\{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{UserRepository userRepo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{InterestRepository interestRepo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{FriendshipRepository friendRepo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{UserPreferencesRepository userPrefsRepo}}{\cf11{;}} {\cf2{}}{\cf5{\i // TODO take prefs into account\i0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{UserService userService}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf6{\i /** An approximate value for the earth's radius, in km */\i0 }}{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private static final double\b0 }} {\cf2{R_E}} {\cf11{=}} {\cf2{}}{\cf4{{6}.{3}{7}{8}{1}}}{\cf2{E{3}}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Autowired\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{}}{\cf16{FriendService}}{\cf2{}}{\cf11{(}}{\cf2{UserRepository userRepo}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{                       InterestRepository interestRepo}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{                       FriendshipRepository friendRepo}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{                       UserPreferencesRepository userPrefsRepo}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{                       UserService userService}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{userRepo}} {\cf11{=}} {\cf2{userRepo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{interestRepo}} {\cf11{=}} {\cf2{interestRepo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{friendRepo}} {\cf11{=}} {\cf2{friendRepo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{userPrefsRepo}} {\cf11{=}} {\cf2{userPrefsRepo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{userService}} {\cf11{=}} {\cf2{userService}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{List}}{\cf11{<}}{\cf2{Interest}}{\cf11{>}} {\cf2{}}{\cf16{getAllInterests}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{    List}}{\cf11{<}}{\cf2{Interest}}{\cf11{>}} {\cf2{all}} {\cf11{=}} {\cf2{Lists}}{\cf11{.}}{\cf2{}}{\cf16{newArrayList}}{\cf2{}}{\cf11{(}}{\cf2{interestRepo}}{\cf11{.}}{\cf2{}}{\cf16{findAll}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{    Collections}}{\cf11{.}}{\cf2{}}{\cf16{sort}}{\cf2{}}{\cf11{(}}{\cf2{all}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{all}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{Interest}} {\cf16{addInterest}}{\cf2{}}{\cf11{(}}{\cf2{String name}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    Interest i}} {\cf11{=}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{}}{\cf16{Interest}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{    i}}{\cf11{.}}{\cf2{}}{\cf16{setName}}{\cf2{}}{\cf11{(}}{\cf2{name}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{interestRepo}}{\cf11{.}}{\cf2{}}{\cf16{save}}{\cf2{}}{\cf11{(}}{\cf2{i}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{List}}{\cf11{<}}{\cf2{Interest}}{\cf11{>}} {\cf2{}}{\cf16{setUserInterests}}{\cf2{}}{\cf11{(}}{\cf2{User user}}{\cf11{,}} {\cf2{List}}{\cf11{<}}{\cf2{Interest}}{\cf11{>}} {\cf2{interests}}{\cf11{,}} {\cf2{List}}{\cf11{<}}{\cf2{String}}{\cf11{>}} {\cf2{newInterests}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // register new interests and merge lists\i0 }}}\par\pard
\cbpat1{{\cf2{    List}}{\cf11{<}}{\cf2{Interest}}{\cf11{>}} {\cf2{added}} {\cf11{=}} {\cf2{newInterests}} {\cf11{!=}} {\cf2{}}{\cf14{null}} {\cf2{? newInterests}}{\cf11{.}}{\cf2{}}{\cf16{stream}}{\cf2{}}{\cf11{().}}{\cf2{}}{\cf16{map}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf13{\b this\b0 }}{\cf2{}}{\cf11{::}}{\cf2{addInterest}}{\cf11{).}}{\cf2{}}{\cf16{toList}}{\cf2{}}{\cf11{() :}} {\cf2{List}}{\cf11{.}}{\cf2{}}{\cf16{of}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{    interests}}{\cf11{.}}{\cf2{}}{\cf16{addAll}}{\cf2{}}{\cf11{(}}{\cf2{added}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{    user}}{\cf11{.}}{\cf2{}}{\cf16{setInterests}}{\cf2{}}{\cf11{(}}{\cf2{interests}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    user}} {\cf11{=}} {\cf2{userRepo}}{\cf11{.}}{\cf2{}}{\cf16{save}}{\cf2{}}{\cf11{(}}{\cf2{user}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{user}}{\cf11{.}}{\cf2{}}{\cf16{getInterests}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{List}}{\cf11{<}}{\cf2{Interest}}{\cf11{>}} {\cf2{}}{\cf16{setUserInterests}}{\cf2{}}{\cf11{(}}{\cf2{User user}}{\cf11{,}} {\cf2{List}}{\cf11{<}}{\cf2{Interest}}{\cf11{>}} {\cf2{interests}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{}}{\cf16{setUserInterests}}{\cf2{}}{\cf11{(}}{\cf2{user}}{\cf11{,}} {\cf2{interests}}{\cf11{,}} {\cf2{}}{\cf14{null}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf6{\i /** Returns the constant c\'f2 for normal curve calculations, based on the requested value at a specific point x. */\i0 }}{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private double\b0 }} {\cf2{}}{\cf16{c}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf13{\b double\b0 }} {\cf2{x}}{\cf11{,}} {\cf2{}}{\cf13{\b double\b0 }} {\cf2{f}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{}}{\cf11{- (}}{\cf2{x}} {\cf11{*}} {\cf2{x}}{\cf11{) /}} {\cf2{Math}}{\cf11{.}}{\cf2{}}{\cf16{log}}{\cf2{}}{\cf11{(}}{\cf2{f}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf5{\i // f({2}) = {0}.{5}\i0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private double\b0 }} {\cf2{}}{\cf16{ageCurve}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf13{\b double\b0 }} {\cf2{x}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{Math}}{\cf11{.}}{\cf2{}}{\cf16{exp}}{\cf2{}}{\cf11{(-(}}{\cf2{x}} {\cf11{*}} {\cf2{x}}{\cf11{) /}} {\cf2{}}{\cf16{c}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf4{{2}}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf4{{0}.{5}}}{\cf2{}}{\cf11{));}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private double\b0 }} {\cf2{}}{\cf16{hav}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf13{\b double\b0 }} {\cf2{deg}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{}}{\cf11{(}}{\cf2{}}{\cf4{{1}}} {\cf2{}}{\cf11{-}} {\cf2{Math}}{\cf11{.}}{\cf2{}}{\cf16{cos}}{\cf2{}}{\cf11{(}}{\cf2{Math}}{\cf11{.}}{\cf2{}}{\cf16{toRadians}}{\cf2{}}{\cf11{(}}{\cf2{deg}}{\cf11{))) /}} {\cf2{}}{\cf4{{2}}}{\cf2{}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf6{\i /**\i0 }}}\par\pard
\cbpat1{{\cf6{\i    * Parameters in degrees\i0 }}}\par\pard
\cbpat1{{\cf6{\i    */\i0 }}{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private double\b0 }} {\cf2{}}{\cf16{d}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf13{\b double\b0 }} {\cf2{la{1}}}{\cf11{,}} {\cf2{}}{\cf13{\b double\b0 }} {\cf2{lo{1}}}{\cf11{,}} {\cf2{}}{\cf13{\b double\b0 }} {\cf2{la{2}}}{\cf11{,}} {\cf2{}}{\cf13{\b double\b0 }} {\cf2{lo{2}}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{}}{\cf4{{2}}} {\cf2{}}{\cf11{*}} {\cf2{R_E}} {\cf11{*}} {\cf2{Math}}{\cf11{.}}{\cf2{}}{\cf16{asin}}{\cf2{}}{\cf11{(}}}\par\pard
\cbpat1{{\cf2{        Math}}{\cf11{.}}{\cf2{}}{\cf16{sqrt}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf16{hav}}{\cf2{}}{\cf11{(}}{\cf2{la{2}}} {\cf11{-}} {\cf2{la{1}}}{\cf11{) + (}}{\cf2{}}{\cf4{{1}}} {\cf2{}}{\cf11{-}} {\cf2{}}{\cf16{hav}}{\cf2{}}{\cf11{(}}{\cf2{la{1}}} {\cf11{-}} {\cf2{la{2}}}{\cf11{) -}} {\cf2{}}{\cf16{hav}}{\cf2{}}{\cf11{(}}{\cf2{la{1}}} {\cf11{+}} {\cf2{la{2}}}{\cf11{)) *}} {\cf2{}}{\cf16{hav}}{\cf2{}}{\cf11{(}}{\cf2{lo{2}}} {\cf11{-}} {\cf2{lo{1}}}{\cf11{))}}}\par\pard
\cbpat1{{\cf2{}}    {\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf5{\i // f({1}{2}) = {0}.{5}\i0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private double\b0 }} {\cf2{}}{\cf16{distanceCurve}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf13{\b double\b0 }} {\cf2{la{1}}}{\cf11{,}} {\cf2{}}{\cf13{\b double\b0 }} {\cf2{lo{1}}}{\cf11{,}} {\cf2{}}{\cf13{\b double\b0 }} {\cf2{la{2}}}{\cf11{,}} {\cf2{}}{\cf13{\b double\b0 }} {\cf2{lo{2}}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{Math}}{\cf11{.}}{\cf2{}}{\cf16{exp}}{\cf2{}}{\cf11{(-}}{\cf2{Math}}{\cf11{.}}{\cf2{}}{\cf16{pow}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf16{d}}{\cf2{}}{\cf11{(}}{\cf2{la{1}}}{\cf11{,}} {\cf2{lo{1}}}{\cf11{,}} {\cf2{la{2}}}{\cf11{,}} {\cf2{lo{2}}}{\cf11{),}} {\cf2{}}{\cf4{{2}}}{\cf2{}}{\cf11{) /}} {\cf2{}}{\cf16{c}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf4{{1}{2}}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf4{{0}.{5}}}{\cf2{}}{\cf11{));}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf5{\i // Logistic curve\i0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf5{\i // Why {1}{0} and {0}.{4}{6}? Approx: f({0})={0}, f({1})={1}\i0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private double\b0 }} {\cf2{}}{\cf16{interestCurve}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf13{\b double\b0 }} {\cf2{x}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{x}} {\cf11{==}} {\cf2{}}{\cf4{{1}}}{\cf2{}}{\cf11{)}} {\cf2{}}{\cf13{\b return\b0 }} {\cf2{x}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{}}{\cf4{{1}}} {\cf2{}}{\cf11{/ (}}{\cf2{}}{\cf4{{1}}} {\cf2{}}{\cf11{+}} {\cf2{Math}}{\cf11{.}}{\cf2{}}{\cf16{exp}}{\cf2{}}{\cf11{(-}}{\cf2{}}{\cf4{{1}{0}}} {\cf2{}}{\cf11{* (}}{\cf2{x}} {\cf11{-}} {\cf2{}}{\cf4{{0}.{4}{6}}}{\cf2{}}{\cf11{)));}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf6{\i /**\i0 }}}\par\pard
\cbpat1{{\cf6{\i    * Calculate the match score between two users.\i0 }}}\par\pard
\cbpat1{{\cf6{\i    *\i0 }}}\par\pard
\cbpat1{{\cf6{\i    * <p>The algorithm takes the following factors into account:\i0 }}}\par\pard
\cbpat1{{\cf6{\i    * <ul>\i0 }}}\par\pard
\cbpat1{{\cf6{\i    *   <li>The age (grade) difference ({2}{0}%) - calculated using a normal curve.</li>\i0 }}}\par\pard
\cbpat1{{\cf6{\i    *   <li>The proximity between user's homes ({1}{5}%) - calculated using a normal curve.</li>\i0 }}}\par\pard
\cbpat1{{\cf6{\i    *   <li>Same school bonus ({5}%) - binary.</li>\i0 }}}\par\pard
\cbpat1{{\cf6{\i    *   <li>The interest match between the users ({6}{0}%) - calculated using the ratio between the shared interests\i0 }}}\par\pard
\cbpat1{{\cf6{\i    *   and the interest union group, and normalized using a logistic curve.</li>\i0 }}}\par\pard
\cbpat1{{\cf6{\i    * </ul>\i0 }}}\par\pard
\cbpat1{{\cf6{\i    * @param a The first user\i0 }}}\par\pard
\cbpat1{{\cf6{\i    * @param b The second user\i0 }}}\par\pard
\cbpat1{{\cf6{\i    * @return A double value between {0}.{0} and {1}.{0} (inclusive), where {1} is a perfect match and {0} is no match.\i0 }}}\par\pard
\cbpat1{{\cf6{\i    */\i0 }}{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public double\b0 }} {\cf2{}}{\cf16{match}}{\cf2{}}{\cf11{(}}{\cf2{User a}}{\cf11{,}} {\cf2{User b}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // Calculate grade score element\i0 }}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b final double\b0 }} {\cf2{gradeWeight}} {\cf11{=}} {\cf2{}}{\cf4{{0}.{2}}}{\cf2{}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b int\b0 }} {\cf2{ageDiff}} {\cf11{=}} {\cf2{Math}}{\cf11{.}}{\cf2{}}{\cf16{abs}}{\cf2{}}{\cf11{(}}{\cf2{a}}{\cf11{.}}{\cf2{}}{\cf16{getGrade}}{\cf2{}}{\cf11{() -}} {\cf2{b}}{\cf11{.}}{\cf2{}}{\cf16{getGrade}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b double\b0 }} {\cf2{gradeScoreElement}} {\cf11{=}} {\cf2{gradeWeight}} {\cf11{*}} {\cf2{}}{\cf16{ageCurve}}{\cf2{}}{\cf11{(}}{\cf2{ageDiff}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // Calculate location (address) score element\i0 }}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b final double\b0 }} {\cf2{locationWeight}} {\cf11{=}} {\cf2{}}{\cf4{{0}.{1}{5}}}{\cf2{}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{    Location la}} {\cf11{=}} {\cf2{a}}{\cf11{.}}{\cf2{}}{\cf16{getLocation}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{    Location lb}} {\cf11{=}} {\cf2{b}}{\cf11{.}}{\cf2{}}{\cf16{getLocation}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b double\b0 }} {\cf2{locationScoreElement}} {\cf11{=}} {\cf2{locationWeight}} {\cf11{*}} {\cf2{}}{\cf16{distanceCurve}}{\cf2{}}{\cf11{(}}{\cf2{la}}{\cf11{.}}{\cf2{}}{\cf16{lat}}{\cf2{}}{\cf11{(),}} {\cf2{la}}{\cf11{.}}{\cf2{}}{\cf16{lon}}{\cf2{}}{\cf11{(),}} {\cf2{lb}}{\cf11{.}}{\cf2{}}{\cf16{lat}}{\cf2{}}{\cf11{(),}} {\cf2{lb}}{\cf11{.}}{\cf2{}}{\cf16{lon}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // Calculate school affiliation score element\i0 }}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b final double\b0 }} {\cf2{schoolWeight}} {\cf11{=}} {\cf2{}}{\cf4{{0}.{0}{5}}}{\cf2{}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b int\b0 }} {\cf2{isSameSchool}} {\cf11{= (}}{\cf2{a}}{\cf11{.}}{\cf2{}}{\cf16{getSchool}}{\cf2{}}{\cf11{().}}{\cf2{}}{\cf16{getId}}{\cf2{}}{\cf11{() ==}} {\cf2{b}}{\cf11{.}}{\cf2{}}{\cf16{getSchool}}{\cf2{}}{\cf11{().}}{\cf2{}}{\cf16{getId}}{\cf2{}}{\cf11{())}} {\cf2{?}} {\cf4{{1}}} {\cf2{}}{\cf11{:}} {\cf2{}}{\cf4{{0}}}{\cf2{}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b double\b0 }} {\cf2{schoolScoreElement}} {\cf11{=}} {\cf2{schoolWeight}} {\cf11{*}} {\cf2{isSameSchool}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // Calculate interest score element\i0 }}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b final double\b0 }} {\cf2{interestWeight}} {\cf11{=}} {\cf2{}}{\cf4{{0}.{6}}}{\cf2{}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // Count unique interests\i0 }}}\par\pard
\cbpat1{{\cf2{    Set}}{\cf11{<}}{\cf2{Interest}}{\cf11{>}} {\cf2{allInterests}} {\cf11{=}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{HashSet}}{\cf11{<>();}}}\par\pard
\cbpat1{{\cf2{    allInterests}}{\cf11{.}}{\cf2{}}{\cf16{addAll}}{\cf2{}}{\cf11{(}}{\cf2{a}}{\cf11{.}}{\cf2{}}{\cf16{getInterests}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{    allInterests}}{\cf11{.}}{\cf2{}}{\cf16{addAll}}{\cf2{}}{\cf11{(}}{\cf2{b}}{\cf11{.}}{\cf2{}}{\cf16{getInterests}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b double\b0 }} {\cf2{total}} {\cf11{=}} {\cf2{allInterests}}{\cf11{.}}{\cf2{}}{\cf16{size}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // Count common interests\i0 }}}\par\pard
\cbpat1{{\cf2{    List}}{\cf11{<}}{\cf2{Interest}}{\cf11{>}} {\cf2{intersect}} {\cf11{=}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{ArrayList}}{\cf11{<>(}}{\cf2{a}}{\cf11{.}}{\cf2{}}{\cf16{getInterests}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{    intersect}}{\cf11{.}}{\cf2{}}{\cf16{retainAll}}{\cf2{}}{\cf11{(}}{\cf2{b}}{\cf11{.}}{\cf2{}}{\cf16{getInterests}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b double\b0 }} {\cf2{common}} {\cf11{=}} {\cf2{intersect}}{\cf11{.}}{\cf2{}}{\cf16{size}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // Calculate score\i0 }}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b double\b0 }} {\cf2{commonInterests}} {\cf11{=}} {\cf2{total}} {\cf11{>}} {\cf2{}}{\cf4{{0}}} {\cf2{? common}} {\cf11{/}} {\cf2{total}} {\cf11{:}} {\cf2{}}{\cf4{{0}}}{\cf2{}}{\cf11{;}} {\cf2{}}{\cf5{\i // if no interests at all (should never happen in prod)\i0 }}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b double\b0 }} {\cf2{interestScoreElement}} {\cf11{=}} {\cf2{interestWeight}} {\cf11{*}} {\cf2{}}{\cf16{interestCurve}}{\cf2{}}{\cf11{(}}{\cf2{commonInterests}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{gradeScoreElement}} {\cf11{+}} {\cf2{locationScoreElement}} {\cf11{+}} {\cf2{schoolScoreElement}} {\cf11{+}} {\cf2{interestScoreElement}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private\b0 }} {\cf2{FriendView}} {\cf16{userToFriendView}}{\cf2{}}{\cf11{(}}{\cf2{User friend}}{\cf11{,}} {\cf2{User requester}}{\cf11{,}} {\cf2{}}{\cf13{\b double\b0 }} {\cf2{score}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    var status}} {\cf11{=}} {\cf2{friendRepo}}}\par\pard
\cbpat1{{\cf2{}}        {\cf11{.}}{\cf2{}}{\cf16{findByTwoUsers}}{\cf2{}}{\cf11{(}}{\cf2{friend}}{\cf11{,}} {\cf2{requester}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}        {\cf11{.}}{\cf2{}}{\cf16{map}}{\cf2{}}{\cf11{(}}{\cf2{Friendship}}{\cf11{::}}{\cf2{getStatus}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}        {\cf11{.}}{\cf2{}}{\cf16{orElse}}{\cf2{}}{\cf11{(}}{\cf2{Friendship}}{\cf11{.}}{\cf2{Status}}{\cf11{.}}{\cf2{STRANGER}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b boolean\b0 }} {\cf2{initiator}} {\cf11{=}} {\cf2{friendRepo}}{\cf11{.}}{\cf2{}}{\cf16{findByTwoUsers}}{\cf2{}}{\cf11{(}}{\cf2{friend}}{\cf11{,}} {\cf2{requester}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}        {\cf11{.}}{\cf2{}}{\cf16{map}}{\cf2{}}{\cf11{(}}{\cf2{f}} {\cf11{->}} {\cf2{f}}{\cf11{.}}{\cf2{}}{\cf16{getInvitor}}{\cf2{}}{\cf11{().}}{\cf2{}}{\cf16{equals}}{\cf2{}}{\cf11{(}}{\cf2{friend}}{\cf11{)).}}{\cf2{}}{\cf16{orElse}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf14{false}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}        }\par\pard
\cbpat1{{\cf2{    Location fLoc}} {\cf11{=}} {\cf2{friend}}{\cf11{.}}{\cf2{}}{\cf16{getLocation}}{\cf2{}}{\cf11{(),}} {\cf2{rLoc}} {\cf11{=}} {\cf2{requester}}{\cf11{.}}{\cf2{}}{\cf16{getLocation}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b double\b0 }} {\cf2{distance}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{fLoc}} {\cf11{==}} {\cf2{}}{\cf14{null}} {\cf2{}}{\cf11{||}} {\cf2{rLoc}} {\cf11{==}} {\cf2{}}{\cf14{null}}{\cf2{}}{\cf11{)}} {\cf2{distance}} {\cf11{= -}}{\cf2{}}{\cf4{{1}}}{\cf2{}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b else\b0 }} {\cf2{distance}} {\cf11{=}} {\cf2{}}{\cf16{d}}{\cf2{}}{\cf11{(}}{\cf2{fLoc}}{\cf11{.}}{\cf2{}}{\cf16{lat}}{\cf2{}}{\cf11{(),}} {\cf2{fLoc}}{\cf11{.}}{\cf2{}}{\cf16{lon}}{\cf2{}}{\cf11{(),}} {\cf2{rLoc}}{\cf11{.}}{\cf2{}}{\cf16{lat}}{\cf2{}}{\cf11{(),}} {\cf2{rLoc}}{\cf11{.}}{\cf2{}}{\cf16{lon}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return new\b0 }} {\cf2{}}{\cf16{FriendView}}{\cf2{}}{\cf11{(}}}\par\pard
\cbpat1{{\cf2{        friend}}{\cf11{.}}{\cf2{}}{\cf16{getId}}{\cf2{}}{\cf11{(),}}}\par\pard
\cbpat1{{\cf2{        friend}}{\cf11{.}}{\cf2{}}{\cf16{getUsername}}{\cf2{}}{\cf11{(),}}}\par\pard
\cbpat1{{\cf2{        friend}}{\cf11{.}}{\cf2{}}{\cf16{getFirstName}}{\cf2{}}{\cf11{(),}}}\par\pard
\cbpat1{{\cf2{        friend}}{\cf11{.}}{\cf2{}}{\cf16{getLastName}}{\cf2{}}{\cf11{(),}}}\par\pard
\cbpat1{{\cf2{        status}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{        initiator}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{        friend}}{\cf11{.}}{\cf2{}}{\cf16{getBio}}{\cf2{}}{\cf11{(),}}}\par\pard
\cbpat1{{\cf2{        friend}}{\cf11{.}}{\cf2{}}{\cf16{getSchool}}{\cf2{}}{\cf11{(),}}}\par\pard
\cbpat1{{\cf2{        friend}}{\cf11{.}}{\cf2{}}{\cf16{getInterests}}{\cf2{}}{\cf11{(),}}}\par\pard
\cbpat1{{\cf2{        friend}}{\cf11{.}}{\cf2{}}{\cf16{getHometown}}{\cf2{}}{\cf11{(),}}}\par\pard
\cbpat1{{\cf2{        distance}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{        friend}}{\cf11{.}}{\cf2{}}{\cf16{getGrade}}{\cf2{}}{\cf11{(),}}}\par\pard
\cbpat1{{\cf2{        friend}}{\cf11{.}}{\cf2{}}{\cf16{getGender}}{\cf2{}}{\cf11{(),}}}\par\pard
\cbpat1{{\cf2{        score}}}\par\pard
\cbpat1{{\cf2{}}    {\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{FriendView}} {\cf16{getFriendView}}{\cf2{}}{\cf11{(}}{\cf2{User user}}{\cf11{,}} {\cf2{String friend}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    User fUser}} {\cf11{=}} {\cf2{userService}}{\cf11{.}}{\cf2{}}{\cf16{getUser}}{\cf2{}}{\cf11{(}}{\cf2{friend}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{}}{\cf16{userToFriendView}}{\cf2{}}{\cf11{(}}{\cf2{fUser}}{\cf11{,}} {\cf2{user}}{\cf11{,}} {\cf2{}}{\cf16{match}}{\cf2{}}{\cf11{(}}{\cf2{user}}{\cf11{,}} {\cf2{fUser}}{\cf11{));}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{List}}{\cf11{<}}{\cf2{FriendView}}{\cf11{>}} {\cf2{}}{\cf16{matchAllUsers}}{\cf2{}}{\cf11{(}}{\cf2{User u}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    List}}{\cf11{<}}{\cf2{User}}{\cf11{>}} {\cf2{allUsers}} {\cf11{=}} {\cf2{Lists}}{\cf11{.}}{\cf2{}}{\cf16{newArrayList}}{\cf2{}}{\cf11{(}}{\cf2{userRepo}}{\cf11{.}}{\cf2{}}{\cf16{findAll}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{    allUsers}}{\cf11{.}}{\cf2{}}{\cf16{remove}}{\cf2{}}{\cf11{(}}{\cf2{u}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // cache for the match operation\i0 }}}\par\pard
\cbpat1{{\cf2{    Map}}{\cf11{<}}{\cf2{User}}{\cf11{,}} {\cf2{Double}}{\cf11{>}} {\cf2{matchValues}} {\cf11{=}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{HashMap}}{\cf11{<>();}}}\par\pard
\cbpat1{{\cf2{    allUsers}}{\cf11{.}}{\cf2{}}{\cf16{forEach}}{\cf2{}}{\cf11{(}}{\cf2{usr}} {\cf11{->}} {\cf2{matchValues}}{\cf11{.}}{\cf2{}}{\cf16{put}}{\cf2{}}{\cf11{(}}{\cf2{usr}}{\cf11{,}} {\cf2{}}{\cf16{match}}{\cf2{}}{\cf11{(}}{\cf2{u}}{\cf11{,}} {\cf2{usr}}{\cf11{)));}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{    allUsers}}{\cf11{.}}{\cf2{}}{\cf16{sort}}{\cf2{}}{\cf11{(}}}\par\pard
\cbpat1{{\cf2{        Collections}}{\cf11{.}}{\cf2{}}{\cf16{reverseOrder}}{\cf2{}}{\cf11{((}}{\cf2{a}}{\cf11{,}} {\cf2{b}}{\cf11{) ->}} {\cf2{Doubles}}{\cf11{.}}{\cf2{}}{\cf16{compare}}{\cf2{}}{\cf11{(}}{\cf2{matchValues}}{\cf11{.}}{\cf2{}}{\cf16{get}}{\cf2{}}{\cf11{(}}{\cf2{a}}{\cf11{),}} {\cf2{matchValues}}{\cf11{.}}{\cf2{}}{\cf16{get}}{\cf2{}}{\cf11{(}}{\cf2{b}}{\cf11{)))}}}\par\pard
\cbpat1{{\cf2{}}    {\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{allUsers}}{\cf11{.}}{\cf2{}}{\cf16{stream}}{\cf2{}}{\cf11{().}}{\cf2{}}{\cf16{map}}{\cf2{}}{\cf11{(}}}\par\pard
\cbpat1{{\cf2{        usr}} {\cf11{->}} {\cf2{}}{\cf16{userToFriendView}}{\cf2{}}{\cf11{(}}{\cf2{usr}}{\cf11{,}} {\cf2{u}}{\cf11{,}} {\cf2{matchValues}}{\cf11{.}}{\cf2{}}{\cf16{get}}{\cf2{}}{\cf11{(}}{\cf2{usr}}{\cf11{))}}}\par\pard
\cbpat1{{\cf2{}}    {\cf11{).}}{\cf2{}}{\cf16{toList}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{Iterable}}{\cf11{<}}{\cf2{Friendship}}{\cf11{>}} {\cf2{}}{\cf16{getFriendData}}{\cf2{}}{\cf11{(}}{\cf2{User u}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{friendRepo}}{\cf11{.}}{\cf2{}}{\cf16{getFriendshipByUser}}{\cf2{}}{\cf11{(}}{\cf2{u}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/service/SchoolService.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{service}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{model}}{\cf11{.}}{\cf2{School}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{repo}}{\cf11{.}}{\cf2{SchoolRepository}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{beans}}{\cf11{.}}{\cf2{factory}}{\cf11{.}}{\cf2{annotation}}{\cf11{.}}{\cf2{Autowired}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{stereotype}}{\cf11{.}}{\cf2{Service}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{ArrayList}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{Collections}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{List}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf15{\b @Service\b0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public class\b0 }} {\cf2{SchoolService}} {\cf11{\{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{SchoolRepository schoolRepo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Autowired\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{}}{\cf16{SchoolService}}{\cf2{}}{\cf11{(}}{\cf2{SchoolRepository schoolRepo}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{schoolRepo}} {\cf11{=}} {\cf2{schoolRepo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{Iterable}}{\cf11{<}}{\cf2{School}}{\cf11{>}} {\cf2{}}{\cf16{getSchools}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{    Iterable}}{\cf11{<}}{\cf2{School}}{\cf11{>}} {\cf2{schools}} {\cf11{=}} {\cf2{schoolRepo}}{\cf11{.}}{\cf2{}}{\cf16{findAll}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{    List}}{\cf11{<}}{\cf2{School}}{\cf11{>}} {\cf2{ret}} {\cf11{=}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{ArrayList}}{\cf11{<>();}}}\par\pard
\cbpat1{{\cf2{    schools}}{\cf11{.}}{\cf2{}}{\cf16{forEach}}{\cf2{}}{\cf11{(}}{\cf2{ret}}{\cf11{::}}{\cf2{add}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    Collections}}{\cf11{.}}{\cf2{}}{\cf16{sort}}{\cf2{}}{\cf11{(}}{\cf2{ret}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{ret}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/service/UserService.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{service}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{model}}{\cf11{.*;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{repo}}{\cf11{.}}{\cf2{LocationRepository}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{repo}}{\cf11{.}}{\cf2{UserPreferencesRepository}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{repo}}{\cf11{.}}{\cf2{UserRepository}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{Error}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{Xss}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{beans}}{\cf11{.}}{\cf2{factory}}{\cf11{.}}{\cf2{annotation}}{\cf11{.}}{\cf2{Autowired}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{stereotype}}{\cf11{.}}{\cf2{Service}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf15{\b @Service\b0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public class\b0 }} {\cf2{UserService}} {\cf11{\{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{UserRepository userRepo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{UserPreferencesRepository userPrefsRepo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{LocationRepository locationRepo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{Validator validator}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Autowired\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{}}{\cf16{UserService}}{\cf2{}}{\cf11{(}}{\cf2{UserRepository userRepo}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{                     UserPreferencesRepository userPrefsRepo}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{                     LocationRepository locationRepo}}{\cf11{,}}}\par\pard
\cbpat1{{\cf2{                     Validator validator}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{userRepo}} {\cf11{=}} {\cf2{userRepo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{userPrefsRepo}} {\cf11{=}} {\cf2{userPrefsRepo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{locationRepo}} {\cf11{=}} {\cf2{locationRepo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{validator}} {\cf11{=}} {\cf2{validator}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{Iterable}}{\cf11{<}}{\cf2{User}}{\cf11{>}} {\cf2{}}{\cf16{getUsers}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{userRepo}}{\cf11{.}}{\cf2{}}{\cf16{findAll}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{User}} {\cf16{getUser}}{\cf2{}}{\cf11{(}}{\cf2{String id}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{userRepo}}{\cf11{.}}{\cf2{}}{\cf16{findById}}{\cf2{}}{\cf11{(}}{\cf2{id}}{\cf11{).}}{\cf2{}}{\cf16{orElseThrow}}{\cf2{}}{\cf11{(}}{\cf2{Error}}{\cf11{.}}{\cf2{NOT_FOUND}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{Iterable}}{\cf11{<}}{\cf2{UserPreferences}}{\cf11{>}} {\cf2{}}{\cf16{getAllUserPrefs}}{\cf2{}}{\cf11{() \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{userPrefsRepo}}{\cf11{.}}{\cf2{}}{\cf16{findAll}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{UserPreferences}} {\cf16{getUserPrefs}}{\cf2{}}{\cf11{(}}{\cf2{String id}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{userPrefsRepo}}{\cf11{.}}{\cf2{}}{\cf16{findById}}{\cf2{}}{\cf11{(}}{\cf2{id}}{\cf11{).}}{\cf2{}}{\cf16{orElse}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf14{null}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{UserPreferences}} {\cf16{getUserPrefs}}{\cf2{}}{\cf11{(}}{\cf2{User user}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{user}}{\cf11{.}}{\cf2{}}{\cf16{getPrefs}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf6{\i /**\i0 }}}\par\pard
\cbpat1{{\cf6{\i    * Provides a PATCH method for the user entity.\i0 }}}\par\pard
\cbpat1{{\cf6{\i    * @param db The user, as fetched from the database\i0 }}}\par\pard
\cbpat1{{\cf6{\i    * @param edit The requested edits to the user\i0 }}}\par\pard
\cbpat1{{\cf6{\i    * @return <code>db</code>, after being edited accordingly\i0 }}}\par\pard
\cbpat1{{\cf6{\i    */\i0 }}{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{User}} {\cf16{editUser}}{\cf2{}}{\cf11{(}}{\cf2{User db}}{\cf11{,}} {\cf2{User edit}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{edit}}{\cf11{.}}{\cf2{}}{\cf16{getUsername}}{\cf2{}}{\cf11{() !=}} {\cf2{}}{\cf14{null}}{\cf2{}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{      validator}}{\cf11{.}}{\cf2{}}{\cf16{validateUsername}}{\cf2{}}{\cf11{(}}{\cf2{edit}}{\cf11{.}}{\cf2{}}{\cf16{getUsername}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{      db}}{\cf11{.}}{\cf2{}}{\cf16{setUsername}}{\cf2{}}{\cf11{(}}{\cf2{edit}}{\cf11{.}}{\cf2{}}{\cf16{getUsername}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{}}    {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{edit}}{\cf11{.}}{\cf2{}}{\cf16{getFirstName}}{\cf2{}}{\cf11{() !=}} {\cf2{}}{\cf14{null}}{\cf2{}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{      validator}}{\cf11{.}}{\cf2{}}{\cf16{validateName}}{\cf2{}}{\cf11{(}}{\cf2{edit}}{\cf11{.}}{\cf2{}}{\cf16{getFirstName}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{      db}}{\cf11{.}}{\cf2{}}{\cf16{setFirstName}}{\cf2{}}{\cf11{(}}{\cf2{Xss}}{\cf11{.}}{\cf2{}}{\cf16{deXss}}{\cf2{}}{\cf11{(}}{\cf2{edit}}{\cf11{.}}{\cf2{}}{\cf16{getFirstName}}{\cf2{}}{\cf11{()));}}}\par\pard
\cbpat1{{\cf2{}}    {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{edit}}{\cf11{.}}{\cf2{}}{\cf16{getLastName}}{\cf2{}}{\cf11{() !=}} {\cf2{}}{\cf14{null}}{\cf2{}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{      validator}}{\cf11{.}}{\cf2{}}{\cf16{validateName}}{\cf2{}}{\cf11{(}}{\cf2{edit}}{\cf11{.}}{\cf2{}}{\cf16{getLastName}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{      db}}{\cf11{.}}{\cf2{}}{\cf16{setFirstName}}{\cf2{}}{\cf11{(}}{\cf2{Xss}}{\cf11{.}}{\cf2{}}{\cf16{deXss}}{\cf2{}}{\cf11{(}}{\cf2{edit}}{\cf11{.}}{\cf2{}}{\cf16{getLastName}}{\cf2{}}{\cf11{()));}}}\par\pard
\cbpat1{{\cf2{}}    {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{edit}}{\cf11{.}}{\cf2{}}{\cf16{getPhoneNum}}{\cf2{}}{\cf11{() !=}} {\cf2{}}{\cf14{null}}{\cf2{}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{      validator}}{\cf11{.}}{\cf2{}}{\cf16{validatePhoneNumber}}{\cf2{}}{\cf11{(}}{\cf2{edit}}{\cf11{.}}{\cf2{}}{\cf16{getPhoneNum}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{      db}}{\cf11{.}}{\cf2{}}{\cf16{setPhoneNum}}{\cf2{}}{\cf11{(}}{\cf2{edit}}{\cf11{.}}{\cf2{}}{\cf16{getPhoneNum}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{}}    {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{edit}}{\cf11{.}}{\cf2{}}{\cf16{getEmail}}{\cf2{}}{\cf11{() !=}} {\cf2{}}{\cf14{null}}{\cf2{}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{      validator}}{\cf11{.}}{\cf2{}}{\cf16{validateEmail}}{\cf2{}}{\cf11{(}}{\cf2{edit}}{\cf11{.}}{\cf2{}}{\cf16{getEmail}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{      db}}{\cf11{.}}{\cf2{}}{\cf16{setEmail}}{\cf2{}}{\cf11{(}}{\cf2{edit}}{\cf11{.}}{\cf2{}}{\cf16{getEmail}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{}}    {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{edit}}{\cf11{.}}{\cf2{}}{\cf16{getHometown}}{\cf2{}}{\cf11{() !=}} {\cf2{}}{\cf14{null}}{\cf2{}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{      validator}}{\cf11{.}}{\cf2{}}{\cf16{validateName}}{\cf2{}}{\cf11{(}}{\cf2{edit}}{\cf11{.}}{\cf2{}}{\cf16{getHometown}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{      db}}{\cf11{.}}{\cf2{}}{\cf16{setHometown}}{\cf2{}}{\cf11{(}}{\cf2{edit}}{\cf11{.}}{\cf2{}}{\cf16{getHometown}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{}}    {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{edit}}{\cf11{.}}{\cf2{}}{\cf16{getGrade}}{\cf2{}}{\cf11{() !=}} {\cf2{}}{\cf14{null}} {\cf2{}}{\cf11{&&}} {\cf2{edit}}{\cf11{.}}{\cf2{}}{\cf16{getGrade}}{\cf2{}}{\cf11{() !=}} {\cf2{}}{\cf4{{0}}}{\cf2{}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{      validator}}{\cf11{.}}{\cf2{}}{\cf16{validateGrade}}{\cf2{}}{\cf11{(}}{\cf2{edit}}{\cf11{.}}{\cf2{}}{\cf16{getGrade}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{      db}}{\cf11{.}}{\cf2{}}{\cf16{setGrade}}{\cf2{}}{\cf11{(}}{\cf2{edit}}{\cf11{.}}{\cf2{}}{\cf16{getGrade}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{}}    {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{edit}}{\cf11{.}}{\cf2{}}{\cf16{getGender}}{\cf2{}}{\cf11{() !=}} {\cf2{}}{\cf14{null}} {\cf2{}}{\cf11{&&}} {\cf2{edit}}{\cf11{.}}{\cf2{}}{\cf16{getGender}}{\cf2{}}{\cf11{() !=}} {\cf2{}}{\cf3{'}}{\cf7{\\u{0}{0}{0}{0}}}{\cf3{'}}{\cf2{}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{      validator}}{\cf11{.}}{\cf2{}}{\cf16{validateGender}}{\cf2{}}{\cf11{(}}{\cf2{edit}}{\cf11{.}}{\cf2{}}{\cf16{getGender}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{      db}}{\cf11{.}}{\cf2{}}{\cf16{setGender}}{\cf2{}}{\cf11{(}}{\cf2{edit}}{\cf11{.}}{\cf2{}}{\cf16{getGender}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{}}    {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{edit}}{\cf11{.}}{\cf2{}}{\cf16{getBio}}{\cf2{}}{\cf11{() !=}} {\cf2{}}{\cf14{null}}{\cf2{}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{      validator}}{\cf11{.}}{\cf2{}}{\cf16{validateBio}}{\cf2{}}{\cf11{(}}{\cf2{edit}}{\cf11{.}}{\cf2{}}{\cf16{getBio}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{      db}}{\cf11{.}}{\cf2{}}{\cf16{setBio}}{\cf2{}}{\cf11{(}}{\cf2{Xss}}{\cf11{.}}{\cf2{}}{\cf16{deXss}}{\cf2{}}{\cf11{(}}{\cf2{edit}}{\cf11{.}}{\cf2{}}{\cf16{getBio}}{\cf2{}}{\cf11{()));}}}\par\pard
\cbpat1{{\cf2{}}    {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{userRepo}}{\cf11{.}}{\cf2{}}{\cf16{save}}{\cf2{}}{\cf11{(}}{\cf2{db}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf6{\i /**\i0 }}}\par\pard
\cbpat1{{\cf6{\i    * For use in debug only\i0 }}}\par\pard
\cbpat1{{\cf6{\i    *\i0 }}}\par\pard
\cbpat1{{\cf6{\i    * @deprecated To remove before production\i0 }}}\par\pard
\cbpat1{{\cf6{\i    */\i0 }}{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Deprecated\b0 }}{\cf2{}}{\cf11{(}}{\cf2{forRemoval}} {\cf11{=}} {\cf2{}}{\cf14{true}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{User}} {\cf16{setSchool}}{\cf2{}}{\cf11{(}}{\cf2{User user}}{\cf11{,}} {\cf2{School school}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    user}}{\cf11{.}}{\cf2{}}{\cf16{setSchool}}{\cf2{}}{\cf11{(}}{\cf2{school}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{userRepo}}{\cf11{.}}{\cf2{}}{\cf16{save}}{\cf2{}}{\cf11{(}}{\cf2{user}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{LatLon}} {\cf16{setLocation}}{\cf2{}}{\cf11{(}}{\cf2{User user}}{\cf11{,}} {\cf2{Location location}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{locationRepo}}{\cf11{.}}{\cf2{}}{\cf16{existsById}}{\cf2{}}{\cf11{(}}{\cf2{user}}{\cf11{.}}{\cf2{}}{\cf16{getId}}{\cf2{}}{\cf11{()))}} {\cf2{locationRepo}}{\cf11{.}}{\cf2{}}{\cf16{deleteById}}{\cf2{}}{\cf11{(}}{\cf2{user}}{\cf11{.}}{\cf2{}}{\cf16{getId}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{    location}}{\cf11{.}}{\cf2{}}{\cf16{setUser}}{\cf2{}}{\cf11{(}}{\cf2{user}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{    locationRepo}}{\cf11{.}}{\cf2{}}{\cf16{save}}{\cf2{}}{\cf11{(}}{\cf2{location}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return new\b0 }} {\cf2{}}{\cf16{LatLon}}{\cf2{}}{\cf11{(}}{\cf2{location}}{\cf11{.}}{\cf2{}}{\cf16{lat}}{\cf2{}}{\cf11{(),}} {\cf2{location}}{\cf11{.}}{\cf2{}}{\cf16{lon}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{Location}} {\cf16{getLocation}}{\cf2{}}{\cf11{(}}{\cf2{User user}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{user}}{\cf11{.}}{\cf2{}}{\cf16{getLocation}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/service/Validator.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{service}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{com}}{\cf11{.}}{\cf2{google}}{\cf11{.}}{\cf2{common}}{\cf11{.}}{\cf2{base}}{\cf11{.}}{\cf2{Strings}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{com}}{\cf11{.}}{\cf2{google}}{\cf11{.}}{\cf2{common}}{\cf11{.}}{\cf2{primitives}}{\cf11{.}}{\cf2{Longs}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{repo}}{\cf11{.}}{\cf2{UserRepository}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{Error}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{beans}}{\cf11{.}}{\cf2{factory}}{\cf11{.}}{\cf2{annotation}}{\cf11{.}}{\cf2{Autowired}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{http}}{\cf11{.}}{\cf2{HttpStatus}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{stereotype}}{\cf11{.}}{\cf2{Service}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{web}}{\cf11{.}}{\cf2{server}}{\cf11{.}}{\cf2{ResponseStatusException}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{List}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{regex}}{\cf11{.}}{\cf2{Pattern}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf15{\b @Service\b0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public class\b0 }} {\cf2{Validator}} {\cf11{\{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private final\b0 }} {\cf2{UserRepository userRepo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b private static final int\b0 }} {\cf2{BIO_MAX_LENGTH}} {\cf11{=}} {\cf2{}}{\cf4{{5}{0}{0}{0}}}{\cf2{}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @Autowired\b0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public\b0 }} {\cf2{}}{\cf16{Validator}}{\cf2{}}{\cf11{(}}{\cf2{UserRepository userRepo}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b this\b0 }}{\cf2{}}{\cf11{.}}{\cf2{userRepo}} {\cf11{=}} {\cf2{userRepo}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{validateUsername}}{\cf2{}}{\cf11{(}}{\cf2{String username}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    var invalidUsername}} {\cf11{=}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{}}{\cf16{ResponseStatusException}}{\cf2{}}{\cf11{(}}{\cf2{HttpStatus}}{\cf11{.}}{\cf2{BAD_REQUEST}}{\cf11{,}} {\cf2{}}{\cf3{"Invalid username."}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // check length >= {3}\i0 }}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{username}} {\cf11{==}} {\cf2{}}{\cf14{null}} {\cf2{}}{\cf11{||}} {\cf2{username}}{\cf11{.}}{\cf2{}}{\cf16{length}}{\cf2{}}{\cf11{() <}} {\cf2{}}{\cf4{{3}}}{\cf2{}}{\cf11{)}} {\cf2{}}{\cf13{\b throw\b0 }} {\cf2{invalidUsername}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // check alphanum\i0 }}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(!}}{\cf2{username}}{\cf11{.}}{\cf2{}}{\cf16{matches}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"^[a-zA-Z][a-zA-Z{0}-{9}]+$"}}{\cf2{}}{\cf11{))}} {\cf2{}}{\cf13{\b throw\b0 }} {\cf2{invalidUsername}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // check not already exists\i0 }}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{userRepo}}{\cf11{.}}{\cf2{}}{\cf16{existsByUsername}}{\cf2{}}{\cf11{(}}{\cf2{username}}{\cf11{))}} {\cf2{}}{\cf13{\b throw\b0 }} {\cf2{Error}}{\cf11{.}}{\cf2{ALREADY_EXISTS}}{\cf11{.}}{\cf2{}}{\cf16{get}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{validateName}}{\cf2{}}{\cf11{(}}{\cf2{String name}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    var invalidName}} {\cf11{=}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{}}{\cf16{ResponseStatusException}}{\cf2{}}{\cf11{(}}{\cf2{HttpStatus}}{\cf11{.}}{\cf2{BAD_REQUEST}}{\cf11{,}} {\cf2{}}{\cf3{"Invalid name: "}}{\cf2{}} {\cf11{+}} {\cf2{name}} {\cf11{+}} {\cf2{}}{\cf3{"."}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b final\b0 }} {\cf2{String approvedSpecialChars}} {\cf11{=}} {\cf2{}}{\cf3{" '-"}}{\cf2{}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // check for empty name\i0 }}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{Strings}}{\cf11{.}}{\cf2{}}{\cf16{isNullOrEmpty}}{\cf2{}}{\cf11{(}}{\cf2{name}}{\cf11{))}} {\cf2{}}{\cf13{\b throw\b0 }} {\cf2{invalidName}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // trim and check for printability\i0 }}}\par\pard
\cbpat1{{\cf2{    name}} {\cf11{=}} {\cf2{name}}{\cf11{.}}{\cf2{}}{\cf16{strip}}{\cf2{}}{\cf11{();}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b for\b0 }} {\cf2{}}{\cf11{(}}{\cf2{}}{\cf13{\b char\b0 }} {\cf2{c}} {\cf11{:}} {\cf2{name}}{\cf11{.}}{\cf2{}}{\cf16{toCharArray}}{\cf2{}}{\cf11{()) \{}}}\par\pard
\cbpat1{{\cf2{}}      {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(!(}}{\cf2{Character}}{\cf11{.}}{\cf2{}}{\cf16{isLetter}}{\cf2{}}{\cf11{(}}{\cf2{c}}{\cf11{) ||}} {\cf2{approvedSpecialChars}}{\cf11{.}}{\cf2{}}{\cf16{contains}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{""}}{\cf2{}} {\cf11{+}} {\cf2{c}}{\cf11{)))}} {\cf2{}}{\cf13{\b throw\b0 }} {\cf2{invalidName}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{validateEmail}}{\cf2{}}{\cf11{(}}{\cf2{String email}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // email regex from internet\i0 }}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(!}}{\cf2{Pattern}}{\cf11{.}}{\cf2{}}{\cf16{matches}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"^[a-zA-Z{0}-{9}_!#$%&'*+/=?`\{|\}~^.-]+@[a-zA-Z{0}-{9}.-]+$"}}{\cf2{}}{\cf11{,}} {\cf2{email}}{\cf11{))}}}\par\pard
\cbpat1{{\cf2{}}      {\cf13{\b throw new\b0 }} {\cf2{}}{\cf16{ResponseStatusException}}{\cf2{}}{\cf11{(}}{\cf2{HttpStatus}}{\cf11{.}}{\cf2{BAD_REQUEST}}{\cf11{,}} {\cf2{}}{\cf3{"Invalid email address."}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf6{\i /**\i0 }}}\par\pard
\cbpat1{{\cf6{\i    * validate Israeli mobile phones\i0 }}}\par\pard
\cbpat1{{\cf6{\i    */\i0 }}{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf15{\b @SuppressWarnings\b0 }}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"UnstableApiUsage"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{validatePhoneNumber}}{\cf2{}}{\cf11{(}}{\cf2{String number}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    var invalidPhone}} {\cf11{=}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{}}{\cf16{ResponseStatusException}}{\cf2{}}{\cf11{(}}{\cf2{HttpStatus}}{\cf11{.}}{\cf2{BAD_REQUEST}}{\cf11{,}} {\cf2{}}{\cf3{"Invalid phone number."}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // check if {1}{0}-digit number\i0 }}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{number}} {\cf11{==}} {\cf2{}}{\cf14{null}} {\cf2{}}{\cf11{||}} {\cf2{number}}{\cf11{.}}{\cf2{}}{\cf16{length}}{\cf2{}}{\cf11{() !=}} {\cf2{}}{\cf4{{1}{0}}}{\cf2{}}{\cf11{)}} {\cf2{}}{\cf13{\b throw\b0 }} {\cf2{invalidPhone}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{Longs}}{\cf11{.}}{\cf2{}}{\cf16{tryParse}}{\cf2{}}{\cf11{(}}{\cf2{number}}{\cf11{) ==}} {\cf2{}}{\cf14{null}}{\cf2{}}{\cf11{)}} {\cf2{}}{\cf13{\b throw\b0 }} {\cf2{invalidPhone}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // check for mobile carrier prefix\i0 }}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(!}}{\cf2{number}}{\cf11{.}}{\cf2{}}{\cf16{startsWith}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"{0}{5}"}}{\cf2{}}{\cf11{))}} {\cf2{}}{\cf13{\b throw\b0 }} {\cf2{invalidPhone}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(!}}{\cf2{List}}{\cf11{.}}{\cf2{}}{\cf16{of}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{'{0}'}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf3{'{1}'}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf3{'{2}'}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf3{'{3}'}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf3{'{4}'}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf3{'{5}'}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf3{'{8}'}}{\cf2{}}{\cf11{).}}{\cf2{}}{\cf16{contains}}{\cf2{}}{\cf11{(}}{\cf2{number}}{\cf11{.}}{\cf2{}}{\cf16{charAt}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf4{{2}}}{\cf2{}}{\cf11{)))}} {\cf2{}}{\cf13{\b throw\b0 }} {\cf2{invalidPhone}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{validatePassword}}{\cf2{}}{\cf11{(}}{\cf2{String password}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{    var invalidPassword}} {\cf11{=}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{}}{\cf16{ResponseStatusException}}{\cf2{}}{\cf11{(}}{\cf2{HttpStatus}}{\cf11{.}}{\cf2{BAD_REQUEST}}{\cf11{,}} {\cf2{}}{\cf3{"Invalid password."}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // {8}-{6}{4} chars\i0 }}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{password}} {\cf11{==}} {\cf2{}}{\cf14{null}} {\cf2{}}{\cf11{||}} {\cf2{password}}{\cf11{.}}{\cf2{}}{\cf16{length}}{\cf2{}}{\cf11{() <}} {\cf2{}}{\cf4{{8}}} {\cf2{}}{\cf11{||}} {\cf2{password}}{\cf11{.}}{\cf2{}}{\cf16{length}}{\cf2{}}{\cf11{() >}} {\cf2{}}{\cf4{{6}{4}}}{\cf2{}}{\cf11{)}} {\cf2{}}{\cf13{\b throw\b0 }} {\cf2{invalidPassword}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b int\b0 }} {\cf2{checks}} {\cf11{=}} {\cf2{}}{\cf4{{0}}}{\cf2{}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // a valid password must contain at least {3} of the following {4} tests, in addition to length (compulsory):\i0 }}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // contains upper\i0 }}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{password}}{\cf11{.}}{\cf2{}}{\cf16{matches}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{".*[A-Z].*"}}{\cf2{}}{\cf11{))}} {\cf2{checks}}{\cf11{++;}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // contains lower\i0 }}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{password}}{\cf11{.}}{\cf2{}}{\cf16{matches}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{".*[a-z].*"}}{\cf2{}}{\cf11{))}} {\cf2{checks}}{\cf11{++;}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // contains digit\i0 }}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{password}}{\cf11{.}}{\cf2{}}{\cf16{matches}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{".*}}{\cf7{\\\\}}{\cf3{d.*"}}{\cf2{}}{\cf11{))}} {\cf2{checks}}{\cf11{++;}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // contains special, which is any of the following:\i0 }}}\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // -,. !@#$%^&*()_+=/[]\{\}\\\i0 }}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{password}}{\cf11{.}}{\cf2{}}{\cf16{matches}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{".*[-,. !@#$%^&*()_+=?/}}{\cf7{\\\\}}{\cf3{[}}{\cf7{\\\\}}{\cf3{]\{\}}}{\cf7{\\\\\\\\}}{\cf3{].*"}}{\cf2{}}{\cf11{))}} {\cf2{checks}}{\cf11{++;}}}\par\pard
\cbpat1{{\cf2{}}    }\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{checks}} {\cf11{<}} {\cf2{}}{\cf4{{3}}}{\cf2{}}{\cf11{)}} {\cf2{}}{\cf13{\b throw\b0 }} {\cf2{invalidPassword}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{validateGrade}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf13{\b int\b0 }} {\cf2{grade}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf5{\i // includes support for grades {1}{3} and {1}{4}\i0 }}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{grade}} {\cf11{<}} {\cf2{}}{\cf4{{7}}} {\cf2{}}{\cf11{||}} {\cf2{grade}} {\cf11{>}} {\cf2{}}{\cf4{{1}{4}}}{\cf2{}}{\cf11{)}} {\cf2{}}{\cf13{\b throw new\b0 }} {\cf2{}}{\cf16{ResponseStatusException}}{\cf2{}}{\cf11{(}}{\cf2{HttpStatus}}{\cf11{.}}{\cf2{BAD_REQUEST}}{\cf11{,}} {\cf2{}}{\cf3{"Invalid grade."}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{validateGender}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf13{\b char\b0 }} {\cf2{gender}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(!}}{\cf2{}}{\cf3{"MFOX"}}{\cf2{}}{\cf11{.}}{\cf2{}}{\cf16{contains}}{\cf2{}}{\cf11{(}}{\cf2{Character}}{\cf11{.}}{\cf2{}}{\cf16{toString}}{\cf2{}}{\cf11{(}}{\cf2{gender}}{\cf11{).}}{\cf2{}}{\cf16{toUpperCase}}{\cf2{}}{\cf11{()))}}}\par\pard
\cbpat1{{\cf2{}}      {\cf13{\b throw new\b0 }} {\cf2{}}{\cf16{ResponseStatusException}}{\cf2{}}{\cf11{(}}{\cf2{HttpStatus}}{\cf11{.}}{\cf2{BAD_REQUEST}}{\cf11{,}} {\cf2{}}{\cf3{"Invalid gender."}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public void\b0 }} {\cf2{}}{\cf16{validateBio}}{\cf2{}}{\cf11{(}}{\cf2{String bio}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b if\b0 }} {\cf2{}}{\cf11{(}}{\cf2{bio}}{\cf11{.}}{\cf2{}}{\cf16{length}}{\cf2{}}{\cf11{() >}} {\cf2{BIO_MAX_LENGTH}}{\cf11{)}} {\cf2{}}{\cf13{\b throw new\b0 }} {\cf2{}}{\cf16{ResponseStatusException}}{\cf2{}}{\cf11{(}}{\cf2{HttpStatus}}{\cf11{.}}{\cf2{BAD_REQUEST}}{\cf11{,}} {\cf2{}}{\cf3{"Bio too long."}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/util/Error.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{util}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{http}}{\cf11{.}}{\cf2{HttpStatus}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{web}}{\cf11{.}}{\cf2{server}}{\cf11{.}}{\cf2{ResponseStatusException}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{org}}{\cf11{.}}{\cf2{springframework}}{\cf11{.}}{\cf2{web}}{\cf11{.}}{\cf2{server}}{\cf11{.}}{\cf2{ServerErrorException}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{java}}{\cf11{.}}{\cf2{util}}{\cf11{.}}{\cf2{function}}{\cf11{.}}{\cf2{Supplier}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf6{\i /**\i0 }}}\par\pard
\cbpat1{{\cf6{\i  * Responsible for providing the program with \{@link ResponseStatusException\} objects.\i0 }}}\par\pard
\cbpat1{{\cf6{\i  */\i0 }}{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // inclusion criteria - appears more than once\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public class\b0 }} {\cf2{Error}} {\cf11{\{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf5{\i // {4}{0}{0} Bad Request\i0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public static final\b0 }} {\cf2{Supplier}}{\cf11{<}}{\cf2{ResponseStatusException}}{\cf11{>}} {\cf2{BAD_REQUEST}}}\par\pard
\cbpat1{{\cf2{}}      {\cf11{= () ->}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{}}{\cf16{ResponseStatusException}}{\cf2{}}{\cf11{(}}{\cf2{HttpStatus}}{\cf11{.}}{\cf2{BAD_REQUEST}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf5{\i // {4}{0}{1} Unauthorized\i0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public static final\b0 }} {\cf2{Supplier}}{\cf11{<}}{\cf2{ResponseStatusException}}{\cf11{>}} {\cf2{UNAUTHORIZED}}}\par\pard
\cbpat1{{\cf2{}}      {\cf11{= () ->}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{}}{\cf16{ResponseStatusException}}{\cf2{}}{\cf11{(}}{\cf2{HttpStatus}}{\cf11{.}}{\cf2{UNAUTHORIZED}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public static final\b0 }} {\cf2{Supplier}}{\cf11{<}}{\cf2{ResponseStatusException}}{\cf11{>}} {\cf2{INVALID_LOGIN}}}\par\pard
\cbpat1{{\cf2{}}      {\cf11{= () ->}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{}}{\cf16{ResponseStatusException}}{\cf2{}}{\cf11{(}}{\cf2{HttpStatus}}{\cf11{.}}{\cf2{UNAUTHORIZED}}{\cf11{,}} {\cf2{}}{\cf3{"Invalid login."}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf5{\i // {4}{0}{3} Forbidden\i0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public static final\b0 }} {\cf2{Supplier}}{\cf11{<}}{\cf2{ResponseStatusException}}{\cf11{>}} {\cf2{FORBIDDEN}}}\par\pard
\cbpat1{{\cf2{}}      {\cf11{= () ->}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{}}{\cf16{ResponseStatusException}}{\cf2{}}{\cf11{(}}{\cf2{HttpStatus}}{\cf11{.}}{\cf2{FORBIDDEN}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public static final\b0 }} {\cf2{Supplier}}{\cf11{<}}{\cf2{ResponseStatusException}}{\cf11{>}} {\cf2{ALREADY_EXISTS}}}\par\pard
\cbpat1{{\cf2{}}      {\cf11{= () ->}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{}}{\cf16{ResponseStatusException}}{\cf2{}}{\cf11{(}}{\cf2{HttpStatus}}{\cf11{.}}{\cf2{FORBIDDEN}}{\cf11{,}} {\cf2{}}{\cf3{"Resource already exists."}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf5{\i // {4}{0}{4} Not Found\i0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public static final\b0 }} {\cf2{Supplier}}{\cf11{<}}{\cf2{ResponseStatusException}}{\cf11{>}} {\cf2{NOT_FOUND}}}\par\pard
\cbpat1{{\cf2{}}      {\cf11{= () ->}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{}}{\cf16{ResponseStatusException}}{\cf2{}}{\cf11{(}}{\cf2{HttpStatus}}{\cf11{.}}{\cf2{NOT_FOUND}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf5{\i // {5}{0}{0} Internal Server Error\i0 }}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public static final\b0 }} {\cf2{Supplier}}{\cf11{<}}{\cf2{ResponseStatusException}}{\cf11{>}} {\cf2{SERVER_ERROR}}}\par\pard
\cbpat1{{\cf2{}}      {\cf11{= () ->}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{}}{\cf16{ResponseStatusException}}{\cf2{}}{\cf11{(}}{\cf2{HttpStatus}}{\cf11{.}}{\cf2{INTERNAL_SERVER_ERROR}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  }\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public static final\b0 }} {\cf2{Supplier}}{\cf11{<}}{\cf2{ResponseStatusException}}{\cf11{>}} {\cf2{UNIMPLEMENTED}}}\par\pard
\cbpat1{{\cf2{}}      {\cf11{= () ->}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{}}{\cf16{ServerErrorException}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"Method unimplemented"}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf13{\b new\b0 }} {\cf2{}}{\cf16{UnimplementedException}}{\cf2{}}{\cf11{());}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/util/UnimplementedException.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{util}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public class\b0 }} {\cf2{UnimplementedException}} {\cf13{\b extends\b0 }} {\cf2{RuntimeException}} {\cf11{\{}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf5{\i // ./me/rootatkali/hey/util/Xss.java\i0 }}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b package\b0 }} {\cf2{me}}{\cf11{.}}{\cf2{rootatkali}}{\cf11{.}}{\cf2{hey}}{\cf11{.}}{\cf2{util}}{\cf11{;}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{{\cf2{}}{\cf13{\b public class\b0 }} {\cf2{Xss}} {\cf11{\{}}}\par\pard
\cbpat1{{\cf2{}}  {\cf13{\b public static\b0 }} {\cf2{String}} {\cf16{deXss}}{\cf2{}}{\cf11{(}}{\cf2{String msg}}{\cf11{) \{}}}\par\pard
\cbpat1{{\cf2{}}    {\cf13{\b return\b0 }} {\cf2{msg}}{\cf11{.}}{\cf2{}}{\cf16{replaceAll}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"&"}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf3{"&amp;"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}        {\cf11{.}}{\cf2{}}{\cf16{replaceAll}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"<"}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf3{"&lt;"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}        {\cf11{.}}{\cf2{}}{\cf16{replaceAll}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{">"}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf3{"&gt;"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}        {\cf11{.}}{\cf2{}}{\cf16{replaceAll}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"}}{\cf7{\\"}}{\cf3{"}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf3{"&quot;"}}{\cf2{}}{\cf11{)}}}\par\pard
\cbpat1{{\cf2{}}        {\cf11{.}}{\cf2{}}{\cf16{replaceAll}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{"'"}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf3{"&apos;"}}{\cf2{}}{\cf11{);}}}\par\pard
\cbpat1{{\cf2{}}  {\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}{\cf11{\}}}}\par\pard
\cbpat1{{\cf2{}}}\par\pard
\cbpat1{}}
